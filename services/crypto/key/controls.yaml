shared-controls:
  - reference-id: CCC
    identifiers:
      - CCC.C01 # Prevent unencrypted requests
      - CCC.C02 # Ensure Data Encryption at Rest for All Stored Data
      - CCC.C03 # Implement multi-factor authentication (MFA) for access
      - CCC.C04 # Log all access and changes
      - CCC.C05 # Prevent access from untrusted entities
      - CCC.C06 # Prevent deployment in restricted regions
      - CCC.C10 # Prevent Data Replication to Destinations Outside of Defined Trust Perimeter

control-families:
  - name: Logging and Monitoring
    description: Controls that collect, alert, and retain key-management events.

    controls:
      - id: CCC.KeyMgmt.C01
        title: Alert on key-version changes
        objective: >
          Generate near-real-time alerts when a KMS key version is disabled or
          scheduled for deletion, enabling rapid investigation and recovery.
        requirements:
          - id: CCC.KeyMgmt.C01.TR01
            text: |
              When a key version is scheduled for deletion or disabled, an
              alert MUST be generated within five minutes.
            applicability:
              - tlp-green
            recommendation: Use native event services (e.g., CloudWatch Events,
              Azure Monitor, Cloud Audit Logs) to route notifications to an
              incident-response channel.
        threat-mappings:
          - reference-id: CCC
            identifiers:
              - CCC.KeyMgmt.TH01  # Deletion or disabling of key versions causing DoS or data loss
        guideline-mappings:
          - reference-id: NIST-CSF
            identifiers:
              - RS.AN-1  # Notifications from detection systems are investigated
          - reference-id: NIST_800_53
            identifiers:
              - IR-5  # Incident Monitoring

  - name: Identity and Access Management
    description: Controls that enforce least-privilege use of KMS operations.

    controls:
      - id: CCC.KeyMgmt.C02
        title: Limit decrypt permissions
        objective: >
          Restrict the Decrypt operation to authorised principals only, applying
          the principle of least privilege to protect sensitive data.
        requirements:
          - id: CCC.KeyMgmt.C02.TR01
            text: |
              When IAM roles and key policies are reviewed, Decrypt permission
              MUST be granted exclusively to documented authorised principals.
            applicability: 
              - tlp-green
            recommendation: Periodically audit policy documents via automated
              tooling and report any deviations.
        threat-mappings:
          - reference-id: CCC
            identifiers:
              - CCC.KeyMgmt.TH02  # Unrestricted use of a KMS key to decrypt data
        guideline-mappings:
          - reference-id: NIST-CSF
            identifiers:
              - PR.AC-4  # Access to assets is managed
          - reference-id: NIST_800_53
            identifiers:
              - AC-6  # Least Privilege