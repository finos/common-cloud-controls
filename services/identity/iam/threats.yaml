imported-threats:
  - reference-id: CCC
    entries:
      - reference-id: CCC.Core.TH01
        strength: 0 # not specified yet
        remarks: Access Control is Misconfigured
      - reference-id: CCC.Core.TH07
        strength: 0 # not specified yet
        remarks: Logs are Tampered With or Deleted
      - reference-id: CCC.Core.TH09
        strength: 0 # not specified yet
        remarks: Logs or Monitoring Data are Read by Unauthorized Users
      - reference-id: CCC.Core.TH10
        strength: 0 # not specified yet
        remarks: Alerts are Intercepted
      - reference-id: CCC.Core.TH11
        strength: 0 # not specified yet
        remarks: Event Notifications are Incorrectly Triggered
      - reference-id: CCC.Core.TH13
        strength: 0 # not specified yet
        remarks: Resource Tags are Manipulated
      - reference-id: CCC.Core.TH15
        strength: 0 # not specified yet
        remarks: Automated Enumeration and Reconnaissance by Non-human Entities

threats:
  - id: CCC.IAM.TH01
    title: Valid Cloud Credentials Abuse
    description: |
      Valid identity credentials such as access keys, tokens or passwords are misused or
      compromised. Examples include public exposure, token theft, unprotected
      metadata service of a compromised compute instance or brute-force attacks.
      The use of these credentials can provide unauthorized access to the cloud environment,
      potentially bypassing other security controls and enabling lateral movement across
      cloud resources.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F02
        strength: 0 # not specified yet
        remarks: IAM Users
          - reference-id: CCC.IAM.F03
        strength: 0 # not specified yet
        remarks: Long-Term Credentials
          - reference-id: CCC.IAM.F04
        strength: 0 # not specified yet
        remarks: Password Management
          - reference-id: CCC.IAM.F07
        strength: 0 # not specified yet
        remarks: Managed Identities
          - reference-id: CCC.IAM.F08
        strength: 0 # not specified yet
        remarks: Federated Identity - SAML
          - reference-id: CCC.IAM.F09
        strength: 0 # not specified yet
        remarks: Federated Identity - OIDC
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078.004
        strength: 0 # not specified yet
        remarks: Valid Accounts: Cloud Accounts
          - reference-id: T1552
        strength: 0 # not specified yet
        remarks: Unsecured Credentials
          - reference-id: T1552.005
        strength: 0 # not specified yet
        remarks: Unsecured Credentials: Cloud Instance Metadata API
          - reference-id: T1528
        strength: 0 # not specified yet
        remarks: Steal Application Access Token
          - reference-id: T1110
        strength: 0 # not specified yet
        remarks: Brute Force

  - id: CCC.IAM.TH02
    title: Overly-Permissive IAM Policy
    description: |
      An access control policy attached to an identity or a resource is
      configured with excessive permissions, violating the principle of least privilege.
      This can enable unauthorized data access, privilege escalation, or other unintended
      actions by principals whose credentials might be compromised or who are acting erroneously.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F02
        strength: 0 # not specified yet
        remarks: IAM Users
          - reference-id: CCC.IAM.F05
        strength: 0 # not specified yet
        remarks: IAM Groups
          - reference-id: CCC.IAM.F06
        strength: 0 # not specified yet
        remarks: IAM Roles / Service Principals
          - reference-id: CCC.IAM.F07
        strength: 0 # not specified yet
        remarks: Managed Identities
          - reference-id: CCC.IAM.F10
        strength: 0 # not specified yet
        remarks: Custom Roles
          - reference-id: CCC.IAM.F12
        strength: 0 # not specified yet
        remarks: Policy Conditions
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078.004
        strength: 0 # not specified yet
        remarks: Valid Accounts: Cloud Accounts

  - id: CCC.IAM.TH03
    title: Overly-Permissive Identity Trust Policy
    description: |
      An IAM role or service principal's trust policy is configured to allow principals
      from untrusted or overly broad scopes, such as any identity in any account, to assume
      or impersonate it. This can allow an external or unauthorized identity to gain access
      to the cloud environment, completely bypassing internal identity controls.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F06
        strength: 0 # not specified yet
        remarks: IAM Roles / Service Principals
          - reference-id: CCC.IAM.F12
        strength: 0 # not specified yet
        remarks: Policy Conditions
          - reference-id: CCC.IAM.F15
        strength: 0 # not specified yet
        remarks: Role Assumption / Delegation
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078.004
        strength: 0 # not specified yet
        remarks: Valid Accounts: Cloud Accounts

  - id: CCC.IAM.TH04
    title: Additional Cloud Credentials Creation
    description: |
      An adversary with access to a sufficiently privileged cloud account may create
      additional credentials such as access keys, service accounts and
      temporary credentials to establish persistance or elevate their privileges.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F02
        strength: 0 # not specified yet
        remarks: IAM Users
          - reference-id: CCC.IAM.F03
        strength: 0 # not specified yet
        remarks: Long-Term Credentials
          - reference-id: CCC.IAM.F04
        strength: 0 # not specified yet
        remarks: Password Management
          - reference-id: CCC.IAM.F08
        strength: 0 # not specified yet
        remarks: Federated Identity - SAML
          - reference-id: CCC.IAM.F09
        strength: 0 # not specified yet
        remarks: Federated Identity - OIDC
          - reference-id: CCC.IAM.F11
        strength: 0 # not specified yet
        remarks: Temporary Credentials
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1098.001
        strength: 0 # not specified yet
        remarks: Account Manipulation: Additional Cloud Credentials

  - id: CCC.IAM.TH05
    title: Additional IAM Roles Creation
    description: |
      An adversary with access to a sufficiently privileged cloud account may create
      additional IAM roles to establish persistance or elevate their privileges.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F06
        strength: 0 # not specified yet
        remarks: IAM Roles / Service Principals
          - reference-id: CCC.IAM.F10
        strength: 0 # not specified yet
        remarks: Custom Roles
          - reference-id: CCC.IAM.F15
        strength: 0 # not specified yet
        remarks: Role Assumption / Delegation
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1098.003
        strength: 0 # not specified yet
        remarks: Account Manipulation: Additional Cloud Roles

  - id: CCC.IAM.TH06
    title: IAM Policies Modification
    description: |
      An adversary with access to a sufficiently privileged cloud account may modify
      IAM policies to establish persistance or elevate their privileges.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F02
        strength: 0 # not specified yet
        remarks: IAM Users
          - reference-id: CCC.IAM.F06
        strength: 0 # not specified yet
        remarks: IAM Roles / Service Principals
          - reference-id: CCC.IAM.F10
        strength: 0 # not specified yet
        remarks: Custom Roles
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1098.003
        strength: 0 # not specified yet
        remarks: Account Manipulation: Additional Cloud Roles
          - reference-id: T1556.009
        strength: 0 # not specified yet
        remarks: Modify Authentication Process: Conditional Access Policies

  - id: CCC.IAM.TH07
    title: Identity Inherits Excessive Permissions Through Group Membership
    description: |
      An identity principal becomes a member of one or more IAM groups, and the combined
      policies of these groups grant permissions beyond what is necessary for the principal's
      function. This "privilege creep" through group inheritance complicates auditing and can
      lead to an identity having standing access to sensitive resources.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F05
        strength: 0 # not specified yet
        remarks: IAM Groups
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1098
        strength: 0 # not specified yet
        remarks: Account Manipulation

  - id: CCC.IAM.TH08
    title: Privilege Escalation via Indirect Role Usage
    description: |
      An identity principal possesses specific, highly privileged permissions, such as the
      ability to pass roles or impersonate service accounts, that allow it to leverage
      the permissions of a different, more privileged role. Even without being able
      to directly assume the target role, the principal can attach it to a new resource
      they control and then use that resource to perform unauthorized actions.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F02
        strength: 0 # not specified yet
        remarks: IAM Users
          - reference-id: CCC.IAM.F06
        strength: 0 # not specified yet
        remarks: IAM Roles / Service Principals
          - reference-id: CCC.IAM.F15
        strength: 0 # not specified yet
        remarks: Role Assumption / Delegation
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1548.006
        strength: 0 # not specified yet
        remarks: Abuse Elevation Control Mechanism: Temporary Elevated Cloud Access

  - id: CCC.IAM.TH09
    title: Long-Lived Static Credentials
    description: |
      Long-lived static credentials such as access keys for an identity are used and
      not rotated periodically according to security best practices, extending exposure
      in the event of credentials compromise.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F02
        strength: 0 # not specified yet
        remarks: IAM Users
          - reference-id: CCC.IAM.F03
        strength: 0 # not specified yet
        remarks: Long-Term Credentials
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078.004
        strength: 0 # not specified yet
        remarks: Valid Accounts: Cloud Accounts
          - reference-id: T1552
        strength: 0 # not specified yet
        remarks: Unsecured Credentials

  - id: CCC.IAM.TH10
    title: Orphaned Federated Identity Retains Access
    description: |
      A federated identity is de-provisioned from the external Identity Provider (IdP),
      but its corresponding cloud identity remains active within the cloud environment.
      This orphaned identity creates a latent access path that could be exploited if the
      original username is reactivated or reassigned in the IdP, granting unintended
      access to a new principal.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F08
        strength: 0 # not specified yet
        remarks: Federated Identity - SAML
          - reference-id: CCC.IAM.F09
        strength: 0 # not specified yet
        remarks: Federated Identity - OIDC
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078
        strength: 0 # not specified yet
        remarks: Valid Accounts

  - id: CCC.IAM.TH11
    title: Unused Credentials
    description: |
      Unused IAM identity that is no longer needed or monitored remains active. Its compromise
      is less likely to be detected, and it represents a persistent, unnecessary attack surface.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F02
        strength: 0 # not specified yet
        remarks: IAM Users
          - reference-id: CCC.IAM.F03
        strength: 0 # not specified yet
        remarks: Long-Term Credentials
          - reference-id: CCC.IAM.F04
        strength: 0 # not specified yet
        remarks: Password Management
          - reference-id: CCC.IAM.F06
        strength: 0 # not specified yet
        remarks: IAM Roles / Service Principals
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078.004
        strength: 0 # not specified yet
        remarks: Valid Accounts: Cloud Accounts
          - reference-id: T1552
        strength: 0 # not specified yet
        remarks: Unsecured Credentials

  - id: CCC.IAM.TH12
    title: IAM Role is Coerced into Unauthorized Cross-Account Actions (Confused Deputy)
    description: |
      An external actor tricks a legitimate, authorized third-party application into making requests
      to the cloud environment. A role in the cloud account (the "deputy"), which trusts that third-party
      application, then performs unauthorized actions on behalf of the actor.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.IAM.F06
        strength: 0 # not specified yet
        remarks: IAM Roles / Service Principals
          - reference-id: CCC.IAM.F10
        strength: 0 # not specified yet
        remarks: Custom Roles
          - reference-id: CCC.IAM.F15
        strength: 0 # not specified yet
        remarks: Role Assumption / Delegation
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1199
        strength: 0 # not specified yet
        remarks: Trusted Relationship
          - reference-id: T1548.005
        strength: 0 # not specified yet
        remarks: Abuse Elevation Control Mechanism: Temporary Elevated Cloud Access
