control_families:
  - Encryption
  - Data
  - Identity and Access Management
  - Logging & Monitoring
  - Software Supply Chain
  - Network Security

controls:

  - id: CCC.C01 # Prevent unencrypted requests
    title: Prevent unencrypted requests
    objective: |
      Ensure that all communications are encrypted in transit to protect data
      integrity and confidentiality.
    control_family: Data
    threats:
      - CCC.TH02 # Data is intercepted in transit
    nist_csf: PR.DS-2
    control_mappings:
      CCM:
        - IVS-09
        - DSI-03
      ISO_27001:
        - 2013 A.13.1.1
      NIST_800_53:
        - SC-8
        - SC-13
    test_requirements:
      01: |
        All supported network data protocols must be running on secure channels
      02: |
        All clear text channels should be disabled
      03: |
        The cipher suite implemented for ensuring the integrity and
        confidentiality of data should conform with the latest suggested cipher
        suites

  - id: CCC.C02 # Ensure data encryption at rest for all stored data
    title: Ensure data encryption at rest for all stored data
    objective: |
      Ensure that all data stored is encrypted at rest to maintain
      confidentiality and integrity.
    control_family: Encryption
    threats:
      - CCC.TH01 # Access control is misconfigured
    nist_csf: PR.DS-1
    control_mappings:
      CCM:
        - DSI-01
        - DSI-02
      ISO_27001:
        - 2013 A.10.1.1
      NIST_800_53:
        - SC-28
    test_requirements:
      01: |
        Verify that stored data is encrypted using industry-standard algorithms
      02: |
        Ensure that encryption keys are managed securely and rotated
        periodically
      03: |
        Confirm that decryption is only possible through authorized access
        mechanisms

  - id: CCC.C03 # Implement multi-factor authentication (MFA) for access
    title: Implement multi-factor authentication (MFA) for access
    objective: |
      Ensure that all human user access requires multi-factor authentication
      (MFA), minimizing the risk of unauthorized access by enforcing strong
      authentication mechanisms.
    control_family: Identity and Access Management
    threats:
      - CCC.TH01 # Access control is misconfigured
    nist_csf: PR.AC-7
    control_mappings:
      CCM:
        - IAM-03
        - IAM-08
      ISO_27001:
        - 2013 A.9.4.2
      NIST_800_53:
        - IA-2
    test_requirements:
      01: |
        Verify that MFA is enforced for all access attempts
      02: |
        Ensure that MFA is required for all administrative access to the
        management interface
      03: |
        Confirm that users are unable to access without completing MFA

  - id: CCC.C04 # Log all access and changes
    title: Log all access and changes
    objective: |
      Ensure that all access and changes are logged to maintain a detailed
      audit trail for security and compliance purposes.
    control_family: Logging & Monitoring
    threats:
      - CCC.TH01 # Access control is misconfigured
    nist_csf: DE.AE-3
    control_mappings:
      CCM:
        - DSI-06
        - STA-04
      ISO_27001:
        - 2013 A.12.4.1
      NIST_800_53:
        - AU-2
        - AU-3
    test_requirements:
      01: |
        Verify that all access attempts are logged
      02: |
        Ensure that all changes to configurations are logged
      03: |
        Confirm that logs are protected against unauthorized access and
        tampering

  - id: CCC.C05 # Prevent access from untrusted entities
    title: Prevent access from untrusted entities
    objective: |
      Ensure secure access controls prevent unauthorized data access,
      exfiltration, and misuse of legitimate services by adversaries.
    control_family: Identity and Access Management
    nist_csf: PR.AC-3
    control_mappings:
      CCM:
        - DS-5
      ISO_27001:
        - 2013 A.13.1.3
      NIST_800_53:
        - AC-3
    test_requirements:
      tlp_red:
        01: |
          Verify that endpoints are blocked from public access, except for those explicitly added to an allowlist.
        02: |
          Confirm that services deployed within the same cloud tenant are blocked by default and only accessible to allowlisted services.
        03: |
          Ensure access from other cloud tenants is blocked by default, and only entities on the allowlist can access the service.

  - id: CCC.C06 # Prevent deployment in restricted regions
    title: Prevent deployment in restricted regions
    objective: |
      Ensure that resources are not provisioned or deployed in geographic
      regions or cloud availability zones that have been designated as
      restricted or prohibited, to comply with regulatory requirements and
      reduce exposure to geopolitical risks.
    control_family: Data
    threats:
      - CCC.TH05
    nist_csf: PR.DS-1
    control_mappings:
      CCM:
        - DSI-06
        - DSI-08
      ISO_27001:
        - 2013 A.11.1.1
      NIST_800_53:
        - AC-6
    test_requirements:
      01: |
        Verify that resources are not deployed in any
        restricted regions or cloud availability zones.
      02: |
        Ensure that the cloud provider's configuration management tools are
        used to enforce restrictions on provisioning in prohibited regions.
      03: |
        Confirm that backups and copies are not allowed to be
        stored in restricted regions or cloud availability zones.

  - id: CCC.C07 # Alert on non-human enumeration
    title: Alert on non-human enumeration
    control_family: Logging & Monitoring
    objective: |
      Ensure that logs and associated alerts are generated when non-human 
      entities (e.g., automated processes) attempt to enumerate 
      resources. This helps to detect and respond to potential malicious 
      reconnaissance activities early.
    threats: []
    nist_csf: DE.AE-1
    test_requirements:
      tlp_green:
        01: |
          Simulate non-human enumeration activities (e.g., with service accounts) and verify that alerts are triggered in the logging system.
        02: |
          Confirm that logs are properly generated and accessible for review following non-human enumeration attempts.

  - id: CCC.C08 # Enable multi-zone or multi-region data replication
    title: Enable multi-zone or multi-region data replication
    control_family: Data
    objective: |
      Ensure that data stored in object storage is replicated across multiple
      zones or regions to protect against data loss due to hardware failures,
      natural disasters, or other catastrophic events.
    threats:
      - CCC.TH06 # Data is lost or corrupted
    nist_csf: PR.PT-5
    test_requirements:
      - id: CCC.C08.TR01
        text: |
          Verify that data stored in object storage is replicated across
          multiple zones or regions.
        tlp_levels:
          - tlp_green
          - tlp_amber
          - tlp_red
      - id: CCC.ObjStor.C08.TR02
        text: |
          Perform a failover test to confirm that data remains accessible during 
          a simulated outage in one zone or region.
        tlp_levels:
          - tlp_green
          - tlp_amber
          - tlp_red