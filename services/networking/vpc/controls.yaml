common_controls:
  - CCC.C01 # Prevent unencrypted requests
  - CCC.C03 # Implement multi-factor authentication (MFA) for access
  - CCC.C04 # Log all access and changes
  - CCC.C05 # Prevent access from untrusted entities
  - CCC.C06 # Prevent deployment in restricted regions

controls:
  - id: CCC.VPC.C01
    title: Restrict default network creation
    objective: |
      Restrict the automatic creation of default virtual networks and related
      resources during subscription initialization to avoid insecure default
      configurations and enforce custom network policies.
    control_family: Network Security
    threats:
      - CCC.VPC.TH01 # Unauthorized access via insecure default networks
    nist_csf: PR.AC-5 # Network integrity is protected
    control_mappings:
      CCM:
        - TVM-02
      ISO_27001:
        - 2013 A.12.3.1
      NIST_800_53:
        - SC-7
    test_requirements:
      - id: CCC.VPC.C01.TR01
        text: |
          When a subscription is created, the subscription must not contain any
          default network resources.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C02
    title: Limit resource creation in public subnet
    objective: |
      Restrict the creation of resources in the public subnet with
      direct access the internet to minimize attack surfaces.
    control_family: Network Security
    threats:
      - CCC.VPC.TH02 # Exposure of resources to public internet
    nist_csf: PR.AC-3 # Remote access is managed
    control_mappings:
      CCM:
        - SEF-05
      ISO_27001:
        - 2013 A.13.1.1
      NIST_800_53:
        - AC-4
    test_requirements:
      - id: CCC.VPC.C02.TR01
        text: |
          When a resource is created, the resource must not be assigned an
          external IP address by default.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C03
    title: Restrict VPC peering to authorized accounts
    objective: |
      Ensure VPC peering connections are only established with explicitly
      authorized destinations to limit network exposure and enforce boundary
      controls.
    control_family: Network Security
    threats:
      - CCC.VPC.TH03 # Unauthorized network access through VPC peering
    nist_csf: PR.AC-3 # Remote access is managed
    control_mappings:
      CCM:
        - IVS-01
      ISO_27001:
        - 2013 A.13.1.3
      NIST_800_53:
        - AC-4
    test_requirements:
      - id: CCC.VPC.C04.TR01
        text: |
          When a VPC peering connection is requested for an untrusted
          destination, the VPCâ€™s peering configuration must remain unchanged.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C04
    title: Enforce VPC flow logs on VPCs
    objective: |
      Ensure VPCs are configured with flow logs enabled to capture traffic
      information.
    control_family: Network Security
    threats:
      - CCC.VPC.TH04 # Lack of network visibility due to disabled VPC flow logs
    nist_csf: PR.PT-1 # Audit/log records are determined, documented, implemented,
    # and reviewed in accordance with policy
    control_mappings:
      CCM:
        - IVS-06
      ISO_27001:
        - 2013 A.12.4.1
      NIST_800_53:
        - AU-2
    test_requirements:
      - id: CCC.VPC.C05.TR01
        text: |
          When any network traffic goes to or from an interface in the VPC, VPC
          flow logs must capture and log all relevant information.
        tlp_levels:
          - tlp_red
      - id: CCC.VPC.C05.TR02
        text: |
          When VPC flow logs are disabled, then the activity is logged in the
          cloud native logging service.
        tlp_levels:
          - tlp_red
