common_controls:
  - CCC.C01 # Prevent unencrypted requests
  - CCC.C03 # Implement multi-factor authentication (MFA) for access
  - CCC.C04 # Log all access and changes
  - CCC.C05 # Prevent access from untrusted entities
  - CCC.C06 # Prevent deployment in restricted regions

controls:
  - id: CCC.VPC.C01
    title: Prevent Default Network Creation
    objective: |
      Prevent the automatic creation of default virtual networks and related resources during cloud project initialization to avoid insecure default configurations and enforce custom network policies.
    control_family: Network Security
    threats:
      - CCC.VPC.TH01
    nist_csf: PR.AC-5
    control_mappings:
      CCM:
        - TVM-02
      ISO_27001:
        - 2013 A.12.3.1
      NIST_800_53:
        - SC-7
    test_requirements:
      - id: CCC.VPC.C01.TR01
        text: |
          When a new project/account/subscription is created, then the project/account/subscription MUST NOT contain any default network resources.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C02
    title: Limit External IP Addresses
    objective: |
      Restrict the assignment of external (public) IP addresses to resources to reduce exposure to the public internet and minimize attack surfaces.
    control_family: Network Security
    threats:
      - CCC.VPC.TH02
    nist_csf: PR.AC-3
    control_mappings:
      CCM:
        - SEF-05
      ISO_27001:
        - 2013 A.13.1.1
      NIST_800_53:
        - AC-4
    test_requirements:
      - id: CCC.VPC.C02.TR01
        text: |
          When a resource is created, then the resource MUST NOT be assigned an external IP address by default.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C03
    title: Restrict IP Forwarding on Virtual Machines
    objective: |
      Control the use of IP forwarding on virtual machines to prevent unauthorized network traffic routing and potential security risks.
    control_family: Network Security
    threats:
      - CCC.VPC.TH03
    nist_csf: PR.AC-5
    control_mappings:
      CCM:
        - SEF-05
      ISO_27001:
        - 2013 A.13.1.1
      NIST_800_53:
        - SC-7
    test_requirements:
      - id: CCC.VPC.C03.TR01
        text: |
          When an attempt is made to enable IP forwarding on a VM, then the VM configuration MUST remain unchanged.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C04
    title: Restrict VPC Peering to Authorized Accounts
    objective: |
      Ensure VPC peering connections are only established with explicitly authorized destinations to limit network exposure and enforce boundary controls.
    control_family: Network Security
    threats:
      - CCC.VPC.TH07
    nist_csf: PR.AC-3
    control_mappings:
      CCM:
        - IVS-01
      ISO_27001:
        - 2013 A.13.1.3
      NIST_800_53:
        - AC-4
    test_requirements:
      - id: CCC.VPC.C04.TR01
        text: |
          When a VPC peering connection is requested for an untrusted
          destination, the VPCâ€™s peering configuration MUST remain unchanged.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C05
    title: Enforce VPC Flow Logs on VPCs.
    objective: |
      Ensure VPCs are configured with flow logs enabled to capture traffic information, support auditing, and enhance network visibility and security.
    control_family: Network Security
    threats:
      - CCC.VPC.TH08
    nist_csf: PR.PT-1
    control_mappings:
      CCM:
        - IVS-06
      ISO_27001:
        - 2013 A.12.4.1
      NIST_800_53:
        - AU-2
    test_requirements:
      - id: CCC.VPC.C05.TR01
        text: |
          When any network traffic goes to or from an interface in the VPC, VPC flow logs MUST capture and log all relevant information.
        tlp_levels:
          - tlp_red
      - id: CCC.VPC.C05.TR02
        text: |
          When VPC flow logs are disabled, then the activity is logged in the cloud native logging service.
        tlp_levels:
          - tlp_red

  - id: CCC.VPC.C06
    title: Restrict Route Table Entries from Internet Gateway Access
    objective: |
      Ensure that route tables do not contain routes to an Internet Gateway.
    control_family: Network Security
    threats:
      - CCC.VPC.TH09
    nist_csf: PR.AC-5
    control_mappings:
      CCM:
        - DSI-04
      ISO_27001:
        - 2013 A.13.1.3
      NIST_800_53:
        - SC-7
    test_requirements:
      - id: CCC.VPC.C06.TR01
        text: |
          When a route table is created or updated, then it MUST NOT include a route to an Internet Gateway.
        tlp_levels:
          - tlp_red
      - id: CCC.VPC.C06.TR02
        text: |
          When an unauthorized route to an Internet Gateway is detected in any route table, then this must be logged.
        tlp_levels:
          - tlp_red
