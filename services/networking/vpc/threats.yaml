common_threats:
  - CCC.TH01 # Access control is misconfigured
  - CCC.TH02 # Data is intercepted in transit
  - CCC.TH03 # Deployment region network is untrusted
  - CCC.TH06 # Data is lost or corrupted
  - CCC.TH07 # Logs are Tampered With or Deleted

threats:
  - id: CCC.VPC.TH01
    title: Unauthorized Access via Insecure Default Networks
    description: |
      Default network configurations may include insecure settings and open firewall rules,
      leading to unauthorized access and potential data breaches.
    features:
      - CCC.VPC.F01 # Custom Network Creation
      - CCC.F06 # Identity Based Access Control (common feature)
    mitre_technique:
      - T1040 # Network Sniffing
      - T1136 # Create Account

  - id: CCC.VPC.TH02
    title: Exposure of Resources to Public Internet
    description: |
      Assignment of external IP addresses to resources exposes resources to the public internet, increasing the risk of attacks such as brute force, exploitation of vulnerabilities, or unauthorized access.
    features:
      - CCC.VPC.F02  # External IP Address Assignment
    mitre_technique:
      - T1133 # External Remote Services
      - T1078 # Valid Accounts

  - id: CCC.VPC.TH04
    title: Unauthorized Network Access through VPC Peering
    description: |
      Unauthorized VPC peering connections can allow network traffic between untrusted or unapproved subscriptions, leading to potential data exposure or exfiltration.
    features:
      - CCC.VPC.F11 # VPC Peering
    mitre_technique:
      - T1599  # Network Boundary Bridging

  - id: CCC.VPC.TH05
    title: Lack of Network Visibility Due to Disabled VPC Flow Logs
    description: |
      VPC subnets with disabled flow logs lack critical network traffic visibility, which can lead to undetected unauthorized access, data exfiltration, and network misconfigurations. This lack of visibility increases the risk of undetected security incidents.
    features:
      - CCC.VPC.F16  # VPC Flow Logs
    mitre_technique:
      - T1580 # Cloud Infrastructure Discovery

  - id: CCC.VPC.TH07
    title: Misconfigured or Unauthorized Access to VPC Endpoints
    description: |
      Nested virtualization can introduce additional layers of abstraction, increasing complexity and
      potentially leading to security vulnerabilities that can be exploited.
    features:
      - CCC.VPC.F06 # Nested Virtualization
      - CCC.F09 # Monitoring (common feature)
    mitre_technique:
      - T1497 # Virtualization/Sandbox Evasion
      - T1059 # Command and Scripting Interpreter
