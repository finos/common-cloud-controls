threats:
  - id: CCC.TH01
    title: Access control is misconfigured
    description: |
      An attacker can exploit misconfigured access controls to grant excessive
      privileges or gain unauthorized access to sensitive resources.
    features:
      - CCC.F06 # Identity based access control
    mitre_technique:
      - T1078 # Valid accounts
      - T1548 # Abuse elevation control mechanism
      - T1203 # Exploitation for credential access
      - T1098 # Account manipulation
      - T1484 # Domain or tenant policy modification
      - T1546 # Event triggered execution
      - T1537 # Transfer data to cloud account
      - T1567 # Exfiltration over web services
      - T1048 # Exfiltration over alternative protocol
      - T1485 # Data destruction
      - T1565 # Data manipulation
      - T1027 # Obfuscated files or information

  - id: CCC.TH02
    title: Data is intercepted in transit
    description: |
      In the event that encrypted communication is not properly in effect, an
      attacker can intercept traffic between clients and the service to read or
      modify the data during transmission.
    features:
      - CCC.F01 # Encryption in transit enabled by default
    mitre_technique:
      - T1557 # Adversary-in-the-middle
      - T1040 # Network sniffing

  - id: CCC.TH03
    title: Deployment region network is untrusted
    description: |
      If any part of the service is deployed in a hostile, unstable, or
      insecure location, an attacker may attempt to access the resource or
      intercept data by exploiting privileged network access or physical
      vulnerabilities.
    features:
      - CCC.F08 # Multi-zone deployment
    mitre_technique:
      - T1040 # Network sniffing
      - T1110 # Brute force
      - T1105 # Ingress tool transfer
      - T1583 # Acquire infrastructure
      - T1557 # Adversary-in-the-middle

  - id: CCC.TH04
    title: Data is replicated to untrusted or external locations
    description: |
      An attacker could replicate data to untrusted or external locations if replication configurations
      are not properly restricted. This could result in data leakage or exposure to unauthorized entities
      outside the organization's trusted perimeter.
    features:
      - CCC.F21 # Replication
    mitre_technique:
      - T1565 # Data manipulation

  - id: CCC.TH05
    title: Data is corrupted during replication
    description: |
      Malicious actors may attempt to corrupt, delay, or delete data during
      replication processes across multiple regions or availability zones,
      affecting the integrity and availability of data.
    features:
      - CCC.F08 # Multi-zone deployment
      - CCC.F12 # recovery
      - CCC.F21 # replication
    mitre_technique:
      - T1485 # Data destruction
      - T1565 # Data manipulation
      - T1491 # Defacement
      - T1490 # Inhibit system recovery

  - id: CCC.TH06
    title: Data is lost or corrupted
    description: |
      Data loss or corruption can occur due to accidental deletion,
      misconfiguration, or malicious activity.  This can result in the loss of
      critical data, service disruption, or unauthorized access to sensitive
      information.
    features:
      - CCC.F11 # Backup
      - CCC.F18 # Versioning
    mitre_technique:
      - T1485 # Data destruction
      - T1565 # Data manipulation
      - T1491 # Defacement
      - T1490 # Inhibit system recovery

  - id: CCC.TH07
    title: Logs are tampered with or deleted
    description: |
      Attackers may tamper with or delete logs to cover their tracks and evade
      detection. This prevents security teams from identifying the full scope
      of an attack and may disrupt forensic investigations.
    features:
      - CCC.F03 # Access/activity logs
      - CCC.F10 # Logging
    mitre_technique:
      - T1070 # Indicator removal on host
      - T1565 # Data manipulation (for altering log entries)
      - T1027 # Obfuscated files or information (if log files are altered to hide activity)

  - id: CCC.TH08
    title: Cost management data is manipulated
    description: |
      Attackers may manipulate cost management data to hide excessive resource
      consumption or to deceive users about resource usage. This could be used
      to exhaust budgets, cause financial losses, or evade detection of other attacks.
    features:
      - CCC.F15 # Cost management
    mitre_technique:
      - T1565 # Data manipulation
      - T1070 # Indicator removal on host

  - id: CCC.TH09
    title: Logs or monitoring data are read by unauthorized users
    description: |
      Unauthorized access to logs or monitoring data can provide attackers with
      valuable information about the system's configuration, operations, and
      security mechanisms. This can be used to identify vulnerabilities, plan
      attacks, or evade detection.
    features:
      - CCC.F03 # Access/activity logs
      - CCC.F09 # Monitoring
    mitre_technique:
      - T1003 # Credential dumping
      - T1007 # System service discovery
      - T1018 # Remote system discovery
      - T1033 # System owner/user discovery
      - T1046 # Network service discovery
      - T1057 # Process discovery
      - T1069 # Permission groups discovery
      - T1070 # Indicator removal
      - T1082 # System information discovery
      - T1120 # Peripheral device discovery
      - T1124 # System time discovery
      - T1497 # Virtualization/sandbox evasion
      - T1518 # Software discovery

  - id: CCC.TH10
    title: Alerts are intercepted
    description: |
      Malicious actors may exploit event notifications to monitor and
      intercept information about sensitive operations or access patterns.
    features:
      - CCC.F03 # Access/activity logs
      - CCC.F07 # Event notifications
      - CCC.F09 # Monitoring
      - CCC.F17 # Alerting
    mitre_technique:
      - T1057 # Process discovery
      - T1049 # System network connections discovery
      - T1083 # File and directory discovery

  - id: CCC.TH11
    title: Event notifications are incorrectly triggered
    description: |
      Malicious actors may exploit event notifications to trigger sensitive
      operations or access patterns. Alternately, attackers may flood the
      system with notifications to obfuscate another attack or overwhelm the
      service to disrupt legitimate operations.
    features:
      - CCC.F07 # Event notifications
      - CCC.F17 # Alerting
    mitre_technique:
      - T1205 # Traffic signaling
      - T1001.001 # Data obfuscation: Junk data
      - T1491.001 # Defacement: Internal defacement

  - id: CCC.TH12
    title: Resource constraints are exhausted
    description: |
      An attack or misconfiguration can consume all available resources, such
      as memory, CPU, or storage, to disrupt the service or deny access to
      legitimate users. This can be achieved through repeated requests,
      resource-intensive operations, or the lowering of rate/budget limits.
      Through auto-scaling, the attacker may also attempt to exhaust
      higher-level budget thresholds to impact other systems in the same scope.
    features:
      - CCC.F04 # Transaction rate limits
      - CCC.F16 # Budgeting
      - CCC.F19 # Auto-scaling
    mitre_technique:
      - T1496 # Resource hijacking
      - T1499 # Endpoint denial of service
      - T1498 # Network denial of service

  - id: CCC.TH13
    title: Resource tags are manipulated
    description: |
      Attackers may manipulate resource tags to alter organizational policies,
      disrupt billing, or evade detection. This can result in mismanaged
      resources, unauthorized access, or financial abuse.
    features:
      - CCC.F20 # Tagging
    mitre_technique:
      - T1565 # Data manipulation

  - id: CCC.TH14
    title: Older resource versions are exploited
    description: |
      Attackers may exploit vulnerabilities in older versions of resources,
      taking advantage of deprecated or insecure configurations. Without
      proper version control and monitoring, outdated versions can be used
      to bypass security measures.
    features:
      - CCC.F18 # Versioning
    mitre_technique:
      - T1027 # Obfuscated files or information
      - T1485 # Data destruction
      - T1565 # Data manipulation
      - T1489 # Service stop
      - T1562.01 # Impair defenses: Downgrade attack
      - T1027 # Obfuscated files or information
      - T1485 # Data destruction
      - T1565 # Data manipulation
      - T1489 # Service stop

  - id: CCC.TH15
    title: Automated enumeration and reconnaissance by non-human entities
    description: |
      Attackers may deploy automated processes or bots to perform reconnaissance
      activities by enumerating resources such as APIs, file systems, or directories.
      These activities can help attackers identify vulnerabilities, misconfigurations,
      or unsecured resources, which can then be exploited for unauthorized access
      or data theft.
    features:
      - CCC.F14 # API access
    mitre_technique:
      - T1580 # Cloud infrastructure discovery
