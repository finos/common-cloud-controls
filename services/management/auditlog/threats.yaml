shared-threats:
  - reference-id: CCC
    identifiers:
      - CCC.TH01 # Access Control is Misconfigured
      - CCC.TH04 # Data is Replicated to Untrusted or External Locations
      - CCC.TH06 # Data is Lost or Corrupted
      - CCC.TH07 # Logs are Tampered With or Deleted
      - CCC.TH09 # Logs or Monitoring Data are Read by Unauthorized Users
      - CCC.TH10 # Alerts are Intercepted
      - CCC.TH16 # Logging and Monitoring are Disabled

threats:
  - id: CCC.AUDITLOG.TH01
    title: Insufficient Audit Logs
    description: |
      If security critical audit events are not logged then it increases the difficulty to detect threats
      and perform post incident analysis.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.F03
          - CCC.F10
    external-mappings:
      - reference-id: OWASPTOP10
        identifiers:
          - A09:2021
      - reference-id: CWE
        identifiers:
          - CWE-778
          - CWE-223
  - id: CCC.AUDITLOG.TH02
    title: Insufficient Replication of Audit Logs
    description: |
      If audit logs are only kept locally and not replicated to a external system then there is a risk
      that they can be lost or more easily tampered with.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.F03
          - CCC.F10
    external-mappings:
      - reference-id: OWASPTOP10
        identifiers:
          - A09:2021
      - reference-id: CWE
        identifiers:
          - CWE778
  - id: CCC.AUDITLOG.TH03
    title: Log Ingestion Latency
    description: |
      Large spikes or consistent lag in log ingestion can lead to increased time to detect a threat
      and can increase the difficult of incident investigation.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.F03
          - CCC.F10
    external-mappings:
      - reference-id: MITRE-ATT&CK
        identifiers:
          - TA0005
      - reference-id: OWASPTOP10
        identifiers:
          - A09:2021
      - reference-id: CWE
        identifiers:
          - CWE-778
          - CWE-223
  - id: CCC.AUDITLOG.TH04
    title: Sensitive Data Logged
    description: |
      Sensitive information such as passwords / env var / PII can be included in audit logs due to human error
      (such as entering password in the username field) or by developers not sanitizing fields included in audit logs.
      This information can be misused by authorized or unauthorized parties with access to audit logs.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.F03
          - CCC.F10
    external-mappings:
      - reference-id: MITRE-ATT&CK
        identifiers:
          - TA0006
      - reference-id: OWASPTOP10
        identifiers:
          - A09:2021
          - A02:2021
      - reference-id: CWE
        identifiers:
          - CWE-532
          - CWE-200
  - id: CCC.AUDITLOG.TH05
    title: Insufficient encoding of audit logs
    description: |
      User-supplied malicious data such as; scripts, code, ASNI escape sequences,
      Unicode escape characters and CRLF injection can be included in Audit Logs.
      If not correctly encoded or sanitized then the unexpected log entries can be used
      as part of a exploit attack chain to effect a service upstream reading the audit logs.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.RDMS.F06
    external-mappings:
      - reference-id: OWASPTOP10
        identifiers:
          - A03:2021
          - A09:2021
      - reference-id: CWE
        identifiers:
          - CWE-79
          - CWE-117
          - CWE-116
