[
  {
    "message": "There are no AppInsight configured in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "appinsights_ensure_is_configured",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There are no AppInsight configured in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/azure-monitor/app/app-insights-overview",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Because Application Insights relies on a Log Analytics Workspace, an organization will incur additional expenses when using this service.",
      "compliance": {
        "PCI-4.0": [
          "10.2.1.1.3",
          "10.2.1.2.3",
          "10.2.1.3.3",
          "10.2.1.4.3",
          "10.2.1.5.3",
          "10.2.1.6.3",
          "10.2.1.7.3",
          "10.2.1.3",
          "10.2.2.3",
          "10.4.1.1.1",
          "10.4.1.1",
          "10.4.2.1",
          "10.6.3.3",
          "10.7.1.1",
          "10.7.2.1",
          "5.3.4.3",
          "A1.2.1.3",
          "A3.3.1.1",
          "A3.5.1.1"
        ],
        "CIS-2.0": [
          "5.3.1"
        ],
        "CCC": [
          "CCC.GenAI.C05.TR01",
          "CCC.Logging.C01.TR01"
        ],
        "CIS-2.1": [
          "5.3.1"
        ],
        "CIS-4.0": [
          "7.1.3.1"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.13"
        ],
        "NIS2": [
          "3.2.3.h",
          "5.1.2.a"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.2"
        ],
        "CIS-3.0": [
          "6.3.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Application Insights within Azure act as an Application Performance Monitoring solution providing valuable data into how well an application performs and additional information when performing incident response. The types of log data collected include application metrics, telemetry data, and application trace logging data providing organizations with detailed information about application activity and application transactions. Both data sets help organizations adopt a proactive and retroactive means to handle security and performance related metrics within their modern applications.",
      "title": "Ensure Application Insights are Configured.",
      "types": [],
      "uid": "prowler-azure-appinsights_ensure_is_configured-3bb71587-4549-4396-8898-9e15f062e665-global-AppInsights"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "appinsights"
        },
        "labels": [],
        "name": "AppInsights",
        "type": "Microsoft.Insights/components",
        "uid": "AppInsights"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to Application Insights 2. Under the Basics tab within the PROJECT DETAILS section, select the Subscription 3. Select the Resource group 4. Within the INSTANCE DETAILS, enter a Name 5. Select a Region 6. Next to Resource Mode, select Workspace-based 7. Within the WORKSPACE DETAILS, select the Subscription for the log analytics workspace 8. Select the appropriate Log Analytics Workspace 9. Click Next:Tags > 10. Enter the appropriate Tags as Name, Value pairs. 11. Click Next:Review+Create 12. Click Create.",
      "references": []
    },
    "risk_details": "Configuring Application Insights provides additional data not found elsewhere within Azure as part of a much larger logging and monitoring program within an organization's Information Security practice. The types and contents of these logs will act as both a potential cost saving measure (application performance) and a means to potentially confirm the source of a potential incident (trace logging). Metrics and Telemetry data provide organizations with a proactive approach to cost savings by monitoring an application's performance, while the trace logging data provides necessary details in a reactive incident response scenario by helping organizations identify the potential source of an incident within their application.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender Auto Provisioning Log Analytics Agents from subscription Azure subscription 1 is set to OFF.",
    "metadata": {
      "event_code": "defender_auto_provisioning_log_analytics_agent_vms_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender Auto Provisioning Log Analytics Agents from subscription Azure subscription 1 is set to OFF.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/security-center/security-center-data-security",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1",
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.0": [
          "2.1.15"
        ],
        "CIS-2.1": [
          "2.1.14"
        ],
        "MITRE-ATTACK": [
          "T1190"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.1.2.d",
          "3.2.3.c",
          "3.2.3.e",
          "3.2.3.g",
          "3.6.2",
          "6.9.2",
          "11.2.2.f"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "ENS-RD2022": [
          "op.mon.3.r2.az.de.1",
          "mp.s.4.r1.az.nt.5"
        ],
        "CIS-3.0": [
          "3.1.1.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'. The Microsoft Monitoring Agent scans for various security-related configurations and events such as system updates, OS vulnerabilities, endpoint protection, and provides alerts.",
      "title": "Ensure that Auto provisioning of 'Log Analytics agent for Azure VMs' is Set to 'On'",
      "types": [],
      "uid": "prowler-azure-defender_auto_provisioning_log_analytics_agent_vms_on-3bb71587-4549-4396-8898-9e15f062e665-global-default"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/autoProvisioningSettings/default",
            "resource_name": "default",
            "resource_type": "Microsoft.Security/autoProvisioningSettings",
            "auto_provision": "Off"
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "default",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/autoProvisioningSettings/default"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Ensure comprehensive visibility into possible security vulnerabilities, including missing updates, misconfigured operating system security settings, and active threats, allowing for timely mitigation and improved overall security posture",
      "references": [
        "https://learn.microsoft.com/en-us/azure/defender-for-cloud/monitoring-components"
      ]
    },
    "risk_details": "Missing critical security information about your Azure VMs, such as security alerts, security recommendations, and change tracking.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Container image scan is disabled in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "defender_container_images_scan_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Container image scan is disabled in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/container-registry/container-registry-check-health",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "When using an Azure container registry, you might occasionally encounter problems. For example, you might not be able to pull a container image because of an issue with Docker in your local environment. Or, a network issue might prevent you from connecting to the registry.",
      "compliance": {
        "SOC2": [
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "PCI-4.0": [
          "11.3.1.2.1",
          "11.3.1.3.3",
          "11.3.1.3"
        ],
        "CCC": [
          "CCC.CntrReg.C01.TR01"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1525"
        ],
        "NIS2": [
          "2.2.1",
          "3.1.2.d",
          "3.6.2",
          "5.1.4.f",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.19",
          "A.5.21",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Scan images being deployed to Azure (AKS) for vulnerabilities. Vulnerability scanning for images stored in Azure Container Registry is generally available in Azure Security Center. This capability is powered by Qualys, a leading provider of information security. When you push an image to Container Registry, Security Center automatically scans it, then checks for known vulnerabilities in packages or dependencies defined in the file. When the scan completes (after about 10 minutes), Security Center provides details and a security classification for each vulnerability detected, along with guidance on how to remediate issues and protect vulnerable attack surfaces.",
      "title": "Ensure Image Vulnerability Scanning using Azure Defender image scanning or a third party provider",
      "types": [],
      "uid": "prowler-azure-defender_container_images_scan_enabled-3bb71587-4549-4396-8898-9e15f062e665-global-Containers"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Containers",
            "resource_name": "Containers",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Containers",
        "type": "Microsoft.Security",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Containers"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "",
      "references": [
        "https://learn.microsoft.com/en-us/azure/container-registry/scan-images-defender"
      ]
    },
    "risk_details": "Vulnerabilities in software packages can be exploited by hackers or malicious users to obtain unauthorized access to local cloud resources. Azure Defender and other third party products allow images to be scanned for known vulnerabilities.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for App Services from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_app_services_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for App Services from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.1": [
          "2.1.2"
        ],
        "CIS-4.0": [
          "9.1.6.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1059",
          "T1204",
          "T1552",
          "T1486",
          "T1499",
          "T1496",
          "T1087"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.19",
          "A.5.21",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.3"
        ],
        "CIS-3.0": [
          "3.1.6.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for App Services Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for App Services Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_app_services_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan App Services"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/AppServices",
            "resource_name": "AppServices",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan App Services",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/AppServices"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "By default, Microsoft Defender for Cloud is not enabled for your App Service instances. Enabling the Defender security service for App Service instances allows for advanced security defense using threat detection capabilities provided by Microsoft Security Response Center.",
      "references": []
    },
    "risk_details": "Turning on Microsoft Defender for App Service enables threat detection for App Service, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for ARM from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_arm_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for ARM from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.12"
        ],
        "CIS-2.1": [
          "2.1.11"
        ],
        "CIS-4.0": [
          "9.1.9.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1562",
          "T1486",
          "T1499",
          "T1087",
          "T1580",
          "T1538",
          "T1526",
          "T1069"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.19",
          "A.5.21",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.3"
        ],
        "CIS-3.0": [
          "3.1.9.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Azure Resource Manager Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for Azure Resource Manager Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_arm_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan ARM"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Arm",
            "resource_name": "Arm",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan ARM",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Arm"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Enable  Microsoft Defender for Azure Resource Manager",
      "references": []
    },
    "risk_details": "Scanning resource requests lets you be alerted every time there is suspicious activity in order to prevent a security threat from being introduced.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for Azure SQL DB Servers from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_azure_sql_databases_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Azure SQL DB Servers from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.4"
        ],
        "CIS-2.1": [
          "2.1.3"
        ],
        "CIS-4.0": [
          "9.1.7.3"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.19",
          "A.5.21",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.4"
        ],
        "CIS-3.0": [
          "3.1.7.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Azure SQL Databases Is Set To 'On'  ",
      "title": "Ensure That Microsoft Defender for Azure SQL Databases Is Set To 'On'  ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_azure_sql_databases_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-SqlServers"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/SqlServers",
            "resource_name": "SqlServers",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "SqlServers",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/SqlServers"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "By default, Microsoft Defender for Cloud is disabled for all your SQL database servers. Defender for Cloud monitors your SQL database servers for threats such as SQL injection, brute-force attacks, and privilege abuse. The security service provides action-oriented security alerts with details of the suspicious activity and guidance on how to mitigate the security threats.",
      "references": []
    },
    "risk_details": "Turning on Microsoft Defender for Azure SQL Databases enables threat detection for Azure SQL database servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for Containers from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_containers_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Containers from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.8"
        ],
        "CIS-2.1": [
          "2.1.8"
        ],
        "CIS-4.0": [
          "9.1.4.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1525",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.3"
        ],
        "CIS-3.0": [
          "3.1.4.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Containers Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for Containers Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_containers_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Containers"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Containers",
            "resource_name": "Containers",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Containers",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Containers"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "By default, Microsoft Defender for Cloud is not enabled for your Azure cloud containers. Enabling the Defender security service for Azure containers allows for advanced security defense against threats, using threat detection capabilities provided by the Microsoft Security Response Center (MSRC).",
      "references": []
    },
    "risk_details": "Ensure that Microsoft Defender for Cloud is enabled for all your Azure containers. Turning on the Defender for Cloud service enables threat detection for containers, providing threat intelligence, anomaly detection, and behavior analytics.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for Cosmos DB from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_cosmosdb_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Cosmos DB from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.9"
        ],
        "CIS-2.1": [
          "2.1.6"
        ],
        "CIS-4.0": [
          "9.1.7.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.4"
        ],
        "CIS-3.0": [
          "3.1.7.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Cosmos DB Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for Cosmos DB Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_cosmosdb_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan Cosmos DB"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/CosmosDbs",
            "resource_name": "CosmosDbs",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan Cosmos DB",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/CosmosDbs"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "By default, Microsoft Defender for Cloud is not enabled for your App Service instances. Enabling the Defender security service for App Service instances allows for advanced security defense using threat detection capabilities provided by Microsoft Security Response Center.",
      "references": [
        "Enable Microsoft Defender for Cosmos DB"
      ]
    },
    "risk_details": "In scanning Cosmos DB requests within a subscription, requests are compared to a heuristic list of potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a potential security threat from being introduced.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for Databases from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_databases_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Databases from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.3"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.4"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Databases Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for Databases Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_databases_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-SqlServers"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/SqlServers",
            "resource_name": "SqlServers",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "SqlServers",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/SqlServers"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Enable Microsoft Defender for Azure SQL Databases",
      "references": []
    },
    "risk_details": "Enabling Microsoft Defender for Azure SQL Databases allows your organization more granular control of the infrastructure running your database software",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for DNS from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_dns_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for DNS from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.11"
        ],
        "CIS-2.1": [
          "2.1.10"
        ],
        "CIS-4.0": [
          "9.1.17"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.21"
        ],
        "NIS2": [
          "3.6.2",
          "6.7.2.i",
          "6.7.2.l",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.3"
        ],
        "CIS-3.0": [
          "3.1.16"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for DNS Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for DNS Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_dns_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan DNS"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Dns",
            "resource_name": "Dns",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan DNS",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/Dns"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "By default, Microsoft Defender for Cloud is not enabled for your App Service instances. Enabling the Defender security service for App Service instances allows for advanced security defense using threat detection capabilities provided by Microsoft Security Response Center.",
      "references": []
    },
    "risk_details": "DNS lookups within a subscription are scanned and compared to a dynamic list of websites that might be potential security threats. These threats could be a result of a security breach within your services, thus scanning for them could prevent a potential security threat from being introduced.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for KeyVaults from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_keyvault_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for KeyVaults from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "PCI-4.0": [
          "3.5.1.31",
          "3.5.1.32",
          "8.3.2.50",
          "8.3.2.51"
        ],
        "CIS-2.0": [
          "2.1.10"
        ],
        "CIS-2.1": [
          "2.1.9"
        ],
        "CIS-4.0": [
          "9.1.8.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499",
          "T1580"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2",
          "9.2.c",
          "9.2.c.iv"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "op.acc.6.r1.az.eid.3"
        ],
        "CIS-3.0": [
          "3.1.8.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for KeyVault Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for KeyVault Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_keyvault_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan KeyVaults"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/KeyVaults",
            "resource_name": "KeyVaults",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan KeyVaults",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/KeyVaults"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Ensure that Microsoft Defender for Cloud is enabled for Azure key vaults. Key Vault is the Azure cloud service that safeguards encryption keys and secrets like certificates, connection-based strings, and passwords.",
      "references": []
    },
    "risk_details": "By default, Microsoft Defender for Cloud is disabled for Azure key vaults. Defender for Cloud detects unusual and potentially harmful attempts to access or exploit your Azure Key Vault data. This layer of protection allows you to address threats without being a security expert, and without the need to use and manage third-party security monitoring tools or services.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for Open-Source Relational Databases from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_os_relational_databases_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Open-Source Relational Databases from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.6"
        ],
        "CIS-2.1": [
          "2.1.5"
        ],
        "CIS-4.0": [
          "9.1.7.2"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.4"
        ],
        "CIS-3.0": [
          "3.1.7.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Open-Source Relational Databases Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for Open-Source Relational Databases Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_os_relational_databases_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan Open-Source Relational Databases"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/OpenSourceRelationalDatabases",
            "resource_name": "OpenSourceRelationalDatabases",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan Open-Source Relational Databases",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/OpenSourceRelationalDatabases"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Enabling Microsoft Defender for Open-source relational databases allows for greater defense-in-depth, with threat detection provided by the Microsoft Security Response Center (MSRC).",
      "references": []
    },
    "risk_details": "Turning on Microsoft Defender for Open-source relational databases enables threat detection for Open-source relational databases, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for Servers from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_server_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Servers from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.1",
          "2.1.2"
        ],
        "CIS-2.1": [
          "2.1.1"
        ],
        "CIS-4.0": [
          "6.2.7",
          "9.1.3.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "ProwlerThreatScore-1.0": [
          "1.1.4"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "op.mon.3.r1.az.ev.1",
          "mp.s.4.r1.az.nt.3"
        ],
        "CIS-3.0": [
          "2.2.8",
          "3.1.3.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Servers Is Set to 'On'",
      "title": "Ensure That Microsoft Defender for Servers Is Set to 'On'",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_server_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan Servers"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/VirtualMachines",
            "resource_name": "VirtualMachines",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan Servers",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/VirtualMachines"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Enabling Microsoft Defender for Cloud standard pricing tier allows for better security assessment with threat detection provided by the Microsoft Security Response Center (MSRC), advanced security policies, adaptive application control, network threat detection, and regulatory compliance management.",
      "references": []
    },
    "risk_details": "Turning on Microsoft Defender for Servers enables threat detection for Servers, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for SQL Server VMs from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_sql_servers_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for SQL Server VMs from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.5"
        ],
        "CIS-2.1": [
          "2.1.4"
        ],
        "CIS-4.0": [
          "9.1.7.4"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.4"
        ],
        "CIS-3.0": [
          "3.1.7.4"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for SQL Servers on Machines Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for SQL Servers on Machines Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_sql_servers_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan SQL Server VMs"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/SqlServerVirtualMachines",
            "resource_name": "SqlServerVirtualMachines",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan SQL Server VMs",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/SqlServerVirtualMachines"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "By default, Microsoft Defender for Cloud is disabled for the Microsoft SQL servers running on virtual machines. Defender for Cloud for SQL Server virtual machines continuously monitors your SQL database servers for threats such as SQL injection, brute-force attacks, and privilege abuse. The security service provides security alerts together with details of the suspicious activity and guidance on how to mitigate to the security threats.",
      "references": []
    },
    "risk_details": "Turning on Microsoft Defender for SQL servers on machines enables threat detection for SQL servers on machines, providing threat intelligence, anomaly detection, and behavior analytics in the Microsoft Defender for Cloud.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Defender plan Defender for Storage Accounts from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "metadata": {
      "event_code": "defender_ensure_defender_for_storage_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Defender plan Defender for Storage Accounts from subscription Azure subscription 1 is set to OFF (pricing tier not standard).",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.7"
        ],
        "CIS-2.1": [
          "2.1.7"
        ],
        "CIS-4.0": [
          "9.1.5.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1537",
          "T1530",
          "T1485",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.19",
          "A.5.21",
          "A.5.22",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.5"
        ],
        "CIS-3.0": [
          "3.1.5.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure That Microsoft Defender for Storage Is Set To 'On' ",
      "title": "Ensure That Microsoft Defender for Storage Is Set To 'On' ",
      "types": [],
      "uid": "prowler-azure-defender_ensure_defender_for_storage_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-Defender plan Storage Accounts"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/StorageAccounts",
            "resource_name": "StorageAccounts",
            "pricing_tier": "Free",
            "free_trial_remaining_time": 2592000.0,
            "extensions": {}
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "Defender plan Storage Accounts",
        "type": "AzureDefenderPlan",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/pricings/StorageAccounts"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "By default, Microsoft Defender for Cloud is disabled for your storage accounts. Enabling the Defender security service for Azure storage accounts allows for advanced security defense using threat detection capabilities provided by the Microsoft Security Response Center (MSRC). MSRC investigates all reports of security vulnerabilities affecting Microsoft products and services, including Azure cloud services.",
      "references": []
    },
    "risk_details": "Ensure that Microsoft Defender for Cloud is enabled for your Microsoft Azure storage accounts. Defender for storage accounts is an Azure-native layer of security intelligence that detects unusual and potentially harmful attempts to access or exploit your Azure cloud storage accounts.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "No IoT Security Solutions found in the subscription Azure subscription 1.",
    "metadata": {
      "event_code": "defender_ensure_iot_hub_defender_is_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "No IoT Security Solutions found in the subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://azure.microsoft.com/en-us/services/iot-defender/#overview",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Enabling Microsoft Defender for IoT will incur additional charges dependent on the level of usage.",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.2.1"
        ],
        "CIS-2.1": [
          "2.2.1"
        ],
        "CIS-4.0": [
          "9.2.1"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486",
          "T1499"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.19",
          "A.5.21",
          "A.5.25",
          "A.5.28",
          "A.5.29",
          "A.8.7",
          "A.8.9"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.3"
        ],
        "CIS-3.0": [
          "3.2.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Microsoft Defender for IoT acts as a central security hub for IoT devices within your organization.",
      "title": "Ensure That Microsoft Defender for IoT Hub Is Set To 'On'",
      "types": [],
      "uid": "prowler-azure-defender_ensure_iot_hub_defender_is_on-3bb71587-4549-4396-8898-9e15f062e665-global-IoT Hub Defender"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "IoT Hub Defender",
        "type": "DefenderIoT",
        "uid": "IoT Hub Defender"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Go to IoT Hub. 2. Select a IoT Hub to validate. 3. Select Overview in Defender for IoT. 4. Click on Secure your IoT solution, and complete the onboarding.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/defender-for-iot/device-builders/quickstart-onboard-iot-hub"
      ]
    },
    "risk_details": "IoT devices are very rarely patched and can be potential attack vectors for enterprise networks. Updating their network configuration to use a central security hub allows for detection of these breaches.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Microsoft Defender for Cloud Apps is enabled for subscription Azure subscription 1.",
    "metadata": {
      "event_code": "defender_ensure_mcas_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Microsoft Defender for Cloud Apps is enabled for subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-in/azure/defender-for-cloud/defender-for-cloud-introduction#secure-cloud-applications",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Microsoft Defender for Cloud Apps works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "PCI-4.0": [
          "11.5.1.1.2",
          "11.5.1.2"
        ],
        "CIS-2.0": [
          "2.1.21"
        ],
        "CIS-2.1": [
          "2.1.20"
        ],
        "MITRE-ATTACK": [
          "T1190",
          "T1486"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.22"
        ],
        "ENS-RD2022": [
          "mp.s.4.r1.az.nt.3"
        ],
        "CIS-3.0": [
          "3.1.1.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "This integration setting enables Microsoft Defender for Cloud Apps (formerly 'Microsoft Cloud App Security' or 'MCAS' - see additional info) to communicate with Microsoft Defender for Cloud.",
      "title": "Ensure that Microsoft Defender for Cloud Apps integration with Microsoft Defender for Cloud is Selected",
      "types": [],
      "uid": "prowler-azure-defender_ensure_mcas_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-global-MCAS"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/settings/MCAS",
            "resource_type": "Microsoft.Security/settings",
            "kind": "DataExportSettings",
            "enabled": true
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "MCAS",
        "type": "DefenderSettings",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/settings/MCAS"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. From Azure Home select the Portal Menu. 2. Select Microsoft Defender for Cloud. 3. Select Environment Settings blade. 4. Select the subscription. 5. Check App Service Defender Plan to On. 6. Select Save.",
      "references": [
        "https://docs.microsoft.com/en-us/rest/api/securitycenter/settings/list"
      ]
    },
    "risk_details": "Microsoft Defender for Cloud offers an additional layer of protection by using Azure Resource Manager events, which is considered to be the control plane for Azure. By analyzing the Azure Resource Manager records, Microsoft Defender for Cloud detects unusual or potentially harmful operations in the Azure subscription environment. Several of the preceding analytics are powered by Microsoft Defender for Cloud Apps. To benefit from these analytics, subscription must have a Cloud App Security license. Microsoft Defender for Cloud Apps works only with Standard Tier subscriptions.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Microsoft Defender for Endpoint integration is enabled for subscription Azure subscription 1.",
    "metadata": {
      "event_code": "defender_ensure_wdatp_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Microsoft Defender for Endpoint integration is enabled for subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-in/azure/defender-for-cloud/integration-defender-for-endpoint?tabs=windows",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Microsoft Defender for Endpoint works with Standard pricing tier Subscription. Choosing the Standard pricing tier of Microsoft Defender for Cloud incurs an additional cost per resource.",
      "compliance": {
        "SOC2": [
          "cc_3_1",
          "cc_3_2",
          "cc_4_2",
          "cc_6_8",
          "cc_7_1"
        ],
        "CIS-2.0": [
          "2.1.22"
        ],
        "CIS-2.1": [
          "2.1.21"
        ],
        "MITRE-ATTACK": [
          "T1190"
        ],
        "NIS2": [
          "3.6.2",
          "6.9.2"
        ],
        "ENS-RD2022": [
          "op.mon.3.r3.az.de.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "This integration setting enables Microsoft Defender for Endpoint (formerly 'Advanced Threat Protection' or 'ATP' or 'WDATP' - see additional info) to communicate with Microsoft Defender for Cloud.",
      "title": "Ensure that Microsoft Defender for Endpoint integration with Microsoft Defender for Cloud is selected",
      "types": [],
      "uid": "prowler-azure-defender_ensure_wdatp_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-global-WDATP"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "resource_id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/settings/WDATP",
            "resource_type": "Microsoft.Security/settings",
            "kind": "DataExportSettings",
            "enabled": true
          }
        },
        "group": {
          "name": "defender"
        },
        "labels": [],
        "name": "WDATP",
        "type": "DefenderSettings",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Security/settings/WDATP"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "",
      "references": [
        "https://learn.microsoft.com/en-us/microsoft-365/security/defender-endpoint/azure-server-integration?view=o365-worldwide"
      ]
    },
    "risk_details": "Microsoft Defender for Endpoint integration brings comprehensive Endpoint Detection and Response (EDR) capabilities within Microsoft Defender for Cloud. This integration helps to spot abnormalities, as well as detect and respond to advanced attacks on endpoints monitored by Microsoft Defender for Cloud. MDE works only with Standard Tier subscriptions.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Role assignment 1b4a98ae-5221-4850-a761-4f9176407028 in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "metadata": {
      "event_code": "iam_role_user_access_admin_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Role assignment 1b4a98ae-5221-4850-a761-4f9176407028 in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/privileged#user-access-administrator",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.GenAI.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.LB.C05.TR01",
          "CCC.LB.C09.TR01",
          "CCC.MLDE.CN01.AR01",
          "CCC.MLDE.CN03.AR01",
          "CCC.MLDE.CN03.AR02",
          "CCC.Vector.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN05.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05",
          "CCC.Core.CN05.AR06"
        ],
        "CIS-4.0": [
          "6.3.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Checks for active assignments of the highly privileged 'User Access Administrator' role in Azure subscriptions.",
      "title": "Ensure 'User Access Administrator' role is restricted",
      "types": [],
      "uid": "prowler-azure-iam_role_user_access_admin_restricted-3bb71587-4549-4396-8898-9e15f062e665-global-1b4a98ae-5221-4850-a761-4f9176407028"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/1b4a98ae-5221-4850-a761-4f9176407028",
            "name": "1b4a98ae-5221-4850-a761-4f9176407028",
            "scope": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665",
            "agent_id": "88c2c157-980b-416e-b77e-ec04f7f1b984",
            "agent_type": "User",
            "role_id": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
          }
        },
        "group": {
          "name": "iam"
        },
        "labels": [],
        "name": "1b4a98ae-5221-4850-a761-4f9176407028",
        "type": "AzureIAMRoleassignment",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/1b4a98ae-5221-4850-a761-4f9176407028"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Remove 'User Access Administrator' role assignments immediately after use to minimize security risks.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?tabs=azure-portal%2Centra-audit-logs"
      ]
    },
    "risk_details": "Persistent assignment of this role can lead to privilege escalation and unauthorized access, increasing the risk of security breaches.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Role assignment 083c1758-89d9-4b12-8005-48e7e359dc4f in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "metadata": {
      "event_code": "iam_role_user_access_admin_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Role assignment 083c1758-89d9-4b12-8005-48e7e359dc4f in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/privileged#user-access-administrator",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.GenAI.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.LB.C05.TR01",
          "CCC.LB.C09.TR01",
          "CCC.MLDE.CN01.AR01",
          "CCC.MLDE.CN03.AR01",
          "CCC.MLDE.CN03.AR02",
          "CCC.Vector.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN05.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05",
          "CCC.Core.CN05.AR06"
        ],
        "CIS-4.0": [
          "6.3.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Checks for active assignments of the highly privileged 'User Access Administrator' role in Azure subscriptions.",
      "title": "Ensure 'User Access Administrator' role is restricted",
      "types": [],
      "uid": "prowler-azure-iam_role_user_access_admin_restricted-3bb71587-4549-4396-8898-9e15f062e665-global-083c1758-89d9-4b12-8005-48e7e359dc4f"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/083c1758-89d9-4b12-8005-48e7e359dc4f",
            "name": "083c1758-89d9-4b12-8005-48e7e359dc4f",
            "scope": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665",
            "agent_id": "88c2c157-980b-416e-b77e-ec04f7f1b984",
            "agent_type": "User",
            "role_id": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
          }
        },
        "group": {
          "name": "iam"
        },
        "labels": [],
        "name": "083c1758-89d9-4b12-8005-48e7e359dc4f",
        "type": "AzureIAMRoleassignment",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/083c1758-89d9-4b12-8005-48e7e359dc4f"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Remove 'User Access Administrator' role assignments immediately after use to minimize security risks.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?tabs=azure-portal%2Centra-audit-logs"
      ]
    },
    "risk_details": "Persistent assignment of this role can lead to privilege escalation and unauthorized access, increasing the risk of security breaches.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Role assignment 2c61de5e-5cbb-42b9-9f2a-9dd930efe3fb in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "metadata": {
      "event_code": "iam_role_user_access_admin_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Role assignment 2c61de5e-5cbb-42b9-9f2a-9dd930efe3fb in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/privileged#user-access-administrator",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.GenAI.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.LB.C05.TR01",
          "CCC.LB.C09.TR01",
          "CCC.MLDE.CN01.AR01",
          "CCC.MLDE.CN03.AR01",
          "CCC.MLDE.CN03.AR02",
          "CCC.Vector.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN05.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05",
          "CCC.Core.CN05.AR06"
        ],
        "CIS-4.0": [
          "6.3.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Checks for active assignments of the highly privileged 'User Access Administrator' role in Azure subscriptions.",
      "title": "Ensure 'User Access Administrator' role is restricted",
      "types": [],
      "uid": "prowler-azure-iam_role_user_access_admin_restricted-3bb71587-4549-4396-8898-9e15f062e665-global-2c61de5e-5cbb-42b9-9f2a-9dd930efe3fb"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/2c61de5e-5cbb-42b9-9f2a-9dd930efe3fb",
            "name": "2c61de5e-5cbb-42b9-9f2a-9dd930efe3fb",
            "scope": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665",
            "agent_id": "88c2c157-980b-416e-b77e-ec04f7f1b984",
            "agent_type": "User",
            "role_id": "b24988ac-6180-42a0-ab88-20f7382dd24c"
          }
        },
        "group": {
          "name": "iam"
        },
        "labels": [],
        "name": "2c61de5e-5cbb-42b9-9f2a-9dd930efe3fb",
        "type": "AzureIAMRoleassignment",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/2c61de5e-5cbb-42b9-9f2a-9dd930efe3fb"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Remove 'User Access Administrator' role assignments immediately after use to minimize security risks.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?tabs=azure-portal%2Centra-audit-logs"
      ]
    },
    "risk_details": "Persistent assignment of this role can lead to privilege escalation and unauthorized access, increasing the risk of security breaches.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Role assignment 154eadeb-e375-4263-b4bd-4a2a2237ecd2 in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "metadata": {
      "event_code": "iam_role_user_access_admin_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Role assignment 154eadeb-e375-4263-b4bd-4a2a2237ecd2 in subscription Azure subscription 1 does not grant User Access Administrator role.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles/privileged#user-access-administrator",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.GenAI.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.LB.C05.TR01",
          "CCC.LB.C09.TR01",
          "CCC.MLDE.CN01.AR01",
          "CCC.MLDE.CN03.AR01",
          "CCC.MLDE.CN03.AR02",
          "CCC.Vector.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN05.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05",
          "CCC.Core.CN05.AR06"
        ],
        "CIS-4.0": [
          "6.3.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Checks for active assignments of the highly privileged 'User Access Administrator' role in Azure subscriptions.",
      "title": "Ensure 'User Access Administrator' role is restricted",
      "types": [],
      "uid": "prowler-azure-iam_role_user_access_admin_restricted-3bb71587-4549-4396-8898-9e15f062e665-global-154eadeb-e375-4263-b4bd-4a2a2237ecd2"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/154eadeb-e375-4263-b4bd-4a2a2237ecd2",
            "name": "154eadeb-e375-4263-b4bd-4a2a2237ecd2",
            "scope": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665",
            "agent_id": "80dfb9bd-1c99-4012-9de7-580a68334b45",
            "agent_type": "ServicePrincipal",
            "role_id": "8e3af657-a8ff-443c-a75c-2fe8c4bcb635"
          }
        },
        "group": {
          "name": "iam"
        },
        "labels": [],
        "name": "154eadeb-e375-4263-b4bd-4a2a2237ecd2",
        "type": "AzureIAMRoleassignment",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/roleAssignments/154eadeb-e375-4263-b4bd-4a2a2237ecd2"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Remove 'User Access Administrator' role assignments immediately after use to minimize security risks.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?tabs=azure-portal%2Centra-audit-logs"
      ]
    },
    "risk_details": "Persistent assignment of this role can lead to privilege escalation and unauthorized access, increasing the risk of security breaches.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for creating Policy Assignments in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_create_policy_assignment",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating Policy Assignments in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.1"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.KeyMgmt.C01.TR01",
          "CCC.LB.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.1"
        ],
        "CIS-4.0": [
          "7.1.2.1"
        ],
        "MITRE-ATTACK": [
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.3"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.b",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.3.1",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.mon.2.r1.az.ma.1"
        ],
        "CIS-3.0": [
          "6.2.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Create Policy Assignment event.",
      "title": "Ensure that Activity Log Alert exists for Create Policy Assignment",
      "types": [],
      "uid": "prowler-azure-monitor_alert_create_policy_assignment-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Policy assignment (policyAssignments). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create policy assignment (Microsoft.Authorization/policyAssignments). 12. Select the Actions tab. 13. To use an existing action group, click elect action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log"
      ]
    },
    "risk_details": "Monitoring for create policy assignment events gives insight into changes done in 'Azure policy - assignments' and can reduce the time it takes to detect unsolicited changes.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for creating/updating Network Security Groups in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_create_update_nsg",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating Network Security Groups in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "PCI-4.0": [
          "10.2.1.1.8",
          "10.4.2.2",
          "10.4.3.1",
          "10.6.3.8",
          "10.7.1.3",
          "10.7.2.3",
          "11.5.2.2",
          "11.6.1.2",
          "12.10.5.2",
          "A3.3.1.3",
          "A3.5.1.3"
        ],
        "CIS-2.0": [
          "5.2.3"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.KeyMgmt.C01.TR01",
          "CCC.LB.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.3"
        ],
        "CIS-4.0": [
          "7.1.2.3"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.5"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.a",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.3.1",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.mon.2.r1.az.ma.1"
        ],
        "CIS-3.0": [
          "6.2.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an Activity Log Alert for the Create or Update Network Security Group event.",
      "title": "Ensure that Activity Log Alert exists for Create or Update Network Security Group",
      "types": [],
      "uid": "prowler-azure-monitor_alert_create_update_nsg-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Network security groups. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Network Security Group (Microsoft.Network/networkSecurityGroups). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for Create or Update Network Security Group events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for creating/updating Public IP address rule in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_create_update_public_ip_address_rule",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating Public IP address rule in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.9"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.KeyMgmt.C01.TR01",
          "CCC.LB.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.9"
        ],
        "CIS-4.0": [
          "7.1.2.9"
        ],
        "MITRE-ATTACK": [
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.11"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.a",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.1",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.mon.2.r1.az.ma.1"
        ],
        "CIS-3.0": [
          "6.2.9"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Create or Update Public IP Addresses rule.",
      "title": "Ensure that Activity Log Alert exists for Create or Update Public IP Address rule",
      "types": [],
      "uid": "prowler-azure-monitor_alert_create_update_public_ip_address_rule-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Public IP addresses. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Public Ip Address (Microsoft.Network/publicIPAddresses). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for Create or Update Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for creating/updating Security Solution in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_create_update_security_solution",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating Security Solution in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.5"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.KeyMgmt.C01.TR01",
          "CCC.LB.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.5"
        ],
        "CIS-4.0": [
          "7.1.2.5"
        ],
        "MITRE-ATTACK": [
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.7"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.5.16",
          "A.5.22",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.mon.2.r1.az.ma.1",
          "op.mon.3.r6.az.ma.1"
        ],
        "CIS-3.0": [
          "6.2.5"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Create or Update Security Solution event.",
      "title": "Ensure that Activity Log Alert exists for Create or Update Security Solution",
      "types": [],
      "uid": "prowler-azure-monitor_alert_create_update_security_solution-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Security Solutions (securitySolutions). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Security Solutions (Microsoft.Security/securitySolutions). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for Create or Update Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for creating/updating SQL Server firewall rule in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_create_update_sqlserver_fr",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for creating/updating SQL Server firewall rule in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "PCI-4.0": [
          "10.2.1.1.9",
          "10.2.1.1.10",
          "10.2.1.1.22",
          "10.2.1.2.8",
          "10.2.1.2.19",
          "10.2.1.3.8",
          "10.2.1.3.19",
          "10.2.1.4.8",
          "10.2.1.4.19",
          "10.2.1.5.8",
          "10.2.1.5.19",
          "10.2.1.6.8",
          "10.2.1.6.19",
          "10.2.1.7.8",
          "10.2.1.7.19",
          "10.2.1.8",
          "10.2.1.19",
          "10.2.2.8",
          "10.2.2.19",
          "10.3.1.8",
          "10.3.1.19",
          "10.4.1.1.2",
          "10.4.1.2",
          "10.4.2.3",
          "10.6.3.9",
          "10.6.3.10",
          "10.6.3.24",
          "10.7.1.4",
          "10.7.2.4",
          "5.3.4.9",
          "5.3.4.22",
          "A1.2.1.10",
          "A1.2.1.23",
          "A3.3.1.4",
          "A3.5.1.4"
        ],
        "CIS-2.0": [
          "5.2.7"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.7"
        ],
        "CIS-4.0": [
          "7.1.2.7"
        ],
        "MITRE-ATTACK": [
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.9"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.a",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.3.1",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.mon.2.r1.az.ma.1"
        ],
        "CIS-3.0": [
          "6.2.7"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Create or Update SQL Server Firewall Rule event.",
      "title": "Ensure that Activity Log Alert exists for Create or Update SQL Server Firewall Rule",
      "types": [],
      "uid": "prowler-azure-monitor_alert_create_update_sqlserver_fr-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Server Firewall Rule (servers/firewallRules). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create/Update server firewall rule (Microsoft.Sql/servers/firewallRules). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for Create or Update SQL Server Firewall Rule events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for deleting Network Security Groups in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_delete_nsg",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting Network Security Groups in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.4"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.4"
        ],
        "CIS-4.0": [
          "7.1.2.4"
        ],
        "MITRE-ATTACK": [
          "T1485",
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.6"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.a",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.3.1",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.2"
        ],
        "CIS-3.0": [
          "6.2.4"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Delete Network Security Group event.",
      "title": "Ensure that Activity Log Alert exists for Delete Network Security Group",
      "types": [],
      "uid": "prowler-azure-monitor_alert_delete_nsg-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Network security groups. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete Network Security Group (Microsoft.Network/networkSecurityGroups). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for 'Delete Network Security Group' events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for deleting policy assignment in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_delete_policy_assignment",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting policy assignment in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/rest/api/monitor/activitylogalerts/createorupdate",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.2"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.Logging.C07.TR01"
        ],
        "CIS-2.1": [
          "5.2.2"
        ],
        "CIS-4.0": [
          "7.1.2.2"
        ],
        "MITRE-ATTACK": [
          "T1485",
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.4"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.b",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.3.1",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.2"
        ],
        "CIS-3.0": [
          "6.2.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Delete Policy Assignment event.",
      "title": "Ensure that Activity Log Alert exists for Delete Policy Assignment",
      "types": [],
      "uid": "prowler-azure-monitor_alert_delete_policy_assignment-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Policy assignment (policyAssignments). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete policy assignment (Microsoft.Authorization/policyAssignments). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log"
      ]
    },
    "risk_details": "Monitoring for delete policy assignment events gives insight into changes done in 'azure policy - assignments' and can reduce the time it takes to detect unsolicited changes.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for deleting public IP address rule in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_delete_public_ip_address_rule",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting public IP address rule in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.10"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.10"
        ],
        "CIS-4.0": [
          "7.1.2.10"
        ],
        "MITRE-ATTACK": [
          "T1485",
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.12"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.a",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.1",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.2"
        ],
        "CIS-3.0": [
          "6.2.10"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Delete Public IP Address rule.",
      "title": "Ensure that Activity Log Alert exists for Delete Public IP Address rule",
      "types": [],
      "uid": "prowler-azure-monitor_alert_delete_public_ip_address_rule-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Public IP addresses. 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete Public Ip Address (Microsoft.Network/publicIPAddresses). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for Delete Public IP Address events gives insight into network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for deleting Security Solution in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_delete_security_solution",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting Security Solution in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.6"
        ],
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.2.6"
        ],
        "CIS-4.0": [
          "7.1.2.6"
        ],
        "MITRE-ATTACK": [
          "T1485",
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.8"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.5.16",
          "A.5.22",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.2"
        ],
        "CIS-3.0": [
          "6.2.6"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the Delete Security Solution event.",
      "title": "Ensure that Activity Log Alert exists for Delete Security Solution",
      "types": [],
      "uid": "prowler-azure-monitor_alert_delete_security_solution-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Security Solutions (securitySolutions). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete Security Solutions (Microsoft.Security/securitySolutions). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.curitySolutions). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Create or Update Security Solutions (Microsoft.Security/securitySolutions). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for Delete Security Solution events gives insight into changes to the active security solutions and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is not an alert for deleting SQL Server firewall rule in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_delete_sqlserver_fr",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is not an alert for deleting SQL Server firewall rule in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-in/azure/azure-monitor/platform/alerts-activity-log",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, no monitoring alerts are created.",
      "compliance": {
        "SOC2": [
          "cc_2_1",
          "cc_5_2",
          "cc_7_3",
          "cc_7_4",
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.2.8"
        ],
        "CCC": [
          "CCC.Logging.C07.TR01"
        ],
        "CIS-2.1": [
          "5.2.8"
        ],
        "CIS-4.0": [
          "7.1.2.8"
        ],
        "MITRE-ATTACK": [
          "T1485",
          "T1496"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.10"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.f",
          "3.2.4",
          "3.4.1",
          "3.5.4",
          "4.3.2.c",
          "6.4.1",
          "7.2.b",
          "11.3.1",
          "11.5.2.d"
        ],
        "ISO27001-2022": [
          "A.5.7",
          "A.8.16"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.2"
        ],
        "CIS-3.0": [
          "6.2.8"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Create an activity log alert for the 'Delete SQL Server Firewall Rule.'",
      "title": "Ensure that Activity Log Alert exists for Delete SQL Server Firewall Rule",
      "types": [],
      "uid": "prowler-azure-monitor_alert_delete_sqlserver_fr-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Navigate to the Monitor blade. 2. Select Alerts. 3. Select Create. 4. Select Alert rule. 5. Under Filter by subscription, choose a subscription. 6. Under Filter by resource type, select Server Firewall Rule (servers/firewallRules). 7. Under Filter by location, select All. 8. From the results, select the subscription. 9. Select Done. 10. Select the Condition tab. 11. Under Signal name, click Delete server firewall rule (Microsoft.Sql/servers/firewallRules). 12. Select the Actions tab. 13. To use an existing action group, click Select action groups. To create a new action group, click Create action group. Fill out the appropriate details for the selection. 14. Select the Details tab. 15. Select a Resource group, provide an Alert rule name and an optional Alert rule description. 16. Click Review + create. 17. Click Create.",
      "references": [
        "https://azure.microsoft.com/en-us/updates/classic-alerting-monitoring-retirement"
      ]
    },
    "risk_details": "Monitoring for Delete SQL Server Firewall Rule events gives insight into SQL network access changes and may reduce the time it takes to detect suspicious activity.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There is no activity log alert for Service Health in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_alert_service_health_exists",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There is no activity log alert for Service Health in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/service-health/overview",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, in your Azure subscription there will not be any activity log alerts configured for Service Health events.",
      "compliance": {
        "CCC": [
          "CCC.AuditLog.C03.TR02",
          "CCC.GenAI.C05.TR01",
          "CCC.KeyMgmt.C01.TR01",
          "CCC.LB.C06.TR01",
          "CCC.Logging.C07.TR01",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-4.0": [
          "7.1.2.11"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that an Azure activity log alert is configured to trigger when Service Health events occur within your Microsoft Azure cloud account. The alert should activate when new events match the specified conditions in the alert rule configuration.",
      "title": "Ensure that an Activity Log Alert exists for Service Health",
      "types": [],
      "uid": "prowler-azure-monitor_alert_service_health_exists-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Create an activity log alert for Service Health events and configure an action group to notify appropriate personnel.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal"
      ]
    },
    "risk_details": "Lack of monitoring for Service Health events may result in missing critical service issues, planned maintenance, security advisories, or other changes that could impact Azure services and regions in use.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "There are no diagnostic settings capturing appropiate categories in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_diagnostic_setting_with_appropriate_categories",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "There are no diagnostic settings capturing appropiate categories in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/diagnostic-settings",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "When the diagnostic setting is created using Azure Portal, by default no categories are selected.",
      "compliance": {
        "SOC2": [
          "cc_8_1"
        ],
        "PCI-4.0": [
          "10.2.1.1.7",
          "10.2.1.1.15",
          "10.2.1.2.7",
          "10.2.1.3.7",
          "10.2.1.4.7",
          "10.2.1.5.7",
          "10.2.1.6.7",
          "10.2.1.7.7",
          "10.2.1.7",
          "10.2.2.7",
          "10.3.1.7",
          "10.3.2.2",
          "10.3.3.4",
          "10.3.4.3",
          "10.4.1.1.3",
          "10.4.1.1.4",
          "10.4.1.3",
          "10.4.2.4",
          "10.5.1.3",
          "10.6.3.7",
          "10.6.3.15",
          "10.7.1.5",
          "10.7.2.5",
          "11.5.2.4",
          "11.6.1.4",
          "12.10.5.4",
          "5.3.4.7",
          "5.3.4.8",
          "A1.2.1.7",
          "A1.2.1.8",
          "A3.3.1.6",
          "A3.3.1.7",
          "A3.5.1.6",
          "A3.5.1.7"
        ],
        "CIS-2.0": [
          "5.1.2"
        ],
        "CCC": [
          "CCC.AuditLog.C02.TR01",
          "CCC.AuditLog.C03.TR02",
          "CCC.AuditLog.C04.TR01",
          "CCC.AuditLog.C05.TR01",
          "CCC.GenAI.C05.TR01",
          "CCC.LB.C01.TR02",
          "CCC.LB.C06.TR01",
          "CCC.Logging.C01.TR01",
          "CCC.Logging.C01.TR02",
          "CCC.ObjStor.C06.TR01",
          "CCC.MLDE.CN02.AR02",
          "CCC.Core.CN09.AR02",
          "CCC.Core.CN09.AR03",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN04.AR02",
          "CCC.Core.CN04.AR03",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.1.2"
        ],
        "CIS-4.0": [
          "7.1.1.2"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.2"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.c",
          "3.2.3.f",
          "3.4.1"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.22"
        ],
        "ENS-RD2022": [
          "op.exp.8.az.md.1",
          "op.mon.2.az.md.1"
        ],
        "CIS-3.0": [
          "6.1.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Prerequisite: A Diagnostic Setting must exist. If a Diagnostic Setting does not exist, the navigation and options within this recommendation will not be available. Please review the recommendation at the beginning of this subsection titled: 'Ensure that a 'Diagnostic Setting' exists.' The diagnostic setting should be configured to log the appropriate activities from the control/management plane.",
      "title": "Ensure Diagnostic Setting captures appropriate categories",
      "types": [],
      "uid": "prowler-azure-monitor_diagnostic_setting_with_appropriate_categories-3bb71587-4549-4396-8898-9e15f062e665-global-Monitor"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Monitor",
        "type": "Monitor",
        "uid": "Monitor"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. Go to Azure Monitor 2. Click Activity log 3. Click on Export Activity Logs 4. Select the Subscription from the drop down menu 5. Click on Add diagnostic setting 6. Enter a name for your new Diagnostic Setting 7. Check the following categories: Administrative, Alert, Policy, and Security 8. Choose the destination details according to your organization's needs.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/common/manage-storage-analytics-logs?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json&bc=%2Fazure%2Fstorage%2Fblobs%2Fbreadcrumb%2Ftoc.json&tabs=azure-portal"
      ]
    },
    "risk_details": "A diagnostic setting controls how the diagnostic log is exported. Capturing the diagnostic setting categories for appropriate control/management plane activities allows proper alerting.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "No diagnostic settings found in subscription Azure subscription 1.",
    "metadata": {
      "event_code": "monitor_diagnostic_settings_exists",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "No diagnostic settings found in subscription Azure subscription 1.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/cli/azure/monitor/diagnostic-settings?view=azure-cli-latest",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "By default, diagnostic setting is not set.",
      "compliance": {
        "SOC2": [
          "cc_8_1"
        ],
        "CIS-2.0": [
          "5.1.1"
        ],
        "CCC": [
          "CCC.AuditLog.C02.TR01",
          "CCC.AuditLog.C03.TR01",
          "CCC.AuditLog.C03.TR02",
          "CCC.AuditLog.C04.TR01",
          "CCC.AuditLog.C05.TR01",
          "CCC.AuditLog.C06.TR01",
          "CCC.AuditLog.C08.TR01",
          "CCC.AuditLog.C09.TR01",
          "CCC.GenAI.C05.TR01",
          "CCC.KeyMgmt.C01.TR01",
          "CCC.LB.C01.TR02",
          "CCC.LB.C06.TR01",
          "CCC.LB.C04.TR01",
          "CCC.Logging.C01.TR01",
          "CCC.Logging.C01.TR02",
          "CCC.AuditLog.C04.TR01",
          "CCC.Logging.C05.TR01",
          "CCC.Logging.C05.TR02",
          "CCC.Logging.C07.TR01",
          "CCC.ObjStor.C06.TR01",
          "CCC.MLDE.CN02.AR02",
          "CCC.Monitor.CN01.AR01",
          "CCC.Core.CN09.AR01",
          "CCC.Core.CN09.AR02",
          "CCC.Core.CN09.AR03",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN04.AR02",
          "CCC.Core.CN04.AR03",
          "CCC.Core.CN07.AR02"
        ],
        "CIS-2.1": [
          "5.1.1"
        ],
        "CIS-4.0": [
          "7.1.1.1"
        ],
        "ProwlerThreatScore-1.0": [
          "3.2.3"
        ],
        "NIS2": [
          "2.2.3",
          "3.2.1",
          "3.2.2",
          "3.2.3.b",
          "3.2.3.c",
          "3.2.3.f",
          "3.2.3.h",
          "3.4.1"
        ],
        "ISO27001-2022": [
          "A.5.16",
          "A.5.22"
        ],
        "ENS-RD2022": [
          "op.exp.8.r5.az.ds.1",
          "op.mon.2.r2.az.ma.1"
        ],
        "CIS-3.0": [
          "6.1.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Enable Diagnostic settings for exporting activity logs. Diagnostic settings are available for each individual resource within a subscription. Settings should be configured for all appropriate resources for your environment.",
      "title": "Ensure that a 'Diagnostic Setting' exists for Subscription Activity Logs ",
      "types": [],
      "uid": "prowler-azure-monitor_diagnostic_settings_exists-3bb71587-4549-4396-8898-9e15f062e665-global-Diagnostic Settings"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "monitor"
        },
        "labels": [],
        "name": "Diagnostic Settings",
        "type": "Monitor",
        "uid": "diagnostic_settings"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "To enable Diagnostic Settings on a Subscription: 1. Go to Monitor 2. Click on Activity Log 3. Click on Export Activity Logs 4. Click + Add diagnostic setting 5. Enter a Diagnostic setting name 6. Select Categories for the diagnostic settings 7. Select the appropriate Destination details (this may be Log Analytics, Storage Account, Event Hub, or Partner solution) 8. Click Save To enable Diagnostic Settings on a specific resource: 1. Go to Monitor 2. Click Diagnostic settings 3. Click on the resource that has a diagnostics status of disabled 4. Select Add Diagnostic Setting 5. Enter a Diagnostic setting name 6. Select the appropriate log, metric, and destination. (this may be Log Analytics, Storage Account, Event Hub, or Partner solution) 7. Click save Repeat these step for all resources as needed.",
      "references": [
        "https://docs.microsoft.com/en-us/azure/monitoring-and-diagnostics/monitoring-overview-activity-logs#export-the-activity-log-with-a-log-profile"
      ]
    },
    "risk_details": "A diagnostic setting controls how a diagnostic log is exported. By default, logs are retained only for 90 days. Diagnostic settings should be defined so that logs can be exported and stored for a longer duration in order to analyze security activities within an Azure subscription.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Bastion Host from subscription Azure subscription 1 does not exist",
    "metadata": {
      "event_code": "network_bastion_host_exists",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Bastion Host from subscription Azure subscription 1 does not exist",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/bastion/bastion-overview#sku",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "The Azure Bastion service incurs additional costs and requires a specific virtual network configuration. The Standard tier offers additional configuration options compared to the Basic tier and may incur additional costs for those added features.",
      "compliance": {
        "CIS-2.0": [
          "7.1"
        ],
        "CIS-2.1": [
          "7.1"
        ],
        "CIS-4.0": [
          "9.4.1"
        ],
        "ProwlerThreatScore-1.0": [
          "2.1.5"
        ],
        "NIS2": [
          "2.3.1",
          "6.7.2.b",
          "6.7.2.l",
          "11.1.1"
        ],
        "ISO27001-2022": [
          "A.8.14",
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "mp.com.4.r4.az.nt.1"
        ],
        "CIS-3.0": [
          "8.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "The Azure Bastion service allows secure remote access to Azure Virtual Machines over the Internet without exposing remote access protocol ports and services directly to the Internet. The Azure Bastion service provides this access using TLS over 443/TCP, and subscribes to hardened configurations within an organization's Azure Active Directory service.",
      "title": "Ensure an Azure Bastion Host Exists",
      "types": [],
      "uid": "prowler-azure-network_bastion_host_exists-3bb71587-4549-4396-8898-9e15f062e665-global-Bastion Host"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "Bastion Host",
        "type": "Network",
        "uid": "Bastion Host"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "From Azure Portal* 1. Click on Bastions 2. Select the Subscription 3. Select the Resource group 4. Type a Name for the new Bastion host 5. Select a Region 6. Choose Standard next to Tier 7. Use the slider to set the Instance count 8. Select the Virtual network or Create new 9. Select the Subnet named AzureBastionSubnet. Create a Subnet named AzureBastionSubnet using a /26 CIDR range if it doesn't already exist. 10. Selct the appropriate Public IP address option. 11. If Create new is selected for the Public IP address option, provide a Public IP address name. 12. If Use existing is selected for Public IP address option, select an IP address from Choose public IP address 13. Click Next: Tags > 14. Configure the appropriate Tags 15. Click Next: Advanced > 16. Select the appropriate Advanced options 17. Click Next: Review + create > 18. Click Create From Azure CLI az network bastion create --location <location> --name <name of bastion host> --public-ip-address <public IP address name or ID> --resource-group <resource group name or ID> --vnet-name <virtual network containing subnet called 'AzureBastionSubnet'> --scale-units <integer> --sku Standard [--disable-copy- paste true|false] [--enable-ip-connect true|false] [--enable-tunneling true|false] From PowerShell Create the appropriate Virtual network settings and Public IP Address settings. $subnetName = 'AzureBastionSubnet' $subnet = New-AzVirtualNetworkSubnetConfig -Name $subnetName -AddressPrefix <IP address range in CIDR notation making sure to use a /26> $virtualNet = New-AzVirtualNetwork -Name <virtual network name> - ResourceGroupName <resource group name> -Location <location> -AddressPrefix <IP address range in CIDR notation> -Subnet $subnet $publicip = New-AzPublicIpAddress -ResourceGroupName <resource group name> - Name <public IP address name> -Location <location> -AllocationMethod Dynamic -Sku Standard",
      "references": [
        "https://learn.microsoft.com/en-us/powershell/module/az.network/get-azbastion?view=azps-9.2.0"
      ]
    },
    "risk_details": "The Azure Bastion service allows organizations a more secure means of accessing Azure Virtual Machines over the Internet without assigning public IP addresses to those Virtual Machines. The Azure Bastion service provides Remote Desktop Protocol (RDP) and Secure Shell (SSH) access to Virtual Machines using TLS within a web browser, thus preventing organizations from opening up 3389/TCP and 22/TCP to the Internet on Azure Virtual Machines. Additional benefits of the Bastion service includes Multi-Factor Authentication, Conditional Access Policies, and any other hardening measures configured within Azure Active Directory using a central point of access.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Network Watcher NetworkWatcher_westus2 from subscription Azure subscription 1 has no flow logs",
    "metadata": {
      "event_code": "network_flow_log_captured_sent",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_westus2 from subscription Azure subscription 1 has no flow logs",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/mcsb-logging-threat-detection#lt-4-enable-network-logging-for-security-investigation",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "The impact of configuring NSG Flow logs is primarily one of cost and configuration. If deployed, it will create storage accounts that hold minimal amounts of data on a 5-day lifecycle before feeding to Log Analytics Workspace. This will increase the amount of data stored and used by Azure Monitor.",
      "compliance": {
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.0": [
          "5.1.6"
        ],
        "CCC": [
          "CCC.LB.C01.TR02",
          "CCC.LB.C06.TR01",
          "CCC.Logging.C01.TR01",
          "CCC.Logging.C01.TR02",
          "CCC.VPC.CN04.AR01",
          "CCC.Core.CN09.AR01",
          "CCC.Core.CN09.AR03",
          "CCC.Core.CN04.AR01",
          "CCC.Core.CN04.AR02",
          "CCC.Core.CN04.AR03"
        ],
        "CIS-2.1": [
          "5.1.5"
        ],
        "CIS-4.0": [
          "7.1.1.5"
        ],
        "MITRE-ATTACK": [
          "T1048",
          "T1499"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.8"
        ],
        "NIS2": [
          "2.1.2.h",
          "2.3.1",
          "3.2.3.a",
          "3.2.3.d",
          "3.2.3.g",
          "6.7.2.b",
          "6.7.2.l",
          "11.1.1",
          "11.2.2.f"
        ],
        "ISO27001-2022": [
          "A.8.14",
          "A.8.15",
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "op.mon.1.r1.az.nf.1",
          "op.mon.3.az.nw.1",
          "mp.s.4.r1.az.nt.1"
        ],
        "CIS-3.0": [
          "6.1.5"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
      "title": "Ensure that network flow logs are captured and fed into a central log analytics workspace.",
      "types": [],
      "uid": "prowler-azure-network_flow_log_captured_sent-3bb71587-4549-4396-8898-9e15f062e665-westus2-NetworkWatcher_westus2"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "westus2",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westus2",
            "name": "NetworkWatcher_westus2",
            "location": "westus2",
            "flow_logs": []
          }
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "NetworkWatcher_westus2",
        "type": "Network",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westus2"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "westus2"
    },
    "remediation": {
      "desc": "1. Navigate to Network Watcher. 2. Select NSG flow logs. 3. Select + Create. 4. Select the desired Subscription. 5. Select + Select NSG. 6. Select a network security group. 7. Click Confirm selection. 8. Select or create a new Storage Account. 9. Input the retention in days to retain the log. 10. Click Next. 11. Under Configuration, select Version 2. 12. If rich analytics are required, select Enable Traffic Analytics, a processing interval, and a Log Analytics Workspace. 13. Select Next. 14. Optionally add Tags. 15. Select Review + create. 16. Select Create. Warning The remediation policy creates remediation deployment and names them by concatenating the subscription name and the resource group name. The MAXIMUM permitted length of a deployment name is 64 characters. Exceeding this will cause the remediation task to fail.",
      "references": [
        "https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-portal"
      ]
    },
    "risk_details": "Network Flow Logs provide valuable insight into the flow of traffic around your network and feed into both Azure Monitor and Azure Sentinel (if in use), permitting the generation of visual flow diagrams to aid with analyzing for lateral movement, etc.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Network Watcher NetworkWatcher_westus2 from subscription Azure subscription 1 has no flow logs",
    "metadata": {
      "event_code": "network_flow_log_more_than_90_days",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher NetworkWatcher_westus2 from subscription Azure subscription 1 has no flow logs",
    "status_id": 1,
    "unmapped": {
      "related_url": " https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-nsg-flow-logging-overview",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "This will keep IP traffic logs for longer than 90 days. As a level 2, first determine your need to retain data, then apply your selection here. As this is data stored for longer, your monthly storage costs will increase depending on your data use.",
      "compliance": {
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1",
          "cc_c_1_2"
        ],
        "PCI-4.0": [
          "10.2.1.1.34",
          "10.2.1.2.29",
          "10.2.1.3.29",
          "10.2.1.4.29",
          "10.2.1.5.29",
          "10.2.1.6.29",
          "10.2.1.7.29",
          "10.2.1.29",
          "10.2.2.29",
          "10.3.1.29",
          "10.6.3.39",
          "5.3.4.34",
          "A1.2.1.34"
        ],
        "CIS-2.0": [
          "6.5"
        ],
        "CCC": [
          "CCC.Logging.C02.TR01",
          "CCC.Logging.C02.TR02",
          "CCC.VPC.CN04.AR01"
        ],
        "CIS-2.1": [
          "6.5"
        ],
        "CIS-4.0": [
          "8.8",
          "8.5"
        ],
        "MITRE-ATTACK": [
          "T1499"
        ],
        "ProwlerThreatScore-1.0": [
          "3.2.1"
        ],
        "NIS2": [
          "1.1.1.c",
          "2.1.2.h",
          "2.3.1",
          "3.2.3.a",
          "3.2.3.g",
          "3.2.5",
          "4.1.2.g",
          "4.1.4",
          "4.2.2.f",
          "6.1.2.b",
          "6.7.2.b",
          "6.7.2.l",
          "11.1.1",
          "11.2.2.f",
          "12.2.2.a"
        ],
        "ISO27001-2022": [
          "A.8.15",
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "op.exp.8.r3.az.nt.1",
          "op.mon.3.az.nw.1"
        ],
        "CIS-3.0": [
          "7.5"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Network Security Group Flow Logs should be enabled and the retention period set to greater than or equal to 90 days.",
      "title": "Ensure that Network Security Group Flow Log retention period is 0, 90 days or greater",
      "types": [],
      "uid": "prowler-azure-network_flow_log_more_than_90_days-3bb71587-4549-4396-8898-9e15f062e665-westus2-NetworkWatcher_westus2"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "westus2",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westus2",
            "name": "NetworkWatcher_westus2",
            "location": "westus2",
            "flow_logs": []
          }
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "NetworkWatcher_westus2",
        "type": "Network",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_westus2"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "westus2"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Go to Network Watcher 2. Select NSG flow logs blade in the Logs section 3. Select each Network Security Group from the list 4. Ensure Status is set to On 5. Ensure Retention (days) setting greater than 90 days 6. Select your storage account in the Storage account field 7. Select Save From Azure CLI Enable the NSG flow logs and set the Retention (days) to greater than or equal to 90 days. az network watcher flow-log configure --nsg <NameorID of the Network Security Group> --enabled true --resource-group <resourceGroupName> --retention 91 --storage-account <NameorID of the storage account to save flow logs>",
      "references": [
        "https://docs.microsoft.com/en-us/cli/azure/network/watcher/flow-log?view=azure-cli-latest"
      ]
    },
    "risk_details": "Flow logs enable capturing information about IP traffic flowing in and out of network security groups. Logs can be used to check for anomalies and give insight into suspected breaches.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Security Group nsg-lee8 from subscription Azure subscription 1 has HTTP internet access restricted.",
    "metadata": {
      "event_code": "network_http_internet_access_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Security Group nsg-lee8 from subscription Azure subscription 1 has HTTP internet access restricted.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_6"
        ],
        "PCI-4.0": [
          "1.2.5.5",
          "1.2.8.25",
          "1.3.1.28",
          "1.3.2.28",
          "1.4.1.6",
          "1.4.2.26",
          "1.4.4.6",
          "1.5.1.25",
          "2.2.5.5",
          "2.2.7.3",
          "4.2.1.1.7",
          "4.2.1.3",
          "8.3.2.6",
          "A1.1.3.25"
        ],
        "CIS-2.0": [
          "6.4"
        ],
        "CCC": [
          "CCC.Build.C03.TR01",
          "CCC.MLDE.CN07.AR01",
          "CCC.MLDE.CN07.AR02",
          "CCC.MLDE.CN08.AR01",
          "CCC.MLDE.CN08.AR02",
          "CCC.VPC.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN06.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-2.1": [
          "6.4"
        ],
        "CIS-4.0": [
          "8.4"
        ],
        "MITRE-ATTACK": [
          "T1199",
          "T1048",
          "T1499",
          "T1498",
          "T1046"
        ],
        "ProwlerThreatScore-1.0": [
          "2.1.4"
        ],
        "NIS2": [
          "1.1.1.c",
          "1.2.1",
          "2.3.1",
          "6.7.2.b",
          "6.7.2.l",
          "11.1.1"
        ],
        "ISO27001-2022": [
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "mp.com.3.r2.az.tls.1",
          "mp.com.4.r3.az.1",
          "mp.com.4.r4.az.nt.1",
          "mp.s.4.az.nt.1"
        ],
        "CIS-3.0": [
          "7.4"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required and narrowly configured.",
      "title": "Ensure that HTTP(S) access from the Internet is evaluated and restricted",
      "types": [],
      "uid": "prowler-azure-network_http_internet_access_restricted-3bb71587-4549-4396-8898-9e15f062e665-westus2-nsg-lee8"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "westus2",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8",
            "name": "nsg-lee8",
            "location": "westus2",
            "security_rules": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8/securityRules/nsgr-lee8",
                "name": "nsgr-lee8",
                "destination_port_range": "*",
                "protocol": "*",
                "source_address_prefix": "192.168.0.0/24",
                "access": "Deny",
                "direction": "Outbound"
              }
            ]
          }
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "nsg-lee8",
        "type": "Network",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "westus2"
    },
    "remediation": {
      "desc": "Where HTTP(S) is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
      "references": []
    },
    "risk_details": "The potential security problem with using HTTP(S) over the Internet is that attackers can use various brute force techniques to gain access to Azure resources. Once the attackers gain access, they can use the resource as a launch point for compromising other resources within the Azure tenant.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Security Group nsg-lee8 from subscription Azure subscription 1 has RDP internet access restricted.",
    "metadata": {
      "event_code": "network_rdp_internet_access_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Security Group nsg-lee8 from subscription Azure subscription 1 has RDP internet access restricted.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/security/azure-security-network-security-best-practices#disable-rdpssh-access-to-azure-virtual-machines",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_6"
        ],
        "CIS-2.0": [
          "6.1"
        ],
        "CCC": [
          "CCC.Build.C03.TR01",
          "CCC.MLDE.CN07.AR01",
          "CCC.MLDE.CN07.AR02",
          "CCC.MLDE.CN08.AR01",
          "CCC.MLDE.CN08.AR02",
          "CCC.VPC.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN06.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-2.1": [
          "6.1"
        ],
        "CIS-4.0": [
          "8.1"
        ],
        "MITRE-ATTACK": [
          "T1199",
          "T1048",
          "T1499",
          "T1498",
          "T1046"
        ],
        "ProwlerThreatScore-1.0": [
          "2.1.1"
        ],
        "NIS2": [
          "2.3.1",
          "6.7.2.b",
          "6.7.2.l",
          "11.1.1"
        ],
        "ISO27001-2022": [
          "A.8.14",
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "mp.com.1.az.nw.1"
        ],
        "CIS-3.0": [
          "7.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
      "title": "Ensure that RDP access from the Internet is evaluated and restricted",
      "types": [],
      "uid": "prowler-azure-network_rdp_internet_access_restricted-3bb71587-4549-4396-8898-9e15f062e665-westus2-nsg-lee8"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "westus2",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8",
            "name": "nsg-lee8",
            "location": "westus2",
            "security_rules": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8/securityRules/nsgr-lee8",
                "name": "nsgr-lee8",
                "destination_port_range": "*",
                "protocol": "*",
                "source_address_prefix": "192.168.0.0/24",
                "access": "Deny",
                "direction": "Outbound"
              }
            ]
          }
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "nsg-lee8",
        "type": "Network",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "westus2"
    },
    "remediation": {
      "desc": "Where RDP is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
      "references": [
        "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries"
      ]
    },
    "risk_details": "The potential security problem with using RDP over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on an Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Security Group nsg-lee8 from subscription Azure subscription 1 has SSH internet access restricted.",
    "metadata": {
      "event_code": "network_ssh_internet_access_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Security Group nsg-lee8 from subscription Azure subscription 1 has SSH internet access restricted.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/security/azure-security-network-security-best-practices#disable-rdpssh-access-to-azure-virtual-machines",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_6"
        ],
        "PCI-4.0": [
          "1.2.5.17",
          "1.2.8.17",
          "1.2.8.18",
          "1.2.8.21",
          "1.2.8.41",
          "1.3.1.19",
          "1.3.1.21",
          "1.3.1.24",
          "1.3.1.45",
          "1.3.2.19",
          "1.3.2.21",
          "1.3.2.24",
          "1.3.2.45",
          "1.4.1.5",
          "1.4.2.18",
          "1.4.2.19",
          "1.4.2.22",
          "1.4.2.43",
          "1.4.4.5",
          "1.5.1.17",
          "1.5.1.18",
          "1.5.1.21",
          "1.5.1.40",
          "2.2.5.17",
          "A1.1.3.17",
          "A1.1.3.18",
          "A1.1.3.21",
          "A1.1.3.40"
        ],
        "CIS-2.0": [
          "6.2"
        ],
        "CCC": [
          "CCC.Build.C03.TR01",
          "CCC.MLDE.CN07.AR01",
          "CCC.MLDE.CN07.AR02",
          "CCC.MLDE.CN08.AR01",
          "CCC.MLDE.CN08.AR02",
          "CCC.VPC.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN01.AR02",
          "CCC.Core.CN06.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-2.1": [
          "6.2"
        ],
        "CIS-4.0": [
          "8.2"
        ],
        "MITRE-ATTACK": [
          "T1199",
          "T1048",
          "T1499",
          "T1498",
          "T1046"
        ],
        "ProwlerThreatScore-1.0": [
          "2.1.2"
        ],
        "NIS2": [
          "2.3.1",
          "6.7.2.b",
          "6.7.2.l",
          "11.1.1"
        ],
        "ISO27001-2022": [
          "A.8.14",
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "mp.com.1.az.nw.2"
        ],
        "CIS-3.0": [
          "7.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
      "title": "Ensure that SSH access from the Internet is evaluated and restricted",
      "types": [],
      "uid": "prowler-azure-network_ssh_internet_access_restricted-3bb71587-4549-4396-8898-9e15f062e665-westus2-nsg-lee8"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "westus2",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8",
            "name": "nsg-lee8",
            "location": "westus2",
            "security_rules": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8/securityRules/nsgr-lee8",
                "name": "nsgr-lee8",
                "destination_port_range": "*",
                "protocol": "*",
                "source_address_prefix": "192.168.0.0/24",
                "access": "Deny",
                "direction": "Outbound"
              }
            ]
          }
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "nsg-lee8",
        "type": "Network",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "westus2"
    },
    "remediation": {
      "desc": "Where SSH is not explicitly required and narrowly configured for resources attached to the Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRoute Site-to-site VPN Point-to-site VPN",
      "references": [
        "https://docs.microsoft.com/en-us/security/benchmark/azure/security-controls-v3-network-security#ns-1-establish-network-segmentation-boundaries"
      ]
    },
    "risk_details": "The potential security problem with using SSH over the Internet is that attackers can use various brute force techniques to gain access to Azure Virtual Machines. Once the attackers gain access, they can use a virtual machine as a launch point for compromising other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Security Group nsg-lee8 from subscription Azure subscription 1 has UDP internet access restricted.",
    "metadata": {
      "event_code": "network_udp_internet_access_restricted",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Security Group nsg-lee8 from subscription Azure subscription 1 has UDP internet access restricted.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/security/fundamentals/network-best-practices#secure-your-critical-azure-service-resources-to-only-your-virtual-networks",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_6"
        ],
        "CIS-2.0": [
          "6.3"
        ],
        "CCC": [
          "CCC.Build.C03.TR01",
          "CCC.MLDE.CN07.AR01",
          "CCC.MLDE.CN07.AR02",
          "CCC.MLDE.CN08.AR01",
          "CCC.MLDE.CN08.AR02",
          "CCC.VPC.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN06.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-2.1": [
          "6.3"
        ],
        "CIS-4.0": [
          "8.3"
        ],
        "MITRE-ATTACK": [
          "T1199",
          "T1048",
          "T1499",
          "T1498",
          "T1046"
        ],
        "ProwlerThreatScore-1.0": [
          "2.1.3"
        ],
        "NIS2": [
          "2.3.1",
          "6.7.2.b",
          "6.7.2.l",
          "11.1.1"
        ],
        "ISO27001-2022": [
          "A.8.14",
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "mp.com.1.az.nw.3"
        ],
        "CIS-3.0": [
          "7.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Network security groups should be periodically evaluated for port misconfigurations. Where certain ports and protocols may be exposed to the Internet, they should be evaluated for necessity and restricted wherever they are not explicitly required.",
      "title": "Ensure that UDP access from the Internet is evaluated and restricted",
      "types": [],
      "uid": "prowler-azure-network_udp_internet_access_restricted-3bb71587-4549-4396-8898-9e15f062e665-westus2-nsg-lee8"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "westus2",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8",
            "name": "nsg-lee8",
            "location": "westus2",
            "security_rules": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8/securityRules/nsgr-lee8",
                "name": "nsgr-lee8",
                "destination_port_range": "*",
                "protocol": "*",
                "source_address_prefix": "192.168.0.0/24",
                "access": "Deny",
                "direction": "Outbound"
              }
            ]
          }
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "nsg-lee8",
        "type": "Network",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-lee8/providers/Microsoft.Network/networkSecurityGroups/nsg-lee8"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "westus2"
    },
    "remediation": {
      "desc": "Where UDP is not explicitly required and narrowly configured for resources attached tothe Network Security Group, Internet-level access to your Azure resources should be restricted or eliminated. For internal access to relevant resources, configure an encrypted network tunnel such as: ExpressRouteSite-to-site VPN Point-to-site VPN",
      "references": [
        "https://docs.microsoft.com/en-us/azure/security/fundamentals/ddos-best-practices"
      ]
    },
    "risk_details": "The potential security problem with broadly exposing UDP services over the Internet is that attackers can use DDoS amplification techniques to reflect spoofed UDP traffic from Azure Virtual Machines. The most common types of these attacks use exposed DNS, NTP, SSDP, SNMP, CLDAP and other UDP-based services as amplification sources for disrupting services of other machines on the Azure Virtual Network or even attack networked devices outside of Azure.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Network Watcher is not enabled for the following locations in subscription 'Azure subscription 1': norwayeast, francecentral, southindia, newzealandnorth, koreasouth, koreacentral, canadacentral, southafricawest, mexicocentral, australiacentral, centralindia, chilecentral, southeastasia, eastasia, norwaywest, jioindiacentral, westcentralus, westindia, swedencentral, switzerlandwest, switzerlandnorth, israelcentral, southafricanorth, uksouth, canadaeast, westus, germanywestcentral, polandcentral, spaincentral, australiacentral2, brazilsouth, francesouth, qatarcentral, uaecentral, malaysiawest, uaenorth, westus3, northcentralus, japanwest, jioindiawest, eastus, brazilsoutheast, ukwest, japaneast, austriaeast, italynorth, indonesiacentral, australiaeast, westeurope, northeurope, germanynorth, eastus2, centralus, southcentralus, australiasoutheast.",
    "metadata": {
      "event_code": "network_watcher_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Network Watcher is not enabled for the following locations in subscription 'Azure subscription 1': norwayeast, francecentral, southindia, newzealandnorth, koreasouth, koreacentral, canadacentral, southafricawest, mexicocentral, australiacentral, centralindia, chilecentral, southeastasia, eastasia, norwaywest, jioindiacentral, westcentralus, westindia, swedencentral, switzerlandwest, switzerlandnorth, israelcentral, southafricanorth, uksouth, canadaeast, westus, germanywestcentral, polandcentral, spaincentral, australiacentral2, brazilsouth, francesouth, qatarcentral, uaecentral, malaysiawest, uaenorth, westus3, northcentralus, japanwest, jioindiawest, eastus, brazilsoutheast, ukwest, japaneast, austriaeast, italynorth, indonesiacentral, australiaeast, westeurope, northeurope, germanynorth, eastus2, centralus, southcentralus, australiasoutheast.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/network-watcher/network-watcher-monitoring-overview",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "There are additional costs per transaction to run and store network data. For high-volume networks these charges will add up quickly.",
      "compliance": {
        "CIS-2.0": [
          "6.6"
        ],
        "CCC": [
          "CCC.LB.C01.TR02",
          "CCC.LB.C06.TR01",
          "CCC.VPC.CN04.AR01",
          "CCC.Core.CN06.AR01"
        ],
        "CIS-2.1": [
          "6.6"
        ],
        "CIS-4.0": [
          "8.6"
        ],
        "MITRE-ATTACK": [
          "T1048",
          "T1499",
          "T1498",
          "T1046",
          "T1049"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.14"
        ],
        "NIS2": [
          "2.3.1",
          "6.7.2.b",
          "6.7.2.l",
          "6.8.2.a",
          "11.1.1"
        ],
        "ISO27001-2022": [
          "A.8.14",
          "A.8.20",
          "A.8.21",
          "A.8.22"
        ],
        "ENS-RD2022": [
          "op.mon.1.az.nw.1",
          "op.mon.2.r2.az.ma.1",
          "op.mon.3.az.nw.1",
          "mp.com.1.az.nw.1",
          "mp.com.1.az.nw.2",
          "mp.com.1.az.nw.3",
          "mp.com.3.az.nw.1"
        ],
        "CIS-3.0": [
          "7.6"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Enable Network Watcher for Azure subscriptions.",
      "title": "Ensure that Network Watcher is 'Enabled' for all locations in the Azure subscription",
      "types": [],
      "uid": "prowler-azure-network_watcher_enabled-3bb71587-4549-4396-8898-9e15f062e665-global-Network Watcher"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {}
        },
        "group": {
          "name": "network"
        },
        "labels": [],
        "name": "Network Watcher",
        "type": "Network",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/NetworkWatcherRG/providers/Microsoft.Network/networkWatchers/NetworkWatcher_*"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Opting out of Network Watcher automatic enablement is a permanent change. Once you opt-out you cannot opt-in without contacting support.",
      "references": [
        "https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v2-logging-threat-detection#lt-3-enable-logging-for-azure-network-activities"
      ]
    },
    "risk_details": "Network diagnostic and visualization tools available with Network Watcher help users understand, diagnose, and gain insights to the network in Azure.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Policy assigment '/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn' is configured with enforcement mode 'Default'.",
    "metadata": {
      "event_code": "policy_ensure_asc_enforcement_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Policy assigment '/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn' is configured with enforcement mode 'Default'.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/defender-for-cloud/security-policy-concept",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "PCI-4.0": [
          "10.2.1.1.31",
          "10.4.1.1.5",
          "10.4.1.4",
          "10.4.2.5",
          "10.6.3.36",
          "10.7.1.6",
          "10.7.2.6",
          "A3.3.1.9",
          "A3.5.1.9"
        ],
        "CIS-2.0": [
          "2.1.14"
        ],
        "CIS-2.1": [
          "2.1.13"
        ],
        "CIS-4.0": [
          "9.1.11"
        ],
        "ProwlerThreatScore-1.0": [
          "3.3.17"
        ],
        "ISO27001-2022": [
          "A.5.1"
        ],
        "CIS-3.0": [
          "3.1.11"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "None of the settings offered by ASC Default policy should be set to effect Disabled.",
      "title": "Ensure Any of the ASC Default Policy Settings are Not Set to 'Disabled'",
      "types": [],
      "uid": "prowler-azure-policy_ensure_asc_enforcement_enabled-3bb71587-4549-4396-8898-9e15f062e665-global-SecurityCenterBuiltIn"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn",
            "name": "SecurityCenterBuiltIn",
            "enforcement_mode": "Default"
          }
        },
        "group": {
          "name": "policy"
        },
        "labels": [],
        "name": "SecurityCenterBuiltIn",
        "type": "Microsoft.Authorization/policyAssignments",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/providers/Microsoft.Authorization/policyAssignments/SecurityCenterBuiltIn"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "1. From Azure Home select the Portal Menu 2. Select Policy 3. Select ASC Default for each subscription 4. Click on 'view Assignment' 5. Click on 'Edit assignment' 6. Ensure Policy Enforcement is Enabled 7. Click 'Review + Save'",
      "references": [
        "https://learn.microsoft.com/en-us/azure/defender-for-cloud/implement-security-recommendations"
      ]
    },
    "risk_details": "A security policy defines the desired configuration of your workloads and helps ensure compliance with company or regulatory security requirements. ASC Default policy is associated with every subscription by default. ASC default policy assignment is a set of security recommendations based on best practices. Enabling recommendations in ASC default policy ensures that Azure security center provides the ability to monitor all of the supported recommendations and optionally allow automated action for a few of the supported recommendations.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has allow public access from any Azure service disabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_allow_access_services_disabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has allow public access from any Azure service disabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/postgresql/concepts-firewall-rules",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CIS-2.0": [
          "4.3.7"
        ],
        "CCC": [
          "CCC.DataWar.C03.TR01"
        ],
        "CIS-2.1": [
          "4.3.7"
        ],
        "ProwlerThreatScore-1.0": [
          "2.2.2"
        ],
        "ISO27001-2022": [
          "A.8.3"
        ],
        "ENS-RD2022": [
          "op.exp.8.r4.az.sa.3"
        ],
        "CIS-3.0": [
          "5.2.5"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Disable access from Azure services to PostgreSQL Database Server.",
      "title": "Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_allow_access_services_disabled-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-rtac"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac",
            "name": "psql-rtac",
            "resource_group": "rg-rtac",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-rtac",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Connection security. 4. Under Firewall rules, set Allow access to Azure services to No. 5. Click Save. From Azure CLI Use the below command to delete the AllowAllWindowsAzureIps rule for PostgreSQL Database. az postgres server firewall-rule delete --name AllowAllWindowsAzureIps -- resource-group <resourceGroupName> --server-name <serverName>",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/quickstart-create-server-database-azure-cli#configure-a-server-based-firewall-rule"
      ]
    },
    "risk_details": "If access from Azure services is enabled, the server's firewall will accept connections from all Azure resources, including resources not in your subscription. This is usually not a desired configuration. Instead, set up firewall rules to allow access from specific network ranges or VNET rules to allow access from specific virtual networks.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has connection_throttling disabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_connection_throttling_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has connection_throttling disabled",
    "status_id": 1,
    "unmapped": {
      "related_url": " https://docs.microsoft.com/en-us/rest/api/postgresql/configurations/listbyserver",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CIS-2.0": [
          "4.3.5"
        ],
        "CIS-2.1": [
          "4.3.5"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.2"
        ],
        "CIS-3.0": [
          "5.2.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Enable connection_throttling on PostgreSQL Servers.",
      "title": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_connection_throttling_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-rtac"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac",
            "name": "psql-rtac",
            "resource_group": "rg-rtac",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-rtac",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for connection_throttling. 5. Click ON and save. From Azure CLI Use the below command to update connection_throttling configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name connection_throttling --value on From PowerShell Use the below command to update connection_throttling configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name connection_throttling -Value on",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling connection_throttling helps the PostgreSQL Database to Set the verbosity of logged messages. This in turn generates query and error logs with respect to concurrent connections that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has enforce ssl enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_enforce_ssl_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has enforce ssl enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-ssl-connection-security",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": ".",
      "compliance": {
        "SOC2": [
          "cc_6_2",
          "cc_6_6"
        ],
        "CIS-2.0": [
          "4.3.1"
        ],
        "CIS-2.1": [
          "4.3.1"
        ],
        "MITRE-ATTACK": [
          "T1040",
          "T1530"
        ],
        "ProwlerThreatScore-1.0": [
          "4.1.1",
          "4.1.2"
        ],
        "CIS-3.0": [
          "5.2.1",
          "5.3.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Enable SSL connection on PostgreSQL Servers.",
      "title": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_enforce_ssl_enabled-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-rtac"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac",
            "name": "psql-rtac",
            "resource_group": "rg-rtac",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-rtac",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com 2. Go to Azure Database for PostgreSQL server 3. For each database, click on Connection security 4. In SSL settings, click on ENABLED to enforce SSL connections 5. Click Save From Azure CLI Use the below command to enforce ssl connection for PostgreSQL Database. az postgres server update --resource-group <resourceGroupName> --name <serverName> --ssl-enforcement Enabled From PowerShell Update-AzPostgreSqlServer -ResourceGroupName <ResourceGroupName > -ServerName <ServerName> -SslEnforcement Enabled",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-ssl-connection-security"
      ]
    },
    "risk_details": "SSL connectivity helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_checkpoints enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_checkpoints_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_checkpoints enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": " https://docs.microsoft.com/en-us/rest/api/postgresql/singleserver/configurations/list-by-server",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.0": [
          "4.3.2"
        ],
        "CIS-2.1": [
          "4.3.2"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.1"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.g",
          "11.2.2.f"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.3"
        ],
        "CIS-3.0": [
          "5.2.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Enable log_checkpoints on PostgreSQL Servers.",
      "title": "Ensure Server Parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_checkpoints_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-rtac"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac",
            "name": "psql-rtac",
            "resource_group": "rg-rtac",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-rtac",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. From Azure Home select the Portal Menu. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for log_checkpoints. 5. Click ON and save. From Azure CLI Use the below command to update log_checkpoints configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_checkpoints --value on From PowerShell Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name log_checkpoints -Value on",
      "references": [
        "https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling log_checkpoints helps the PostgreSQL Database to Log each checkpoint in turn generates query and error logs. However, access to transaction logs is not supported. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_connections enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_connections_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_connections enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/rest/api/postgresql/configurations/listbyserver",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.0": [
          "4.3.3"
        ],
        "CIS-2.1": [
          "4.3.3"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.3"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.c",
          "3.2.3.e",
          "3.2.3.g",
          "11.2.2.f"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.3"
        ],
        "CIS-3.0": [
          "5.2.6"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Enable log_connections on PostgreSQL Servers.",
      "title": "Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_connections_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-rtac"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac",
            "name": "psql-rtac",
            "resource_group": "rg-rtac",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-rtac",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for log_connections. 5. Click ON and save. From Azure CLI Use the below command to update log_connections configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_connections --value on From PowerShell Use the below command to update log_connections configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name log_connections -Value on",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling log_connections helps PostgreSQL Database to log attempted connection to the server, as well as successful completion of client authentication. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_disconnections enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_disconnections_on",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_disconnections enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/rest/api/postgresql/singleserver/configurations/list-by-server",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Enabling this setting will enable a log of all disconnections. If this is enabled for a high traffic server, the log may grow exponentially.",
      "compliance": {
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.0": [
          "4.3.4"
        ],
        "CIS-2.1": [
          "4.3.4"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.4"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.c",
          "3.2.3.e",
          "3.2.3.g",
          "11.2.2.f"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.3"
        ],
        "CIS-3.0": [
          "5.2.7"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Enable log_disconnections on PostgreSQL Servers.",
      "title": "Ensure server parameter 'log_disconnections' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_disconnections_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-rtac"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac",
            "name": "psql-rtac",
            "resource_group": "rg-rtac",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-rtac",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. From Azure Home select the Portal Menu 2. Go to Azure Database for PostgreSQL servers 3. For each database, click on Server parameters 4. Search for log_disconnections. 5. Click ON and save. From Azure CLI Use the below command to update log_disconnections configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_disconnections --value on From PowerShell Use the below command to update log_disconnections configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGr",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling log_disconnections helps PostgreSQL Database to Logs end of a session, including duration, which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_retention disabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_retention_days_greater_3",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Flexible Postgresql server psql-rtac from subscription Azure subscription 1 has log_retention disabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-portal",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Configuring this setting will result in logs being retained for the specified number of days. If this is configured on a high traffic server, the log may grow quickly to occupy a large amount of disk space. In this case you may want to set this to a lower number.",
      "compliance": {
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1",
          "cc_c_1_2"
        ],
        "CIS-2.0": [
          "4.3.6"
        ],
        "CCC": [
          "CCC.Logging.C02.TR02"
        ],
        "CIS-2.1": [
          "4.3.6"
        ],
        "ProwlerThreatScore-1.0": [
          "3.2.2"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.g",
          "3.2.5",
          "4.1.2.g",
          "4.1.4",
          "6.1.2.b",
          "11.2.2.f",
          "12.2.2.a"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "ENS-RD2022": [
          "op.exp.8.r3.az.nt.1",
          "op.mon.3.az.nw.1"
        ],
        "CIS-3.0": [
          "5.2.4"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure log_retention_days on PostgreSQL Servers is set to an appropriate value.",
      "title": "Ensure Server Parameter 'log_retention_days' is greater than 3 days for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_retention_days_greater_3-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-rtac"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac",
            "name": "psql-rtac",
            "resource_group": "rg-rtac",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-rtac",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-rtac/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-rtac"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. From Azure Home select the Portal Menu. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for log_retention_days. 5. Input a value between 4 and 7 (inclusive) and click Save. From Azure CLI Use the below command to update log_retention_days configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_retention_days --value <4-7> From Powershell Use the below command to update log_retention_days configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name log_retention_days -Value <4-7>",
      "references": [
        "https://learn.microsoft.com/en-us/rest/api/postgresql/singleserver/configurations/list-by-server?view=rest-postgresql-singleserver-2017-12-01&tabs=HTTP"
      ]
    },
    "risk_details": "Configuring log_retention_days determines the duration in days that Azure Database for PostgreSQL retains log files. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has shared key access enabled.",
    "metadata": {
      "event_code": "storage_account_key_access_disabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has shared key access enabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/shared-key-authorization-prevent",
      "categories": [
        "e3"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.ObjStor.C02.TR02",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-4.0": [
          "10.3.1.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensures that access to Azure Storage Accounts using account keys is disabled, enforcing the use of Microsoft Entra ID (formerly Azure AD) for authentication.",
      "title": "Ensure allow storage account key access is disabled",
      "types": [],
      "uid": "prowler-azure-storage_account_key_access_disabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Disable Shared Key authorization on storage accounts to enforce the use of Microsoft Entra ID for secure, auditable access.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/common/shared-key-authorization-prevent"
      ]
    },
    "risk_details": "Using Shared Key authorization poses a security risk due to the high privileges associated with storage account keys and the difficulty in auditing such access. Disabling Shared Key access helps enforce identity-based authentication via Microsoft Entra ID, enhancing security and traceability.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has allow blob public access disabled.",
    "metadata": {
      "event_code": "storage_blob_public_access_level_is_disabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has allow blob public access disabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_1"
        ],
        "PCI-4.0": [
          "1.2.8.30",
          "1.2.8.31",
          "1.2.8.32",
          "1.2.8.33",
          "1.2.8.34",
          "1.2.8.35",
          "1.3.1.34",
          "1.3.1.35",
          "1.3.1.36",
          "1.3.1.37",
          "1.3.1.38",
          "1.3.1.39",
          "1.3.2.34",
          "1.3.2.35",
          "1.3.2.36",
          "1.3.2.37",
          "1.3.2.38",
          "1.3.2.39",
          "1.4.2.32",
          "1.4.2.33",
          "1.4.2.34",
          "1.4.2.35",
          "1.4.2.36",
          "1.4.2.37",
          "1.5.1.30",
          "1.5.1.31",
          "1.5.1.32",
          "1.5.1.33",
          "1.5.1.34",
          "1.5.1.35",
          "10.3.2.18",
          "10.3.2.19",
          "10.3.2.20",
          "10.3.2.21",
          "10.3.2.23",
          "10.3.2.24",
          "10.3.3.23",
          "10.3.4.8",
          "10.6.3.33",
          "3.5.1.3.23",
          "3.5.1.3.24",
          "3.5.1.3.25",
          "3.5.1.3.26",
          "3.5.1.3.28",
          "3.5.1.3.29",
          "7.2.1.25",
          "7.2.2.25",
          "7.2.5.19",
          "7.2.6.4",
          "7.3.1.19",
          "7.3.2.19",
          "7.3.3.19",
          "8.2.7.19",
          "8.2.8.21",
          "8.3.4.19",
          "A1.1.2.14",
          "A1.1.2.15",
          "A1.1.2.16",
          "A1.1.2.17",
          "A1.1.2.19",
          "A1.1.2.20",
          "A1.1.3.30",
          "A1.1.3.31",
          "A1.1.3.32",
          "A1.1.3.33",
          "A1.1.3.34",
          "A1.1.3.35",
          "A1.2.1.31",
          "A3.4.1.16",
          "A3.4.1.17",
          "A3.4.1.18",
          "A3.4.1.19",
          "A3.4.1.21",
          "A3.4.1.22"
        ],
        "CIS-2.0": [
          "3.7"
        ],
        "CCC": [
          "CCC.AuditLog.C04.TR01",
          "CCC.AuditLog.C10.TR01",
          "CCC.AuditLog.C10.TR02",
          "CCC.Logging.C05.TR01",
          "CCC.Logging.C05.TR02",
          "CCC.ObjStor.C02.TR01",
          "CCC.ObjStor.C02.TR02",
          "CCC.MLDE.CN07.AR01",
          "CCC.VPC.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN05.AR03"
        ],
        "CIS-2.1": [
          "3.7"
        ],
        "CIS-4.0": [
          "10.3.9",
          "10.3.2.2"
        ],
        "MITRE-ATTACK": [
          "T1530"
        ],
        "ProwlerThreatScore-1.0": [
          "2.2.6"
        ],
        "NIS2": [
          "12.2.2.a"
        ],
        "ISO27001-2022": [
          "A.8.1"
        ],
        "ENS-RD2022": [
          "op.mon.3.r5.az.1"
        ],
        "CIS-3.0": [
          "4.6"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that the 'Public access level' configuration setting is set to 'Private (no anonymous access)' for all blob containers in your storage account in order to block anonymous access to these Microsoft Azure resources.",
      "title": "Ensure that the 'Public access level' is set to 'Private (no anonymous access)' for all blob containers in your storage account",
      "types": [],
      "uid": "prowler-azure-storage_blob_public_access_level_is_disabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Set 'Public access level' configuration setting to 'Private (no anonymous access)'",
      "references": []
    },
    "risk_details": "A user that accesses blob containers anonymously can use constructors that do not require credentials such as shared access signatures.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has blob versioning enabled.",
    "metadata": {
      "event_code": "storage_blob_versioning_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has blob versioning enabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/blobs/versioning-enable",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.ObjStor.C03.TR01",
          "CCC.ObjStor.C04.TR01",
          "CCC.ObjStor.C05.TR01",
          "CCC.ObjStor.C05.TR02",
          "CCC.ObjStor.C05.TR03",
          "CCC.ObjStor.C05.TR04"
        ],
        "CIS-4.0": [
          "10.2.2"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that blob versioning is enabled on Azure Blob Storage accounts to automatically retain previous versions of objects.",
      "title": "Ensure Blob Versioning is Enabled on Azure Blob Storage Accounts",
      "types": [],
      "uid": "prowler-azure-storage_blob_versioning_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Enable blob versioning for all Azure Storage accounts that store critical or sensitive data.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/blobs/versioning-enable"
      ]
    },
    "risk_details": "Without blob versioning, accidental or malicious changes to blobs cannot be easily recovered, leading to potential data loss.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has cross-tenant replication enabled.",
    "metadata": {
      "event_code": "storage_cross_tenant_replication_disabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has cross-tenant replication enabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/blobs/object-replication-prevent-cross-tenant-policies?tabs=portal",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.Core.CN10.AR01",
          "CCC.Core.CN05.AR03"
        ],
        "CIS-4.0": [
          "10.3.8"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that cross-tenant replication is not enabled on Azure Storage Accounts to prevent unintended replication of data across tenant boundaries.",
      "title": "Ensure cross-tenant replication is disabled",
      "types": [],
      "uid": "prowler-azure-storage_cross_tenant_replication_disabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Disable Cross Tenant Replication on storage accounts to ensure that data remains within tenant boundaries unless explicitly shared, reducing the risk of data leakage and unauthorized access.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/blobs/object-replication-prevent-cross-tenant-policies?tabs=portal"
      ]
    },
    "risk_details": "If cross-tenant replication is enabled, sensitive data could be inadvertently replicated across tenants, increasing the risk of data leakage, unauthorized access, or non-compliance with data governance and privacy policies.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has network access rule set to Allow.",
    "metadata": {
      "event_code": "storage_default_network_access_rule_is_denied",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has network access rule set to Allow.",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "All allowed networks will need to be whitelisted on each specific network, creating administrative overhead. This may result in loss of network connectivity, so do not turn on for critical resources during business hours.",
      "compliance": {
        "CIS-2.0": [
          "3.8"
        ],
        "CCC": [
          "CCC.AuditLog.C10.TR02",
          "CCC.ObjStor.C02.TR01",
          "CCC.MLDE.CN07.AR01",
          "CCC.MLDE.CN07.AR02",
          "CCC.MLDE.CN08.AR01",
          "CCC.MLDE.CN08.AR02",
          "CCC.VPC.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR04"
        ],
        "CIS-2.1": [
          "3.8"
        ],
        "CIS-4.0": [
          "2.2.1.2",
          "10.3.2.3"
        ],
        "ProwlerThreatScore-1.0": [
          "2.2.7"
        ],
        "NIS2": [
          "1.2.1",
          "2.3.1",
          "6.7.2.b",
          "11.1.1",
          "11.2.1",
          "12.2.2.a"
        ],
        "ENS-RD2022": [
          "op.exp.8.r4.az.sa.2"
        ],
        "CIS-3.0": [
          "4.7"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Restricting default network access helps to provide a new layer of security, since storage accounts accept connections from clients on any network. To limit access toselected networks, the default action must be changed.",
      "title": "Ensure Default Network Access Rule for Storage Accounts is Set to Deny",
      "types": [],
      "uid": "prowler-azure-storage_default_network_access_rule_is_denied-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "1. Go to Storage Accounts 2. For each storage account, Click on the Networking blade 3. Click the Firewalls and virtual networks heading. 4. Ensure that you have elected to allow access from Selected networks 5. Add rules to allow traffic from specific network. 6. Click Save to apply your changes.",
      "references": []
    },
    "risk_details": "Storage accounts should be configured to deny access to traffic from all networks (including internet traffic). Access can be granted to traffic from specific Azure Virtualnetworks, allowing a secure network boundary for specific applications to be built.Access can also be granted to public internet IP address ranges to enable connectionsfrom specific internet or on-premises clients. When network rules are configured, onlyapplications from allowed networks can access a storage account. When calling from anallowed network, applications continue to require proper authorization (a valid accesskey or SAS token) to access the storage account.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Default to Microsoft Entra authorization is not enabled for storage account stcfistorage310cdfd6.",
    "metadata": {
      "event_code": "storage_default_to_entra_authorization_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Default to Microsoft Entra authorization is not enabled for storage account stcfistorage310cdfd6.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.ObjStor.C02.TR02",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-4.0": [
          "10.3.3.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that the Azure Storage Account setting 'Default to Microsoft Entra authorization in the Azure portal' is enabled to enforce the use of Microsoft Entra ID for accessing blobs, files, queues, and tables.",
      "title": "Ensure Microsoft Entra authorization is enabled by default for Azure Storage Accounts",
      "types": [],
      "uid": "prowler-azure-storage_default_to_entra_authorization_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Enable Microsoft Entra authorization by default in the Azure portal to enhance security and avoid reliance on Shared Key authentication.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/blobs/authorize-access-azure-active-directory"
      ]
    },
    "risk_details": "If this setting is not enabled, the Azure portal may authorize access using less secure methods such as Shared Key, increasing the risk of unauthorized data access.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 allows trusted Microsoft services to access this storage account.",
    "metadata": {
      "event_code": "storage_ensure_azure_services_are_trusted_to_access_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 allows trusted Microsoft services to access this storage account.",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "PCI-4.0": [
          "10.6.3.35",
          "11.5.2.5",
          "11.6.1.5",
          "12.10.5.5",
          "7.2.1.27",
          "7.2.2.27",
          "7.2.5.21",
          "7.2.6.5",
          "7.3.1.21",
          "7.3.2.21",
          "7.3.3.21",
          "8.2.7.21",
          "8.2.8.23",
          "8.3.4.21",
          "A3.3.1.8",
          "A3.5.1.8"
        ],
        "CIS-2.0": [
          "3.9"
        ],
        "CCC": [
          "CCC.MLDE.CN08.AR02",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR04",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-2.1": [
          "3.9"
        ],
        "CIS-4.0": [
          "10.3.5"
        ],
        "MITRE-ATTACK": [
          "T1530"
        ],
        "ProwlerThreatScore-1.0": [
          "2.2.8"
        ],
        "NIS2": [
          "12.2.2.a"
        ],
        "ISO27001-2022": [
          "A.8.3"
        ],
        "ENS-RD2022": [
          "mp.info.6.r2.az.sa.1"
        ],
        "CIS-3.0": [
          "4.8"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled within your Azure Storage account configuration settings to grant access to trusted cloud services.",
      "title": "Ensure that 'Allow trusted Microsoft services to access this storage account' is enabled for storage accounts",
      "types": [],
      "uid": "prowler-azure-storage_ensure_azure_services_are_trusted_to_access_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "To allow these Azure services to work as intended and be able to access your storage account resources, you have to add an exception so that the trusted Microsoft Azure services can bypass your network rules",
      "references": []
    },
    "risk_details": "Not allowing to access storage account by Azure services the following services: Azure Backup, Azure Event Grid, Azure Site Recovery, Azure DevTest Labs, Azure Event Hubs, Azure Networking, Azure Monitor and Azure SQL Data Warehouse (when registered in the subscription), are not granted access to your storage account",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 does not encrypt with CMKs.",
    "metadata": {
      "event_code": "storage_ensure_encryption_with_customer_managed_keys",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 does not encrypt with CMKs.",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [
        "encryption"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_7",
          "cc_7_5"
        ],
        "PCI-4.0": [
          "3.5.1.34",
          "8.3.2.53"
        ],
        "CIS-2.0": [
          "3.12"
        ],
        "CCC": [
          "CCC.ObjStor.C01.TR01",
          "CCC.ObjStor.C01.TR02",
          "CCC.ObjStor.C01.TR03",
          "CCC.ObjStor.C01.TR04",
          "CCC.Message.CN01.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN13.AR02",
          "CCC.Core.CN02.AR01",
          "CCC.Core.CN11.AR01",
          "CCC.Core.CN11.AR03",
          "CCC.Core.CN11.AR04",
          "CCC.Core.CN11.AR05"
        ],
        "CIS-2.1": [
          "3.12"
        ],
        "CIS-4.0": [
          "2.1.1.2.1"
        ],
        "MITRE-ATTACK": [
          "T1530"
        ],
        "ProwlerThreatScore-1.0": [
          "4.2.1"
        ],
        "NIS2": [
          "9.2.a",
          "9.2.c.iv",
          "12.2.2.a",
          "12.2.2.b"
        ],
        "ISO27001-2022": [
          "A.8.5",
          "A.8.11",
          "A.8.24"
        ],
        "ENS-RD2022": [
          "op.exp.10.az.kv.2"
        ],
        "CIS-3.0": [
          "4.11"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
      "title": "Ensure that your Microsoft Azure Storage accounts are using Customer Managed Keys (CMKs) instead of Microsoft Managed Keys",
      "types": [],
      "uid": "prowler-azure-storage_ensure_encryption_with_customer_managed_keys-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Enable sensitive data encryption at rest using Customer Managed Keys rather than Microsoft Managed keys.",
      "references": []
    },
    "risk_details": "If you want to control and manage storage account contents encryption key yourself you must specify a customer-managed key",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "File share soft delete is enabled for storage account stcfistorage310cdfd6 with a retention period of 7 days.",
    "metadata": {
      "event_code": "storage_ensure_file_shares_soft_delete_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "File share soft delete is enabled for storage account stcfistorage310cdfd6 with a retention period of 7 days.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/files/storage-files-prevent-file-share-deletion?tabs=azure-portal",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.ObjStor.C04.TR01",
          "CCC.ObjStor.C04.TR02",
          "CCC.Vector.CN03.AR01"
        ],
        "CIS-4.0": [
          "10.1.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that soft delete is enabled for Azure File Shares to protect against accidental or malicious deletion of important data. This feature allows deleted file shares to be retained for a specified period, during which they can be recovered before permanent deletion occurs.",
      "title": "Ensure soft delete for Azure File Shares is enabled",
      "types": [],
      "uid": "prowler-azure-storage_ensure_file_shares_soft_delete_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
            "name": "default",
            "type": "Microsoft.Storage/storageAccounts/fileServices",
            "share_delete_retention_policy": {
              "enabled": true,
              "days": 7
            },
            "smb_protocol_settings": {
              "channel_encryption": [],
              "supported_versions": []
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Enable soft delete for file shares on your Azure Storage Account to allow recovery of deleted shares within a configured retention period.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/files/storage-files-prevent-file-share-deletion?tabs=azure-portal"
      ]
    },
    "risk_details": "Without soft delete enabled, accidental or malicious deletions of file shares result in permanent data loss, making recovery impossible unless a separate backup mechanism is in place.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has TLS version set to 1.2.",
    "metadata": {
      "event_code": "storage_ensure_minimum_tls_version_12",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has TLS version set to 1.2.",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [
        "encryption"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_6"
        ],
        "CIS-2.0": [
          "3.15"
        ],
        "CCC": [
          "CCC.LB.C08.TR01",
          "CCC.Core.CN01.AR01",
          "CCC.Core.CN01.AR02",
          "CCC.Core.CN01.AR03",
          "CCC.Core.CN01.AR07",
          "CCC.Core.CN11.AR01"
        ],
        "CIS-2.1": [
          "3.15"
        ],
        "CIS-4.0": [
          "10.3.7"
        ],
        "MITRE-ATTACK": [
          "T1040"
        ],
        "ProwlerThreatScore-1.0": [
          "4.1.3"
        ],
        "NIS2": [
          "6.7.2.i",
          "6.7.2.l",
          "12.2.2.a",
          "12.2.2.c"
        ],
        "ENS-RD2022": [
          "mp.com.3.r2.az.tls.3"
        ],
        "CIS-3.0": [
          "4.15"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
      "title": "Ensure the 'Minimum TLS version' for storage accounts is set to 'Version 1.2'",
      "types": [],
      "uid": "prowler-azure-storage_ensure_minimum_tls_version_12-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Ensure that all your Microsoft Azure Storage accounts are using the latest available version of the TLS protocol.",
      "references": [
        "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/StorageAccounts/minimum-tls-version.html"
      ]
    },
    "risk_details": "TLS versions 1.0 and 1.1 are known to be susceptible to certain Common Vulnerabilities and Exposures (CVE) weaknesses and attacks such as POODLE and BEAST",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 does not have private endpoint connections.",
    "metadata": {
      "event_code": "storage_ensure_private_endpoints_in_storage_accounts",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 does not have private endpoint connections.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-private-endpoints",
      "categories": [
        "encryption"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_3_3"
        ],
        "CIS-2.0": [
          "3.10"
        ],
        "CCC": [
          "CCC.AuditLog.C10.TR01",
          "CCC.AuditLog.C10.TR02",
          "CCC.ObjStor.C01.TR03",
          "CCC.ObjStor.C02.TR01",
          "CCC.ObjStor.C02.TR02",
          "CCC.MLDE.CN07.AR01",
          "CCC.MLDE.CN07.AR02",
          "CCC.MLDE.CN08.AR01",
          "CCC.MLDE.CN08.AR02",
          "CCC.VPC.CN02.AR01",
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN06.AR01",
          "CCC.Core.CN10.AR01",
          "CCC.Core.CN05.AR02",
          "CCC.Core.CN05.AR03",
          "CCC.Core.CN05.AR05"
        ],
        "CIS-2.1": [
          "3.10"
        ],
        "CIS-4.0": [
          "2.2.2.1",
          "10.3.2.1"
        ],
        "MITRE-ATTACK": [
          "T1530"
        ],
        "ProwlerThreatScore-1.0": [
          "2.2.9"
        ],
        "NIS2": [
          "1.1.1.a",
          "1.1.1.c",
          "6.7.2.i",
          "6.7.2.l",
          "11.2.2.d",
          "12.2.2.a"
        ],
        "ISO27001-2022": [
          "A.8.14"
        ],
        "ENS-RD2022": [
          "mp.com.4.r2..az.sa.1"
        ],
        "CIS-3.0": [
          "4.9"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Use private endpoints for your Azure Storage accounts to allow clients and services to securely access data located over a network via an encrypted Private Link. To do this, the private endpoint uses an IP address from the VNet for each service. Network traffic between disparate services securely traverses encrypted over the VNet. This VNet can also link addressing space, extending your network and accessing resources on it. Similarly, it can be a tunnel through public networks to connect remote infrastructures together. This creates further security through segmenting network traffic and preventing outside sources from accessing it.",
      "title": "Ensure Private Endpoints are used to access Storage Accounts",
      "types": [],
      "uid": "prowler-azure-storage_ensure_private_endpoints_in_storage_accounts-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Use Private Endpoints to access Storage Accounts",
      "references": [
        "https://docs.microsoft.com/en-us/azure/storage/common/storage-private-endpoints"
      ]
    },
    "risk_details": "Storage accounts that are not configured to use Private Endpoints are accessible over the public internet. This can lead to data exfiltration and other security issues.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has soft delete enabled.",
    "metadata": {
      "event_code": "storage_ensure_soft_delete_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has soft delete enabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/blobs/soft-delete-blob-enable?tabs=azure-portal",
      "categories": [
        "encryption"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Additional storage costs may be incurred as snapshots are retained.",
      "compliance": {
        "SOC2": [
          "cc_7_4",
          "cc_c_1_1",
          "cc_c_1_2"
        ],
        "PCI-4.0": [
          "10.3.2.22",
          "3.5.1.3.27",
          "8.4.1.5",
          "8.4.2.5",
          "8.4.3.5",
          "A1.1.2.18",
          "A3.4.1.20"
        ],
        "CIS-2.0": [
          "3.11"
        ],
        "CCC": [
          "CCC.AuditLog.C06.TR01",
          "CCC.AuditLog.C08.TR01",
          "CCC.ObjStor.C03.TR01",
          "CCC.ObjStor.C04.TR01",
          "CCC.ObjStor.C04.TR02",
          "CCC.Vector.CN03.AR01"
        ],
        "CIS-2.1": [
          "3.11"
        ],
        "CIS-4.0": [
          "10.2.1",
          "10.3.6"
        ],
        "MITRE-ATTACK": [
          "T1485"
        ],
        "NIS2": [
          "4.2.2.f",
          "12.2.2.a",
          "12.2.2.b"
        ],
        "ISO27001-2022": [
          "A.8.10"
        ],
        "CIS-3.0": [
          "4.10"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "The Azure Storage blobs contain data like ePHI or Financial, which can be secret or personal. Data that is erroneously modified or deleted by an application or other storage account user will cause data loss or unavailability.",
      "title": "Ensure Soft Delete is Enabled for Azure Containers and Blob Storage",
      "types": [],
      "uid": "prowler-azure-storage_ensure_soft_delete_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "From the Azure home page, open the hamburger menu in the top left or click on the arrow pointing right with 'More services' underneath. 2. Select Storage. 3. Select Storage Accounts. 4. For each Storage Account, navigate to Data protection in the left scroll column. 5. Check soft delete for both blobs and containers. Set the retention period to a sufficient length for your organization",
      "references": [
        "https://docs.microsoft.com/en-us/azure/storage/blobs/storage-blob-soft-delete"
      ]
    },
    "risk_details": "Containers and Blob Storage data can be incorrectly deleted. An attacker/malicious user may do this deliberately in order to cause disruption. Deleting an Azure Storage blob causes immediate data loss. Enabling this configuration for Azure storage ensures that even if blobs/data were deleted from the storage account, Blobs/data objects are recoverable for a particular time which is set in the Retention policies ranging from 7 days to 365 days.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has Geo-redundant storage Standard_GRS enabled.",
    "metadata": {
      "event_code": "storage_geo_redundant_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 4,
    "severity": "High",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has Geo-redundant storage Standard_GRS enabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-redundancy",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CCC": [
          "CCC.Logging.C05.TR02",
          "CCC.Core.CN08.AR01",
          "CCC.Core.CN08.AR02"
        ],
        "CIS-4.0": [
          "10.3.12"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Geo-redundant storage (GRS) must be enabled on critical Azure Storage Accounts to ensure data durability and availability in the event of a regional outage. GRS replicates data within the primary region and asynchronously to a secondary region, offering enhanced resilience and supporting disaster recovery strategies.",
      "title": "Ensure geo-redundant storage (GRS) is enabled on critical Azure Storage Accounts",
      "types": [],
      "uid": "prowler-azure-storage_geo_redundant_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Enable geo-redundant storage (GRS) for critical Azure Storage Accounts to ensure data durability and availability across regional failures.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/common/storage-redundancy"
      ]
    },
    "risk_details": "Without GRS, critical data may be lost or become unavailable during a regional outage, compromising data durability and disaster recovery efforts.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has infrastructure encryption disabled.",
    "metadata": {
      "event_code": "storage_infrastructure_encryption_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 2,
    "severity": "Low",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has infrastructure encryption disabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [
        "encryption"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_7",
          "cc_7_5"
        ],
        "PCI-4.0": [
          "3.5.1.22",
          "8.3.2.37"
        ],
        "CIS-2.0": [
          "3.2"
        ],
        "CCC": [
          "CCC.Core.CN02.AR01"
        ],
        "CIS-2.1": [
          "3.2"
        ],
        "CIS-4.0": [
          "10.3.1.1"
        ],
        "MITRE-ATTACK": [
          "T1530"
        ],
        "NIS2": [
          "9.2.a",
          "12.2.2.a",
          "12.2.2.b"
        ],
        "ISO27001-2022": [
          "A.8.5",
          "A.8.11",
          "A.8.24"
        ],
        "ENS-RD2022": [
          "op.exp.10.az.kv.2"
        ],
        "CIS-3.0": [
          "4.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
      "title": "Ensure that 'Enable Infrastructure Encryption' for Each Storage Account in Azure Storage is Set to 'enabled' ",
      "types": [],
      "uid": "prowler-azure-storage_infrastructure_encryption_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureRole",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Enabling double encryption at the hardware level on top of the default software encryption for Storage Accounts accessing Azure storage solutions.",
      "references": []
    },
    "risk_details": "Double encryption of Azure Storage data protects against a scenario where one of the encryption algorithms or keys may be compromised",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has no key expiration period set.",
    "metadata": {
      "event_code": "storage_key_rotation_90_days",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has no key expiration period set.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal",
      "categories": [
        "encryption"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CIS-2.0": [
          "3.4"
        ],
        "CCC": [
          "CCC.SecMgmt.CN01.AR01",
          "CCC.Core.CN11.AR02",
          "CCC.Core.CN11.AR05"
        ],
        "CIS-2.1": [
          "3.4"
        ],
        "CIS-4.0": [
          "10.3.1.2"
        ],
        "NIS2": [
          "9.2.c.iii",
          "9.2.c.iv",
          "11.6.2.c",
          "12.2.2.a"
        ],
        "ENS-RD2022": [
          "op.acc.6.r1.az.eid.2"
        ],
        "CIS-3.0": [
          "4.4"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that Storage Account Access Keys are Periodically Regenerated",
      "title": "Ensure that Storage Account Access Keys are Periodically Regenerated",
      "types": [],
      "uid": "prowler-azure-storage_key_rotation_90_days-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Ensure that Azure Storage account access keys are regenerated every 90 days in order to decrease the likelihood of accidental exposures and protect your storage account resources against unauthorized access.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/common/storage-account-create?tabs=azure-portal#regenerate-storage-access-keys"
      ]
    },
    "risk_details": "If the access keys are not regenerated periodically, the likelihood of accidental exposures increases, which can lead to unauthorized access to your storage account resources.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has secure transfer required enabled.",
    "metadata": {
      "event_code": "storage_secure_transfer_required_is_enabled",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 has secure transfer required enabled.",
    "status_id": 1,
    "unmapped": {
      "related_url": "",
      "categories": [
        "encryption"
      ],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "SOC2": [
          "cc_6_2",
          "cc_6_7"
        ],
        "PCI-4.0": [
          "1.2.5.15",
          "2.2.5.15",
          "2.2.7.19",
          "3.5.1.30",
          "4.2.1.1.27",
          "4.2.1.19",
          "8.3.2.48",
          "8.3.2.49"
        ],
        "CIS-2.0": [
          "3.1"
        ],
        "CCC": [
          "CCC.Vector.CN03.AR01",
          "CCC.Core.CN01.AR01",
          "CCC.Core.CN01.AR02",
          "CCC.Core.CN01.AR03",
          "CCC.Core.CN01.AR07",
          "CCC.Core.CN11.AR01",
          "CCC.Core.CN05.AR04"
        ],
        "CIS-2.1": [
          "3.1"
        ],
        "CIS-4.0": [
          "10.3.4"
        ],
        "MITRE-ATTACK": [
          "T1040"
        ],
        "NIS2": [
          "6.7.2.i",
          "6.7.2.l",
          "9.2.a",
          "12.2.2.a",
          "12.2.2.b",
          "12.2.2.c"
        ],
        "ISO27001-2022": [
          "A.8.12",
          "A.8.14",
          "A.8.24"
        ],
        "ENS-RD2022": [
          "mp.com.3.az.sa.1"
        ],
        "CIS-3.0": [
          "4.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
      "title": "Ensure that all data transferred between clients and your Azure Storage account is encrypted using the HTTPS protocol.",
      "types": [],
      "uid": "prowler-azure-storage_secure_transfer_required_is_enabled-3bb71587-4549-4396-8898-9e15f062e665-eastus-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "eastus",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6",
            "name": "stcfistorage310cdfd6",
            "location": "eastus",
            "resouce_group_name": "rg-cfi-storage",
            "enable_https_traffic_only": true,
            "infrastructure_encryption": null,
            "allow_blob_public_access": false,
            "network_rule_set": {
              "bypass": "AzureServices",
              "default_action": "Allow"
            },
            "encryption_type": "Microsoft.Storage",
            "minimum_tls_version": "TLS1_2",
            "private_endpoint_connections": [],
            "key_expiration_period_in_days": null,
            "replication_settings": "Standard_GRS",
            "allow_cross_tenant_replication": true,
            "allow_shared_key_access": true,
            "blob_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/blobServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/blobServices",
              "container_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "default_service_version": null,
              "versioning_enabled": true
            },
            "default_to_entra_authorization": false,
            "file_service_properties": {
              "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
              "name": "default",
              "type": "Microsoft.Storage/storageAccounts/fileServices",
              "share_delete_retention_policy": {
                "enabled": true,
                "days": 7
              },
              "smb_protocol_settings": {
                "channel_encryption": [],
                "supported_versions": []
              }
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "eastus"
    },
    "remediation": {
      "desc": "Enable data encryption in transit.",
      "references": []
    },
    "risk_details": "Requests to the storage account sent outside of a secure connection can be eavesdropped",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 does not have SMB channel encryption enabled for file shares.",
    "metadata": {
      "event_code": "storage_smb_channel_encryption_with_secure_algorithm",
      "product": {
        "name": "Prowler (complete)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Storage account stcfistorage310cdfd6 from subscription Azure subscription 1 does not have SMB channel encryption enabled for file shares.",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/well-architected/service-guides/azure-files#recommendations-for-smb-file-shares",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "This check passes if SMB channel encryption is set to a secure algorithm.",
      "compliance": {
        "CCC": [
          "CCC.Core.CN01.AR07",
          "CCC.Core.CN11.AR01"
        ],
        "CIS-4.0": [
          "10.1.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760532187,
      "created_time_dt": "2025-10-15T12:43:07.191657",
      "desc": "Implement SMB channel encryption with a secure algorithm for SMB file shares to ensure data confidentiality and integrity in transit.",
      "title": "Ensure SMB channel encryption uses a secure algorithm for SMB file shares",
      "types": [],
      "uid": "prowler-azure-storage_smb_channel_encryption_with_secure_algorithm-3bb71587-4549-4396-8898-9e15f062e665-global-stcfistorage310cdfd6"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "global",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default",
            "name": "default",
            "type": "Microsoft.Storage/storageAccounts/fileServices",
            "share_delete_retention_policy": {
              "enabled": true,
              "days": 7
            },
            "smb_protocol_settings": {
              "channel_encryption": [],
              "supported_versions": []
            }
          }
        },
        "group": {
          "name": "storage"
        },
        "labels": [],
        "name": "stcfistorage310cdfd6",
        "type": "AzureStorageAccount",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-cfi-storage/providers/Microsoft.Storage/storageAccounts/stcfistorage310cdfd6/fileServices/default"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "global"
    },
    "remediation": {
      "desc": "Use the portal, CLI or PowerShell to set the SMB channel encryption to a secure algorithm.",
      "references": [
        "https://learn.microsoft.com/en-us/azure/storage/files/files-smb-protocol?tabs=azure-portal#smb-security-settings"
      ]
    },
    "risk_details": "Not using the recommended SMB channel encryption may expose data transmitted over SMB channels to unauthorized interception and tampering.",
    "time": 1760532187,
    "time_dt": "2025-10-15T12:43:07.191657",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  }
]
