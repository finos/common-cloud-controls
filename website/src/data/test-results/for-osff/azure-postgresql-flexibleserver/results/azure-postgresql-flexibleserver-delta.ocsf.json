[
  {
    "message": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has allow public access from any Azure service disabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_allow_access_services_disabled",
      "product": {
        "name": "Prowler (delta)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has allow public access from any Azure service disabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/postgresql/concepts-firewall-rules",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "ENS-RD2022": [
          "op.exp.8.r4.az.sa.3"
        ],
        "CIS-2.0": [
          "4.3.7"
        ],
        "ProwlerThreatScore-1.0": [
          "2.2.2"
        ],
        "ISO27001-2022": [
          "A.8.3"
        ],
        "CIS-2.1": [
          "4.3.7"
        ],
        "CIS-3.0": [
          "5.2.5"
        ],
        "CCC": [
          "CCC.DataWar.CN03.AR01"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760900038,
      "created_time_dt": "2025-10-19T18:53:58.634122",
      "desc": "Disable access from Azure services to PostgreSQL Database Server.",
      "title": "Ensure 'Allow access to Azure services' for PostgreSQL Database Server is disabled",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_allow_access_services_disabled-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-ireu"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu",
            "name": "psql-ireu",
            "resource_group": "rg-ireu",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-ireu",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Connection security. 4. Under Firewall rules, set Allow access to Azure services to No. 5. Click Save. From Azure CLI Use the below command to delete the AllowAllWindowsAzureIps rule for PostgreSQL Database. az postgres server firewall-rule delete --name AllowAllWindowsAzureIps -- resource-group <resourceGroupName> --server-name <serverName>",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/quickstart-create-server-database-azure-cli#configure-a-server-based-firewall-rule"
      ]
    },
    "risk_details": "If access from Azure services is enabled, the server's firewall will accept connections from all Azure resources, including resources not in your subscription. This is usually not a desired configuration. Instead, set up firewall rules to allow access from specific network ranges or VNET rules to allow access from specific virtual networks.",
    "time": 1760900038,
    "time_dt": "2025-10-19T18:53:58.634122",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has connection_throttling disabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_connection_throttling_on",
      "product": {
        "name": "Prowler (delta)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has connection_throttling disabled",
    "status_id": 1,
    "unmapped": {
      "related_url": " https://docs.microsoft.com/en-us/rest/api/postgresql/configurations/listbyserver",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "CIS-2.0": [
          "4.3.5"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.2"
        ],
        "CIS-2.1": [
          "4.3.5"
        ],
        "CIS-3.0": [
          "5.2.3"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760900038,
      "created_time_dt": "2025-10-19T18:53:58.634122",
      "desc": "Enable connection_throttling on PostgreSQL Servers.",
      "title": "Ensure server parameter 'connection_throttling' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_connection_throttling_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-ireu"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu",
            "name": "psql-ireu",
            "resource_group": "rg-ireu",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-ireu",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for connection_throttling. 5. Click ON and save. From Azure CLI Use the below command to update connection_throttling configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name connection_throttling --value on From PowerShell Use the below command to update connection_throttling configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name connection_throttling -Value on",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling connection_throttling helps the PostgreSQL Database to Set the verbosity of logged messages. This in turn generates query and error logs with respect to concurrent connections that could lead to a successful Denial of Service (DoS) attack by exhausting connection resources. A system can also fail or be degraded by an overload of legitimate users. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760900038,
    "time_dt": "2025-10-19T18:53:58.634122",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has enforce ssl enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_enforce_ssl_enabled",
      "product": {
        "name": "Prowler (delta)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has enforce ssl enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-ssl-connection-security",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": ".",
      "compliance": {
        "MITRE-ATTACK": [
          "T1040",
          "T1530"
        ],
        "CIS-2.0": [
          "4.3.1"
        ],
        "ProwlerThreatScore-1.0": [
          "4.1.1",
          "4.1.2"
        ],
        "SOC2": [
          "cc_6_2",
          "cc_6_6"
        ],
        "CIS-2.1": [
          "4.3.1"
        ],
        "CIS-3.0": [
          "5.2.1",
          "5.3.1"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760900038,
      "created_time_dt": "2025-10-19T18:53:58.634122",
      "desc": "Enable SSL connection on PostgreSQL Servers.",
      "title": "Ensure 'Enforce SSL connection' is set to 'ENABLED' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_enforce_ssl_enabled-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-ireu"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu",
            "name": "psql-ireu",
            "resource_group": "rg-ireu",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-ireu",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com 2. Go to Azure Database for PostgreSQL server 3. For each database, click on Connection security 4. In SSL settings, click on ENABLED to enforce SSL connections 5. Click Save From Azure CLI Use the below command to enforce ssl connection for PostgreSQL Database. az postgres server update --resource-group <resourceGroupName> --name <serverName> --ssl-enforcement Enabled From PowerShell Update-AzPostgreSqlServer -ResourceGroupName <ResourceGroupName > -ServerName <ServerName> -SslEnforcement Enabled",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/concepts-ssl-connection-security"
      ]
    },
    "risk_details": "SSL connectivity helps to provide a new layer of security by connecting database server to client applications using Secure Sockets Layer (SSL). Enforcing SSL connections between database server and client applications helps protect against 'man in the middle' attacks by encrypting the data stream between the server and application.",
    "time": 1760900038,
    "time_dt": "2025-10-19T18:53:58.634122",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_checkpoints enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_checkpoints_on",
      "product": {
        "name": "Prowler (delta)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_checkpoints enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": " https://docs.microsoft.com/en-us/rest/api/postgresql/singleserver/configurations/list-by-server",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.3"
        ],
        "CIS-2.0": [
          "4.3.2"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.1"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.1": [
          "4.3.2"
        ],
        "CIS-3.0": [
          "5.2.2"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.g",
          "11.2.2.f"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760900038,
      "created_time_dt": "2025-10-19T18:53:58.634122",
      "desc": "Enable log_checkpoints on PostgreSQL Servers.",
      "title": "Ensure Server Parameter 'log_checkpoints' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_checkpoints_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-ireu"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu",
            "name": "psql-ireu",
            "resource_group": "rg-ireu",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-ireu",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. From Azure Home select the Portal Menu. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for log_checkpoints. 5. Click ON and save. From Azure CLI Use the below command to update log_checkpoints configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_checkpoints --value on From PowerShell Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name log_checkpoints -Value on",
      "references": [
        "https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling log_checkpoints helps the PostgreSQL Database to Log each checkpoint in turn generates query and error logs. However, access to transaction logs is not supported. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760900038,
    "time_dt": "2025-10-19T18:53:58.634122",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_connections enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_connections_on",
      "product": {
        "name": "Prowler (delta)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_connections enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/rest/api/postgresql/configurations/listbyserver",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "",
      "compliance": {
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.3"
        ],
        "CIS-2.0": [
          "4.3.3"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.3"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.1": [
          "4.3.3"
        ],
        "CIS-3.0": [
          "5.2.6"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.c",
          "3.2.3.e",
          "3.2.3.g",
          "11.2.2.f"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760900038,
      "created_time_dt": "2025-10-19T18:53:58.634122",
      "desc": "Enable log_connections on PostgreSQL Servers.",
      "title": "Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_connections_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-ireu"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu",
            "name": "psql-ireu",
            "resource_group": "rg-ireu",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-ireu",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. Login to Azure Portal using https://portal.azure.com. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for log_connections. 5. Click ON and save. From Azure CLI Use the below command to update log_connections configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_connections --value on From PowerShell Use the below command to update log_connections configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name log_connections -Value on",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling log_connections helps PostgreSQL Database to log attempted connection to the server, as well as successful completion of client authentication. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.",
    "time": 1760900038,
    "time_dt": "2025-10-19T18:53:58.634122",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_disconnections enabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_disconnections_on",
      "product": {
        "name": "Prowler (delta)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "PASS",
    "status_detail": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_disconnections enabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/rest/api/postgresql/singleserver/configurations/list-by-server",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Enabling this setting will enable a log of all disconnections. If this is enabled for a high traffic server, the log may grow exponentially.",
      "compliance": {
        "ENS-RD2022": [
          "op.acc.6.r5.az.eid.3"
        ],
        "CIS-2.0": [
          "4.3.4"
        ],
        "ProwlerThreatScore-1.0": [
          "3.1.4"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1"
        ],
        "CIS-2.1": [
          "4.3.4"
        ],
        "CIS-3.0": [
          "5.2.7"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.c",
          "3.2.3.e",
          "3.2.3.g",
          "11.2.2.f"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760900038,
      "created_time_dt": "2025-10-19T18:53:58.634122",
      "desc": "Enable log_disconnections on PostgreSQL Servers.",
      "title": "Ensure server parameter 'log_disconnections' is set to 'ON' for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_disconnections_on-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-ireu"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu",
            "name": "psql-ireu",
            "resource_group": "rg-ireu",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-ireu",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. From Azure Home select the Portal Menu 2. Go to Azure Database for PostgreSQL servers 3. For each database, click on Server parameters 4. Search for log_disconnections. 5. Click ON and save. From Azure CLI Use the below command to update log_disconnections configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_disconnections --value on From PowerShell Use the below command to update log_disconnections configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGr",
      "references": [
        "https://learn.microsoft.com/en-us/azure/postgresql/single-server/how-to-configure-server-parameters-using-portal"
      ]
    },
    "risk_details": "Enabling log_disconnections helps PostgreSQL Database to Logs end of a session, including duration, which in turn generates query and error logs. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760900038,
    "time_dt": "2025-10-19T18:53:58.634122",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  },
  {
    "message": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_retention disabled",
    "metadata": {
      "event_code": "postgresql_flexible_server_log_retention_days_greater_3",
      "product": {
        "name": "Prowler (delta)",
        "uid": "prowler",
        "vendor_name": "Prowler",
        "version": "5.13.0"
      },
      "profiles": [
        "cloud",
        "datetime"
      ],
      "tenant_uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730",
      "version": "1.5.0"
    },
    "severity_id": 3,
    "severity": "Medium",
    "status": "New",
    "status_code": "FAIL",
    "status_detail": "Flexible Postgresql server psql-ireu from subscription Azure subscription 1 has log_retention disabled",
    "status_id": 1,
    "unmapped": {
      "related_url": "https://docs.microsoft.com/en-us/azure/postgresql/howto-configure-server-parameters-using-portal",
      "categories": [],
      "depends_on": [],
      "related_to": [],
      "additional_urls": [],
      "notes": "Configuring this setting will result in logs being retained for the specified number of days. If this is configured on a high traffic server, the log may grow quickly to occupy a large amount of disk space. In this case you may want to set this to a lower number.",
      "compliance": {
        "ENS-RD2022": [
          "op.exp.8.r3.az.nt.1",
          "op.mon.3.az.nw.1"
        ],
        "CIS-2.0": [
          "4.3.6"
        ],
        "ProwlerThreatScore-1.0": [
          "3.2.2"
        ],
        "ISO27001-2022": [
          "A.8.15"
        ],
        "SOC2": [
          "cc_7_2",
          "cc_7_3",
          "cc_a_1_1",
          "cc_c_1_2"
        ],
        "CIS-2.1": [
          "4.3.6"
        ],
        "CIS-3.0": [
          "5.2.4"
        ],
        "CCC": [
          "CCC.Logging.CN02.AR02"
        ],
        "NIS2": [
          "2.1.2.h",
          "3.2.3.g",
          "3.2.5",
          "4.1.2.g",
          "4.1.4",
          "6.1.2.b",
          "11.2.2.f",
          "12.2.2.a"
        ]
      }
    },
    "activity_name": "Create",
    "activity_id": 1,
    "finding_info": {
      "created_time": 1760900038,
      "created_time_dt": "2025-10-19T18:53:58.634122",
      "desc": "Ensure log_retention_days on PostgreSQL Servers is set to an appropriate value.",
      "title": "Ensure Server Parameter 'log_retention_days' is greater than 3 days for PostgreSQL Database Server",
      "types": [],
      "uid": "prowler-azure-postgresql_flexible_server_log_retention_days_greater_3-3bb71587-4549-4396-8898-9e15f062e665-Australia East-psql-ireu"
    },
    "resources": [
      {
        "cloud_partition": "AzureCloud",
        "region": "Australia East",
        "data": {
          "details": "",
          "metadata": {
            "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu",
            "name": "psql-ireu",
            "resource_group": "rg-ireu",
            "require_secure_transport": "ON",
            "log_checkpoints": "ON",
            "log_connections": "ON",
            "log_disconnections": "ON",
            "connection_throttling": "OFF",
            "log_retention_days": null,
            "firewall": [
              {
                "id": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu/firewallRules/rule1",
                "name": "rule1",
                "start_ip": "0.0.0.0",
                "end_ip": "255.255.255.255"
              }
            ],
            "location": "Australia East"
          }
        },
        "group": {
          "name": "postgresql"
        },
        "labels": [],
        "name": "psql-ireu",
        "type": "PostgreSQL",
        "uid": "/subscriptions/3bb71587-4549-4396-8898-9e15f062e665/resourceGroups/rg-ireu/providers/Microsoft.DBforPostgreSQL/flexibleServers/psql-ireu"
      }
    ],
    "category_name": "Findings",
    "class_name": "Detection Finding",
    "cloud": {
      "account": {
        "name": "Azure subscription 1",
        "type": "Azure AD Account",
        "type_id": 6,
        "uid": "3bb71587-4549-4396-8898-9e15f062e665",
        "labels": []
      },
      "org": {
        "name": "Unknown tenant domain (missing AAD permissions)",
        "uid": "6a7cc8e9-8f46-4e6c-ac87-8d5841c99730"
      },
      "provider": "azure",
      "region": "Australia East"
    },
    "remediation": {
      "desc": "From Azure Portal 1. From Azure Home select the Portal Menu. 2. Go to Azure Database for PostgreSQL servers. 3. For each database, click on Server parameters. 4. Search for log_retention_days. 5. Input a value between 4 and 7 (inclusive) and click Save. From Azure CLI Use the below command to update log_retention_days configuration. az postgres server configuration set --resource-group <resourceGroupName> -- server-name <serverName> --name log_retention_days --value <4-7> From Powershell Use the below command to update log_retention_days configuration. Update-AzPostgreSqlConfiguration -ResourceGroupName <ResourceGroupName> - ServerName <ServerName> -Name log_retention_days -Value <4-7>",
      "references": [
        "https://learn.microsoft.com/en-us/rest/api/postgresql/singleserver/configurations/list-by-server?view=rest-postgresql-singleserver-2017-12-01&tabs=HTTP"
      ]
    },
    "risk_details": "Configuring log_retention_days determines the duration in days that Azure Database for PostgreSQL retains log files. Query and error logs can be used to identify, troubleshoot, and repair configuration errors and sub-optimal performance.",
    "time": 1760900038,
    "time_dt": "2025-10-19T18:53:58.634122",
    "type_uid": 200401,
    "type_name": "Detection Finding: Create",
    "category_uid": 2,
    "class_uid": 2004
  }
]
