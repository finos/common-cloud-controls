metadata:
  id: CCC.LB
  title: CCC Load Balancer Capabilities
  description: |
    This documents the minimual set of capabilities that should be present
    for a load balancer service to be considered for use in financial
    services ecosystems.
  version: DEV
  last-modified: "2025-07-14T00:00:00-05:00"
control-families:
  - id: ""
    title: Logging & Monitoring
    description: |
      Controls that detect anomalous traffic and record load-balancer activity.
    controls:
      - id: CCC.LB.CN01
        title: Enforce and Detect Rate Limiting
        objective: |
          Detect and throttle malicious or excessive requests to prevent downstream resource exhaustion and brute-force activity.
        assessment-requirements:
          - id: CCC.LB.CN01.TR01
            text: |
              When a single client sends more than 2000 requests within any
              5-minute sliding window, the load balancer MUST throttle all
              subsequent requests from that client for at least 60 seconds.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Implement per-IP token-bucket limits with and verify via
              synthetic traffic tests.
          - id: CCC.LB.CN01.TR02
            text: |
              When throttling is invoked, the load balancer MUST
              record the event in the access log within 5 minutes
              for alerting and trend analysis.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Enable access logging and configure metric filters
              on HTTP 429 counts to trigger alerts.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: DE.CM-1
                strength: 0
                remarks: Monitor to detect events
              - reference-id: PR.AC-7
                strength: 0
                remarks: Prevent brute-force
              - reference-id: PR.PT-4
                strength: 0
                remarks: Protective technology
          - reference-id: NIST_800_53
            entries:
              - reference-id: AU-6
                strength: 0
                remarks: Audit review, analysis, reporting
              - reference-id: SC-5
                strength: 0
                remarks: Denial-of-Service protection
              - reference-id: AC-7
                strength: 0
                remarks: Unsuccessful logon attempts
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH01
                strength: 0
                remarks: Malicious Traffic
              - reference-id: CCC.LB.TH09
                strength: 0
                remarks: Resource Exhaustion
      - id: CCC.LB.CN06
        title: Secure Health-Check Telemetry
        objective: |
          Monitor health-check endpoints for tampering and alert on
          abnormal status changes.
        assessment-requirements:
          - id: CCC.LB.CN06.TR01
            text: |
              When more than 10 percent of targets change from healthy to
              unhealthy within five minutes, an alert MUST be issued.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Instrument metrics for health check results and target
              removal events. Configure monitoring alarms to alert
              on abnormal spikes in unhealthy targets.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: DE.AE-2
                strength: 0
                remarks: Detected events are analyzed
          - reference-id: NIST_800_53
            entries:
              - reference-id: SI-4
                strength: 0
                remarks: System monitoring
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH05
                strength: 0
                remarks: Health Checks Exploited
      - id: CCC.Core.CN04
        title: Log All Access and Changes
        objective: |
          Ensure that all access attempts are logged to maintain a detailed
          audit trail for security and compliance purposes.
        assessment-requirements:
          - id: CCC.Core.CN04.TR01
            text: |
              When administrative access or configuration change is attempted on
              the service or a child resource, the service MUST log the client
              identity, time, and result of the attempt.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN04.TR02
            text: |
              When any attempt is made to modify data on the service or a child
              resource, the service MUST log the client identity, time, and
              result of the attempt.
            applicability:
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN04.TR03
            text: |
              When any attempt is made to read data on the service or a child
              resource, the service MUST log the client identity, time, and
              result of the attempt.
            applicability:
              - tlp-red
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: DE.AE-3
                strength: 0
          - reference-id: CCM
            entries:
              - reference-id: LOG-08
                strength: 0
          - reference-id: ISO_27001
            entries: []
          - reference-id: NIST_800_53
            entries:
              - reference-id: AU-2
                strength: 0
              - reference-id: AU-3
                strength: 0
              - reference-id: AU-12
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.Core.TH01
                strength: 0
  - id: ""
    title: Identity and Access Management
    description: |
      Controls that restrict who can change or query load-balancer resources.
    controls:
      - id: CCC.LB.CN04
        title: Enforce Distribution Policies
        objective: |
          Ensure traffic-splitting weights and algorithms are modified
          only by trusted identities.
        assessment-requirements:
          - id: CCC.LB.CN04.TR01
            text: |
              When routing weights change, the request MUST originate
              from an explicitly defined and trusted identity and MUST
              be logged.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Define a list of trusted principals allowed to modify
              routing configurations. Enforce via conditional access
              policies, and log changes using audit logging.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-1
                strength: 0
                remarks: Identities and credentials are managed
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-3
                strength: 0
                remarks: Access enforcement
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH03
                strength: 0
                remarks: Traffic Distribution Manipulated
      - id: CCC.LB.CN05
        title: Validate Session Affinity
        objective: |
          Configure session persistence to minimise fixation and hijacking
          risks.
        assessment-requirements:
          - id: CCC.LB.CN05.TR01
            text: |
              When stickiness is enabled, session cookies MUST expire
              within 30 minutes of inactivity.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Audit CCC.LB.F15 parameters via configuration scans.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-7
                strength: 0
                remarks: Least functionality is enforced
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-23
                strength: 0
                remarks: Session authenticity
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH04
                strength: 0
                remarks: Session Persistence Exploited
      - id: CCC.LB.CN09
        title: Restrict Management API Access
        objective: |
          Limit load-balancer API calls to authorised identities and
          trusted networks.
        assessment-requirements:
          - id: CCC.LB.CN09.TR01
            text: |
              When an API call originates outside the approved CIDR
              set, the request MUST be denied.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Combine VPC endpoints with IAM condition-key filters for protected APIs.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-5
                strength: 0
                remarks: Network integrity is protected
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-7
                strength: 0
                remarks: Boundary protection
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH08
                strength: 0
                remarks: API Exposed and Attacked
      - id: CCC.Core.CN03
        title: Implement Multi-factor Authentication (MFA) for Access
        objective: |
          Ensure that all sensitive activities require two or more identity
          factors during authentication to prevent unauthorized access.
        assessment-requirements:
          - id: CCC.Core.CN03.TR01
            text: |
              When an entity attempts to modify the service through a user
              interface, the authentication process MUST require multiple
              identifying factors for authentication.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN03.TR02
            text: |
              When an entity attempts to modify the service through an API
              endpoint, the authentication process MUST require a credential
              such as an API key or token AND originate from within the trust
              perimeter.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN03.TR03
            text: |
              When an entity attempts to view information on the service through
              a user interface, the authentication process MUST require multiple
              identifying factors from the user.
            applicability:
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN03.TR04
            text: |
              When an entity attempts to view information on the service through
              an API endpoint, the authentication process MUST require a
              credential such as an API key or token AND originate from within
              the trust perimeter.
            applicability:
              - tlp-amber
              - tlp-red
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-7
                strength: 0
          - reference-id: CCM
            entries:
              - reference-id: IAM-03
                strength: 0
              - reference-id: IAM-08
                strength: 0
          - reference-id: ISO_27001
            entries:
              - reference-id: 2013 A.9.4.2
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: IA-2
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.Core.TH01
                strength: 0
      - id: CCC.Core.CN05
        title: Prevent Access from Untrusted Entities
        objective: |
          Ensure that secure access controls enforce the principle of least
          privilege to restrict access to authorized entities from explicitly
          trusted sources only.
        assessment-requirements:
          - id: CCC.Core.CN05.TR01
            text: |
              When an attempt is made to modify data on the service or a child
              resource, the service MUST block requests from unauthorized
              entities.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN05.TR02
            text: |
              When administrative access or configuration change is attempted on
              the service or a child resource, the service MUST refuse requests
              from unauthorized entities.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN05.TR03
            text: |
              When administrative access or configuration change is attempted on
              the service or a child resource in a multi-tenant environment, the
              service MUST refuse requests across tenant boundaries unless the
              origin is explicitly included in a pre-approved allowlist.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN05.TR04
            text: |
              When data is requested from outside the trust perimeter, the
              service MUST refuse requests from unauthorized entities.
            applicability:
              - tlp-amber
              - tlp-red
          - id: CCC.Core.CN05.TR05
            text: |
              When any request is made from outside the trust perimeter,
              the service MUST NOT provide any response that may indicate the
              service exists.
            applicability:
              - tlp-red
          - id: CCC.Core.CN05.TR06
            text: |
              When any request is made to the service or a child resource, the
              service MUST refuse requests from unauthorized entities.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-3
                strength: 0
          - reference-id: CCM
            entries:
              - reference-id: DS-5
                strength: 0
          - reference-id: ISO_27001
            entries:
              - reference-id: 2013 A.13.1.3
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-3
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.Core.TH01
                strength: 0
  - id: ""
    title: Data
    description: |
      Controls that preserve availability and confidentiality of
      traffic processed by the load balancer.
    controls:
      - id: CCC.LB.CN02
        title: Auto-Scale Load Balancer Capacity
        objective: |
          Expand load-balancer capacity to maintain availability during traffic
          spikes.
        assessment-requirements:
          - id: CCC.LB.CN02.TR01
            text: |
              When concurrent connections reach 80 percent of capacity, the
              autoscaling group MUST add at least one instance within five
              minutes.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Enable autoscaling policies.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: ID.BE-5
                strength: 0
                remarks: Resilience requirements are established
          - reference-id: NIST_800_53
            entries:
              - reference-id: CP-10
                strength: 0
                remarks: System recovery and reconstitution
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH09
                strength: 0
                remarks: Resource Exhaustion
      - id: CCC.LB.CN07
        title: Scrub Sensitive Headers
        objective: |
          Remove headers that disclose internal details or software
          versions from HTTP responses.
        assessment-requirements:
          - id: CCC.LB.CN07.TR01
            text: |
              When responses pass through the load balancer, the
              "Server" header MUST be replaced with "lb".
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Configure header-transformation rules.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-2
                strength: 0
                remarks: Data in transit is protected
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-13
                strength: 0
                remarks: Cryptographic protection
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.Core.TH15
                strength: 0
                remarks: Automated Enumeration and Reconnaissance by Non-human
      - id: CCC.Core.CN01
        title: Encrypt Data for Transmission
        objective: |
          Ensure that all communications are encrypted in transit to protect
          data integrity and confidentiality.
        assessment-requirements:
          - id: CCC.Core.CN01.TR01
            text: |
              When a port is exposed for non-SSH network traffic, all traffic
              MUST include a TLS handshake AND be encrypted using TLS 1.3 or
              higher.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Most cloud services enable TLS 1.3 by default. Where it is not
              already set, ensure that your services are configured or updated
              accordingly.
          - id: CCC.Core.CN01.TR02
            text: |
              When a port is exposed for SSH network traffic, all traffic MUST
              include a SSH handshake AND be encrypted using SSHv2 or higher.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Any time port 22 is exposed, ensure that it has a properly
              implemented SSH server with SSHv2 enabled and configured with
              strong ciphers.
          - id: CCC.Core.CN01.TR03
            text: "When the service receives unencrypted traffic, \nthen it MUST either block the request or automatically\nredirect it to the secure equivalent.\n"
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Review firewall, load balancer, and application configurations to
              ensure insecure protocols such as HTTP, FTP, and Telnet are not
              exposed. Where possible, implement automatic redirection to secure
              protocols such as HTTPS, SFTP, SSH, and regularly scan for
              protocol drift.
          - id: CCC.Core.CN01.TR07
            text: |
              When a port is exposed, the service MUST ensure that the protocol
              and service officially assigned to that port number by the IANA
              Service Name and Transport Protocol Port Number Registry, and no
              other, is run on that port.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Reference the IANA Service Name and Transport Protocol Port Number
              Registry for more information about correct protocol-to-port
              assignments. Avoid running non-standard services on well-known
              ports.
          - id: CCC.Core.CN01.TR08
            text: |
              When a service transmits data using TLS, mutual TLS (mTLS) MUST be
              implemented to require both client and server certificate
              authentication for all connections.
            applicability:
              - tlp-amber
              - tlp-red
            recommendation: |
              Configure mTLS for all endpoints that process or transmit
              sensitive data. Ensure both client and server certificates are
              validated and managed securely. Regularly review certificate
              authorities and automate certificate rotation where possible.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-02
                strength: 0
          - reference-id: CCM
            entries:
              - reference-id: IVS-03
                strength: 0
              - reference-id: IVS-07
                strength: 0
          - reference-id: ISO_27001
            entries:
              - reference-id: 2013 A.13.1.1
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-8
                strength: 0
              - reference-id: SC-13
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.Core.TH02
                strength: 0
      - id: CCC.Core.CN02
        title: Encrypt Data for Storage
        objective: |
          Ensure that all data stored is encrypted at rest using strong
          encryption algorithms.
        assessment-requirements:
          - id: CCC.Core.CN02.TR01
            text: |
              When data is stored, it MUST be encrypted using the latest
              industry-standard encryption methods.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-1
                strength: 0
          - reference-id: CCM
            entries:
              - reference-id: DSP-17
                strength: 0
          - reference-id: ISO_27001
            entries: []
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-13
                strength: 0
              - reference-id: SC-28
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.Core.TH01
                strength: 0
      - id: CCC.Core.CN06
        title: Restrict Deployments to Trust Perimeter
        objective: |
          Ensure that the service and its child resources are only deployed on
          infrastructure in locations that are explicitly included within a
          defined trust perimeter.
        assessment-requirements:
          - id: CCC.Core.CN06.TR01
            text: |
              When the service is running, its region and availability zone MUST
              be included in a list of explicitly trusted or approved locations
              within the trust perimeter.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Maintain an up-to-date list of trusted and approved regions based
              on organizational policies. Validate the service's deployment
              location is included in this list.
          - id: CCC.Core.CN06.TR02
            text: |
              When a child resource is deployed, its region and availability
              zone MUST be included in a list of explicitly trusted or approved
              locations within the trust perimeter.
            applicability:
              - tlp-clear
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Maintain an up-to-date list of trusted and approved regions based
              on organizational policies. Validate that child resources can only
              be deployed to locations included in this list.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-1
                strength: 0
          - reference-id: CCM
            entries:
              - reference-id: DSI-06
                strength: 0
              - reference-id: DSI-08
                strength: 0
          - reference-id: ISO_27001
            entries:
              - reference-id: 2013 A.11.1.1
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-6
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.Core.TH03
                strength: 0
      - id: CCC.Core.CN10
        title: Restrict Data Replication to Trust Perimeter
        objective: |
          Ensure that data is only replicated on infrastructure in locations
          that are explicitly included within a defined trust perimeter.
        assessment-requirements:
          - id: CCC.Core.CN10.TR01
            text: |
              When data is replicated, the service MUST ensure that replication
              only occurs to destinations that are explicitly included within
              the defined trust perimeter.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-5
                strength: 0
          - reference-id: CCM
            entries:
              - reference-id: DSP-10
                strength: 0
              - reference-id: DSP-19
                strength: 0
          - reference-id: ISO_27001
            entries: []
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-4
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.Core.TH04
                strength: 0
  - id: ""
    title: Encryption
    description: Controls that ensure trustworthy TLS certificates and ciphers.
    controls:
      - id: CCC.LB.CN08
        title: Automate Certificate Renewal
        objective: |
          Maintain valid TLS certificates by automating renewal and
          deployment before expiry.
        assessment-requirements:
          - id: CCC.LB.CN08.TR01
            text: |
              When a certificate is within 30 days of expiry, automated renewal
              MUST complete and deploy a new certificate within 24 hours.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Use certificate-manager auto-renewal workflows.
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-6
                strength: 0
                remarks: Integrity checking mechanisms are used
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-17
                strength: 0
                remarks: PKI certificates
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH07
                strength: 0
                remarks: Certificates Expired or Invalid
threats:
  - id: CCC.LB.TH01
    title: Unrestricted Request Traffic Overwhelms Downstream Services
    description: |
      Absence of filtering or rate limiting permits malicious traffic to
      overload downstream services and facilitates brute-force activity.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F04
            strength: 0
            remarks: Transaction Rate Limits
      - reference-id: LB
        entries:
          - reference-id: CCC.LB.F22
            strength: 0
            remarks: Rate Limiting / Throttling
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1499
            strength: 0
            remarks: Endpoint DoS
          - reference-id: T1110
            strength: 0
            remarks: Brute Force
  - id: CCC.LB.TH03
    title: Traffic Distribution Is Manipulated
    description: |
      Adjusting distribution policies can concentrate traffic on specific nodes
      causing DoS or redirect flows through unwanted paths.
    capabilities:
      - reference-id: LB
        entries:
          - reference-id: CCC.LB.F02
            strength: 0
            remarks: Dynamic LB
          - reference-id: CCC.LB.F20
            strength: 0
            remarks: Traffic Splitting
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1499
            strength: 0
          - reference-id: T1557
            strength: 0
  - id: CCC.LB.TH04
    title: Session Persistence Is Exploited
    description: |
      Improper session-affinity settings can enable session fixation or
      hijacking across backend targets.
    capabilities:
      - reference-id: LB
        entries:
          - reference-id: CCC.LB.F15
            strength: 0
            remarks: Session Affinity
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078
            strength: 0
          - reference-id: T1557
            strength: 0
  - id: CCC.LB.TH05
    title: Health Checks Are Exploited to Take Services Offline
    description: |
      Manipulating health-check endpoints or responses can cause healthy
      targets to be marked unavailable, leading to denial of service.
    capabilities:
      - reference-id: LB
        entries:
          - reference-id: CCC.LB.F12
            strength: 0
            remarks: Health Checks
          - reference-id: CCC.LB.F13
            strength: 0
            remarks: Target Removal
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1499
            strength: 0
          - reference-id: T1583
            strength: 0
  - id: CCC.LB.TH06
    title: Sensitive Metadata Exposure via HTTP Headers
    description: |
      Response headers may reveal software versions, internal IPs, or other
      metadata useful for reconnaissance.
    capabilities:
      - reference-id: LBL
        entries:
          - reference-id: CCC.LB.F19
            strength: 0
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1592
            strength: 0
          - reference-id: T1530
            strength: 0
  - id: CCC.LB.TH07
    title: TLS Certificates Are Expired or Invalid
    description: |
      Stale or untrusted certificates weaken encrypted-traffic protection.
    capabilities:
      - reference-id: LB
        entries:
          - reference-id: CCC.LB.F11
            strength: 0
            remarks: SSL/TLS Termination
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1557
            strength: 0
          - reference-id: T1608
            strength: 0
  - id: CCC.Core.TH01
    title: Access Control is Misconfigured
    description: |
      Misconfigured access controls may grant excessive privileges or fail to
      restrict unauthorized access to the service and its child resources.
      This could result in a loss of data confidentiality or tolerance of
      unauthorized actions which impact the integrity and availability of
      resources and data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F06
            strength: 0
            remarks: Identity Based Access Control
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078
            strength: 0
            remarks: Valid Accounts
          - reference-id: T1548
            strength: 0
            remarks: Abuse Elevation Control Mechanism
          - reference-id: T1203
            strength: 0
            remarks: Exploitation for Credential Access
          - reference-id: T1098
            strength: 0
            remarks: Account Manipulation
          - reference-id: T1484
            strength: 0
            remarks: Domain or Tenant Policy Modification
          - reference-id: T1546
            strength: 0
            remarks: Event Triggered Execution
          - reference-id: T1537
            strength: 0
            remarks: Transfer Data to Cloud Account
          - reference-id: T1567
            strength: 0
            remarks: Exfiltration Over Web Services
          - reference-id: T1048
            strength: 0
            remarks: Exfiltration Over Alternative Protocol
          - reference-id: T1485
            strength: 0
            remarks: Data Destruction
          - reference-id: T1565
            strength: 0
            remarks: Data Manipulation
          - reference-id: T1027
            strength: 0
            remarks: Obfuscated Files or Information
  - id: CCC.Core.TH02
    title: Data is Intercepted in Transit
    description: |
      Data transmitted by the service is susceptible to collection by any entity
      with access to any part of the transmission path. Packet observations can
      be used to support the planning of attacks by profiling origin points,
      destinations, and usage patterns. The data may also be vulnerable to
      interception or modification in transit if not properly encrypted,
      impacting the confidentiality or integrity of the transmitted data.
    capabilities:
      - reference-id: CCC
        entries: []
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1557
            strength: 0
            remarks: Adversary-in-the-Middle
          - reference-id: T1040
            strength: 0
            remarks: Network Sniffing
  - id: CCC.Core.TH07
    title: Logs are Tampered With or Deleted
    description: |
      Tampering or deletion of service logs will reduce the system's ability to
      maintain an accurate record of events. Any actions that compromise the
      integrity of logs could disrupt system availability by disrupting
      monitoring, hindering forensic investigations, and reducing the accuracy
      of audit trails.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F03
            strength: 0
            remarks: Access/Activity Logs
          - reference-id: CCC.Core.F10
            strength: 0
            remarks: Logging
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1070
            strength: 0
            remarks: Indicator Removal on Host
          - reference-id: T1565
            strength: 0
            remarks: Data Manipulation (for altering log entries)
          - reference-id: T1027
            strength: 0
            remarks: Obfuscated Files or Information
  - id: CCC.Core.TH09
    title: Runtime Logs are Read by Unauthorized Entities
    description: |
      Unauthorized access to logs may expose valuable information about the
      system's configuration, operations, and security mechanisms. This could
      jeopardize system availability through the exposure of vulnerabilities
      and support the planning of attacks on the service, system, or network.
      If logs are not adequately sanitized, this may also directly impact the
      confidentiality of sensitive data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F03
            strength: 0
            remarks: Access/Activity Logs
          - reference-id: CCC.Core.F09
            strength: 0
            remarks: Monitoring
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1003
            strength: 0
            remarks: Credential Dumping
          - reference-id: T1007
            strength: 0
            remarks: System Service Discovery
          - reference-id: T1018
            strength: 0
            remarks: Remote System Discovery
          - reference-id: T1033
            strength: 0
            remarks: System Owner/User Discovery
          - reference-id: T1046
            strength: 0
            remarks: Network Service Discovery
          - reference-id: T1057
            strength: 0
            remarks: Process Discovery
          - reference-id: T1069
            strength: 0
            remarks: Permission Groups Discovery
          - reference-id: T1070
            strength: 0
            remarks: Indicator Removal
          - reference-id: T1082
            strength: 0
            remarks: System Information Discovery
          - reference-id: T1120
            strength: 0
            remarks: Peripheral Device Discovery
          - reference-id: T1124
            strength: 0
            remarks: System Time Discovery
          - reference-id: T1497
            strength: 0
            remarks: Virtualization/Sandbox Evasion
          - reference-id: T1518
            strength: 0
            remarks: Software Discovery
  - id: CCC.Core.TH12
    title: Resource Constraints are Exhausted
    description: |
      Exceeding the resource constraints through excessive consumption,
      resource-intensive operations, or lowering of rate-limit thresholds
      can impact the availability of elements such as memory, CPU, or storage.
      This may disrupt availability of the service or child resources by
      denying the associated functionality to users. If the impacted system is
      not designed to expect such a failure, the effect could also cascade to
      other services and resources.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F04
            strength: 0
            remarks: Transaction Rate Limits
          - reference-id: CCC.Core.F16
            strength: 0
            remarks: Budgeting
          - reference-id: CCC.Core.F19
            strength: 0
            remarks: Auto-scaling
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1496
            strength: 0
            remarks: Resource Hijacking
          - reference-id: T1499
            strength: 0
            remarks: Endpoint Denial of Service
          - reference-id: T1498
            strength: 0
            remarks: Network Denial of Service
  - id: CCC.Core.TH15
    title: Automated Enumeration and Reconnaissance by Non-human Entities
    description: |
      Automated processes may be used to gather details about service and
      child resource elements such as APIs, file systems, or directories.
      This information can reveal vulnerabilities, misconfigurations,
      and the network topology, which can be used to plan an attack against
      the system, the service, or its child resources.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F14
            strength: 0
            remarks: API Access
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1580
            strength: 0
            remarks: Cloud Infrastructure Discovery
  - id: CCC.Core.TH16
    title: Publications are Disabled
    description: |
      Publication of events, metrics, and runtime logs may be disabled, leading
      to a lack of expected security and operational information being shared.
      This can impact system availability by delaying the detection of
      incidents while also impacting system design decisions and enforcement of
      operational thresholds, such as autoscaling or cost management.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F10
            strength: 0
            remarks: Logging
          - reference-id: CCC.Core.F09
            strength: 0
            remarks: Monitoring
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1562
            strength: 0
            remarks: Impair Defenses
capabilities:
  - id: CCC.LB.F01
    title: Static Load Balancing
    description: |
      Employ load balancing algorithms that follow fixed rules,
      independent of the current server state.
  - id: CCC.LB.F02
    title: Dynamic Load Balancing
    description: |
      Employ load balancing algorithms that consider the current state
      of servers before distributing traffic. Load balancer adjusts traffic
      distribution in real-time based on the current server health, resource
      utilization, and traffic conditions.
  - id: CCC.LB.F03
    title: Layer 7 Routing
    description: |
      Providing distribution of incoming traffic based on the application layer
      or layer 7 (on ISO model) information. Some of the supported protocols on
      layer 7 are HTTP, HTTPS, HTTP/2, gRPC, and WebSockets.
  - id: CCC.LB.F04
    title: Layer 4 Routing
    description: |
      Providing distribution of incoming traffic based on the
      transport layer or layer 4 (on ISO model) information. It uses
      the combination of IP addresses and TCP/UDP port to distribute incoming
      traffic rather than inspecting the actual content of the packets.
  - id: CCC.LB.F05
    title: URL-Based Routing
    description: |
      Direct incoming requests to different backend resources based on
      the content of the request URL.
  - id: CCC.LB.F06
    title: HTTP Header-Based Routing
    description: |
      Direct incoming requests to different backend resources based on
      the values of HTTP headers.
  - id: CCC.LB.F07
    title: WebSocket Support
    description: |
      Ability to support web socket communication.
  - id: CCC.LB.F08
    title: Dual-stack Load Balancing
    description: |
      Ability to support traffic originated from both IPv4 and IPv6.
  - id: CCC.LB.F09
    title: Load Balancer Autoscaling
    description: |
      Ability for the load balancer to dynamically adjust its capacity
      in response to fluctuations in incoming traffic.
  - id: CCC.LB.F10
    title: Target Autoscaling
    description: |
      Ability for the load balancer to trigger scaling actions of the
      backend instances (targets) to handle fluctuations in incoming traffic.
  - id: CCC.LB.F11
    title: SSL/TLS Termination
    description: |
      Process of decrypting SSL or TLS encrypted traffic at the load balancer
      level rather than at the backend servers. This allows the load balancer
      to offload the decryption task from the backend servers.
  - id: CCC.LB.F12
    title: Target Health Checks
    description: |
      Ability to continuously perform health checks on backend backend targets
      in form of checking the response to HTTP request, TCP connection or checking
      other application-specific parameter
  - id: CCC.LB.F13
    title: Health Checks-based Target Removal
    description: |
      If the health check detects that a backend target is unhealthy
      the load balancer will remove that unhealthy target from its list
      of available backend instances. This ensures that traffic is no longer
      routed to the unhealthy target.
  - id: CCC.LB.F14
    title: Retries
    description: |
      Ability to retry delivery of failed requests to targets. The conditions
      under which the load balancer retries, how long to wait before retrying,
      and the maximum number of retries permitted are configurable.
  - id: CCC.LB.F15
    title: Session Affinity
    description: |
      Can configure subsequent requests from an initial client to be
      passed to the same target.
  - id: CCC.LB.F16
    title: URL Redirects
    description: |
      Redirect incoming traffic to a different URL or location.
  - id: CCC.LB.F17
    title: URL Rewrites
    description: |
      Rewrite URL paths before forwarding them to backend services.
  - id: CCC.LB.F18
    title: Custom Response
    description: |
      Ability to configure specific HTTP responses to be returned by
      the load balancer under defined conditions.
  - id: CCC.LB.F19
    title: Request and Response Header Transformations
    description: |
      Ability to modify HTTP headers of both incoming requests and outgoing
      responses.
  - id: CCC.LB.F20
    title: Traffic Splitting / Weighted Routing
    description: |
      Can distribute incoming traffic across multiple backend resources
      based on predefined weights or percentages (e.g., for canary
      deployments, A/B testing, blue-green deployments, or gradual
      traffic migrations).
  - id: CCC.LB.F21
    title: Traffic Mirroring
    description: |
      Can duplicate incoming network traffic and send it to a secondary
      destination for monitoring, analysis, or testing purposes.
  - id: CCC.LB.F22
    title: Rate Limiting / Throttling
    description: |
      Ability to limit the number of requests per second per client. This
      ensures that no single client or user overloads the backend servers,
      distributing requests fairly across multiple instances.
  - id: CCC.LB.F23
    title: Firewall Integration
    description: |
      Ability to seamlessly integrate with firewall services to ensure only
      legitimate and secure traffic reaches backend servers, blocking malicious
      requests.
  - id: CCC.Core.F03
    title: Access Log Publication
    description: |
      The service automatically publishes structured, verbose records of
      activities performed within the scope of the service by external actors.
  - id: CCC.Core.F04
    title: Transaction Rate Limits
    description: |
      The service always provides industry-standard network throughput
      up to a user-specified rate limit, beyond which excess requests
      may be throttled, delayed, or rejected.
  - id: CCC.Core.F06
    title: Access Control
    description: |
      The service automatically enforces user configurations to
      restrict or allow access to a specific component or
      a child resource based on factors such as user identities, roles,
      groups, or attributes.
  - id: CCC.Core.F08
    title: Data Replication
    description: |
      The service automatically will or can be configured to
      replicate data across multiple deployments simultaneously with parity.
  - id: CCC.Core.F09
    title: Metrics Publication
    description: |
      The service automatically publishes structured, numeric, time-series data points related to
      the performance, availability, and health of the service or its child resources.
  - id: CCC.Core.F10
    title: Log Publication
    description: |
      The service automatically publishes structured, verbose records of activities,
      operations, or events that occur within the service.
  - id: CCC.Core.F14
    title: API Access
    description: |
      The service exposes a port enabling external actors to interact
      programmatically with the service and its resources using HTTP
      protocol methods such as GET, POST, PUT, and DELETE.
  - id: CCC.Core.F15
    title: Cost Management
    description: |
      The service monitors data published by child or networked resources to infer
      usage patterns and generate cost reports for the service.
  - id: CCC.Core.F16
    title: Budgeting
    description: |
      The service may be configured to take a user-specified action when a
      spending threshold is met or exceeded on a child or networked resource.
  - id: CCC.Core.F17
    title: Alerting
    description: |
      The service may be configured to emit a notification based on a user-defined
      condition related to the data published by a child or networked resource.
  - id: CCC.Core.F19
    title: Resource Scaling
    description: |
      The service may be configured to scale child resources automatically
      or on-demand.
  - id: CCC.Core.F20
    title: Resource Tagging
    description: |
      The service provides users with the ability to tag a child resource with metadata
      that can be reviewed or queried.
  - id: CCC.Core.F22
    title: Location Lock-In
    description: |
      The service may be configured to restrict the deployment of child resources
      to specific geographic locations.
imported-controls:
  - reference-id: CCC
    entries:
      - reference-id: CCC.Core.CN01
        strength: 0
        remarks: Prevent Unencrypted Requests
      - reference-id: CCC.Core.CN02
        strength: 0
        remarks: Ensure Data Encryption at Rest
      - reference-id: CCC.Core.CN03
        strength: 0
        remarks: Enforce Multi-Factor Authentication
      - reference-id: CCC.Core.CN04
        strength: 0
        remarks: Log All Access and Changes
      - reference-id: CCC.Core.CN05
        strength: 0
        remarks: Prevent Access From Untrusted Entities
      - reference-id: CCC.Core.CN06
        strength: 0
        remarks: Prevent Deployment in Restricted Regions
      - reference-id: CCC.Core.CN10
        strength: 0
        remarks: Prevent Data Replication Outside Perimeter
imported-threats:
  - reference-id: CCC
    entries:
      - reference-id: CCC.Core.TH01
        strength: 0
        remarks: Access Control is Misconfigured
      - reference-id: CCC.Core.TH02
        strength: 0
        remarks: Data is Intercepted in Transit
      - reference-id: CCC.Core.TH07
        strength: 0
        remarks: Logs are Tampered With or Deleted
      - reference-id: CCC.Core.TH09
        strength: 0
        remarks: Logs or Monitoring Data are Read by Unauthorized Users
      - reference-id: CCC.Core.TH12
        strength: 0
        remarks: Resource Constraints are Exhausted
      - reference-id: CCC.Core.TH15
        strength: 0
        remarks: Automated Enumeration and Reconnaissance by Non-human
      - reference-id: CCC.Core.TH16
        strength: 0
        remarks: Logging and Monitoring are Disabled
      - reference-id: CCC.Core.TH17
        strength: 0
        remarks: Unauthorized Network Access via Misconfigured Rules
imported-capabilities:
  - reference-id: CCC
    entries:
      - reference-id: CCC.Core.F03
        strength: 0
        remarks: Access/Activity Logs
      - reference-id: CCC.Core.F04
        strength: 0
        remarks: Transaction Rate Limits
      - reference-id: CCC.Core.F06
        strength: 0
        remarks: Identity Based Access Control
      - reference-id: CCC.Core.F08
        strength: 0
        remarks: Multi-zone Deployment
      - reference-id: CCC.Core.F09
        strength: 0
        remarks: Monitoring
      - reference-id: CCC.Core.F10
        strength: 0
        remarks: Logging
      - reference-id: CCC.Core.F13
        strength: 0
        remarks: Infrastructure as Code
      - reference-id: CCC.Core.F14
        strength: 0
        remarks: API Access
      - reference-id: CCC.Core.F15
        strength: 0
        remarks: Cost Management
      - reference-id: CCC.Core.F16
        strength: 0
        remarks: Budgeting
      - reference-id: CCC.Core.F17
        strength: 0
        remarks: Alerting
      - reference-id: CCC.Core.F19
        strength: 0
        remarks: On-Demand Scaling
      - reference-id: CCC.Core.F20
        strength: 0
        remarks: Tagging
      - reference-id: CCC.Core.F22
        strength: 0
        remarks: Location Lock-In
