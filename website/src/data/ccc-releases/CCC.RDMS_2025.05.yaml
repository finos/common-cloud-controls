metadata:
  id: CCC.RDMS
  title: CCC Relational Database Management System Capabilities
  description: |
    This documents the minimual set of capabilities that should be present for a RDMS
    service to be considered for use in financial services ecosystems.
  version: "2025.05"
  last-modified: "2023-10-05T10:06:00-05:00"
control-families:
  - id: ""
    title: Identity and Access Management
    description: 'TODO: Describe this control family'
    controls:
      - id: CCC.RDMS.C01
        title: Password Management
        objective: |
          Ensure default vendor-supplied DB administrator credentials are replaced
          with strong, unique passwords and that these credentials are properly
          managed using a secure password or secrets management solution.
        assessment-requirements:
          - id: CCC.RDMS.C01.TR02
            text: |
              When an attempt is made to authenticate to the database using known
              default credentials, the authentication attempt must fail and no
              access should be granted.
            applicability:
              - tlp-red
              - tlp-amber
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AA-01
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-2
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.RDMS.TH01
                strength: 0
      - id: CCC.RDMS.C02
        title: Account Lockout and Rate-Limiting
        objective: |
          Ensure the database enforces lockouts or rate-limiting after a specified
          number of failed authentication attempts. This prevents brute force
          or password-guessing attacks from succeeding.
        assessment-requirements:
          - id: CCC.RDMS.C02.TR01
            text: |
              When repeated failed login attempts are made in a short timeframe,
              the account must be locked out or rate-limited to prevent
              further login attempts.
            applicability:
              - tlp-red
              - tlp-amber
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-1
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-7
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.RDMS.TH02
                strength: 0
      - id: CCC.RDMS.C04
        title: Access Control for Backup and Restore Operations
        objective: |
          Restrict who can initiate, manage, and validate database backup or
          restore operations through strict role-based or least-privilege
          access. Prevents accidental or malicious restorations, protecting
          data integrity and availability.
        assessment-requirements:
          - id: CCC.RDMS.C04.TR01
            text: |
              When there is an attempt to perform a backup or restore,
              then the attempt must fail with an access denied message if
              credentials or roles that are not explicitly authorized for
              backup/restore functions.
            applicability:
              - tlp-red
              - tlp-amber
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-4
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-6
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.RDMS.TH04
                strength: 0
      - id: CCC.RDMS.C05
        title: Restrict Snapshot Sharing to Authorized Accounts
        objective: |
          Ensure database snapshots can only be shared with explicitly authorized
          accounts, thereby minimizing the risk of data exposure or exfiltration.
        assessment-requirements:
          - id: CCC.RDMS.C05.TR01
            text: |
              When an attempt is made to share a snapshot with an unauthorized
              account, the sharing request must be denied.
            applicability:
              - tlp-red
              - tlp-amber
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-10
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-4
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.RDMS.TH05
                strength: 0
  - id: ""
    title: Data
    description: 'TODO: Describe this control family'
    controls:
      - id: CCC.RDMS.C03
        title: Enforce and Monitor Automated Backups
        objective: |
          Ensure database backups are automatically scheduled, actively monitored,
          and promptly reported if any disruptions occur. This helps maintain
          data integrity, facilitates disaster recovery, and supports business
          continuity when a system failure or breach occurs.
        assessment-requirements:
          - id: CCC.RDMS.C03.TR01
            text: |
              When backups are disabled, paused, or fail to run as scheduled,
              an alert must be triggered and logged.
            applicability:
              - tlp-red
              - tlp-amber
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.IP-4
                strength: 0
          - reference-id: NIST_800_53
            entries:
              - reference-id: CP-9
                strength: 0
        threat-mappings:
          - reference-id: CCC
            entries:
              - reference-id: CCC.RDMS.TH03
                strength: 0
threats:
  - id: CCC.RDMS.TH01
    title: Unauthorized Access via Default Credentials
    description: |
      If default credentials are not disabled or changed, unauthorized access
      may be gained to the RDMS environment. This may lead to data breaches,
      data manipulation, or overall compromise of the database instance.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.RDMS.F06
            strength: 0
          - reference-id: CCC.RDMS.F07
            strength: 0
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078
            strength: 0
  - id: CCC.RDMS.TH02
    title: Brute Force Attempts on Database Authentication
    description: |
      Repeated attempts to guess database user passwords may be made
      through brute force techniques. This condition could result in
      unauthorized access if successful, compromising database security
      and sensitive information.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.RDMS.F07
            strength: 0
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1110
            strength: 0
  - id: CCC.RDMS.TH03
    title: Database Backups Stopped
    description: |
      Database backups may be halted, potentially impairing the organization's
      ability to recover data and maintain business continuity. This condition
      increases the risk of data loss and extended system downtime.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F11
            strength: 0
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1490
            strength: 0
  - id: CCC.RDMS.TH04
    title: Unintentional Database Backup Restoration
    description: |
      A database backup may be restored unintentionally, potentially
      leading to the loss or overwrite of current data. This condition
      could disrupt operations and result in data inconsistency or
      corruption.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F11
            strength: 0
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1485
            strength: 0
  - id: CCC.RDMS.TH05
    title: Unauthorized Snapshot Sharing
    description: |
      Snapshots may be shared with untrusted accounts, which can lead to
      unauthorized access and potential data exfiltration. This significantly
      increases the risk of data exposure if sensitive information is contained
      in the snapshots.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F11
            strength: 0
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1530
            strength: 0
capabilities:
  - id: CCC.RDMS.F01
    title: SQL Support
    description: |
      Properly handle queries in the SQL language.
  - id: CCC.RDMS.F02
    title: DB Engine Option - MySQL
    description: |
      Ability to create a MySQL managed relational database.
  - id: CCC.RDMS.F03
    title: DB Engine Option - PostgreSQL
    description: |
      Ability to create a PostgreSQL managed relational database.
  - id: CCC.RDMS.F04
    title: DB Engine Option - MariaDB
    description: |
      Ability to create a MariaDB managed relational database.
  - id: CCC.RDMS.F05
    title: DB Engine Option - SQL Server
    description: |
      Ability to create a Microsoft SQL Server managed relational database.
  - id: CCC.RDMS.F06
    title: DB Managed Credentials
    description: |
      Ability to managed the database credentials using the cloud
      provider's secret management service.
  - id: CCC.RDMS.F07
    title: DB Self Managed Credentials
    description: |
      Ability to manage the database credentials by client managed
      username and passwords.
  - id: CCC.RDMS.F08
    title: Support for IPv4
    description: |
      Ability to connect to the database using IPv4 addresses.
  - id: CCC.RDMS.F09
    title: Support for IPv6
    description: |
      Ability to connect to the database using IPv6 addresses
  - id: CCC.RDMS.F10
    title: Public Access
    description: |
      Allow database to be accessed by public internet.
  - id: CCC.RDMS.F11
    title: Disable Public Access
    description: |
      Prevent database been accessed by public internet.
  - id: CCC.RDMS.F12
    title: Managed Connection Pooling
    description: |
      Ability to configure a managed connection pool for the database.
  - id: CCC.RDMS.F13
    title: Deletion Protection
    description: |
      Protect the database against accidental deletion.
  - id: CCC.RDMS.F14
    title: Dedicated Database Instances
    description: |
      Option to deploy the database on a dedicated instance for
      isolation requirements.
  - id: CCC.RDMS.F15
    title: Horizontal Scaling
    description: |
      Read replicas of the primary database can be created.
  - id: CCC.RDMS.F16
    title: Failover
    description: |
      Standby database can be implemented for failover when the
      primary can't be reached.
