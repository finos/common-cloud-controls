imported-controls:
  - reference-id: CCC
    entries:
      - reference-id: CCC.Core.CN01
        strength: 0 # Not yet specified
        remarks: Prevent Unencrypted Requests
      - reference-id: CCC.Core.CN02
        strength: 0 # Not yet specified
        remarks: Ensure Data Encryption at Rest
      - reference-id: CCC.Core.CN03
        strength: 0 # Not yet specified
        remarks: Enforce Multi-Factor Authentication
      - reference-id: CCC.Core.CN04
        strength: 0 # Not yet specified
        remarks: Log All Access and Changes
      - reference-id: CCC.Core.CN05
        strength: 0 # Not yet specified
        remarks: Prevent Access From Untrusted Entities
      - reference-id: CCC.Core.CN06
        strength: 0 # Not yet specified
        remarks: Prevent Deployment in Restricted Regions
      - reference-id: CCC.Core.CN10
        strength: 0 # Not yet specified
        remarks: Prevent Data Replication Outside Perimeter

control-families:
  - title: "Logging & Monitoring"
    description: |
      Controls that detect anomalous traffic and record load-balancer activity.

    controls:
      - id: CCC.LB.CN01
        title: Enforce and Detect Rate Limiting
        objective: >
          Detect and throttle malicious or excessive requests to prevent
          downstream resource exhaustion and brute-force activity.
        assessment-requirements:
          - id: CCC.LB.CN01.AR01
            text: |
              When a single client sends more than 2000 requests within any
              5-minute sliding window, the load balancer MUST throttle all
              subsequent requests from that client for at least 60 seconds.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Implement per-IP token-bucket limits with and verify via
              synthetic traffic tests.
          - id: CCC.LB.CN01.AR02
            text: |
              When throttling is invoked, the load balancer MUST
              record the event in the access log within 5 minutes
              for alerting and trend analysis.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Enable access logging and configure metric filters
              on HTTP 429 counts to trigger alerts.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH01
                strength: 0 # Not yet specified
                remarks: Malicious Traffic
              - reference-id: CCC.LB.TH09
                strength: 0 # Not yet specified
                remarks: Resource Exhaustion
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: DE.CM-1
                strength: 0 # Not yet specified
                remarks: Monitor to detect events
              - reference-id: PR.AC-7
                strength: 0 # Not yet specified
                remarks: Prevent brute-force
              - reference-id: PR.PT-4
                strength: 0 # Not yet specified
                remarks: Protective technology
          - reference-id: NIST_800_53
            entries:
              - reference-id: AU-6
                strength: 0 # Not yet specified
                remarks: Audit review, analysis, reporting
              - reference-id: SC-5
                strength: 0 # Not yet specified
                remarks: Denial-of-Service protection
              - reference-id: AC-7
                strength: 0 # Not yet specified
                remarks: Unsuccessful logon attempts

      - id: CCC.LB.CN06
        title: Secure Health-Check Telemetry
        objective: |
          Monitor health-check endpoints for tampering and alert on
          abnormal status changes.
        assessment-requirements:
          - id: CCC.LB.CN06.AR01
            text: |
              When more than 10 percent of targets change from healthy to
              unhealthy within five minutes, an alert MUST be issued.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Instrument metrics for health check results and target
              removal events. Configure monitoring alarms to alert
              on abnormal spikes in unhealthy targets.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH05
                strength: 0 # Not yet specified
                remarks: Health Checks Exploited
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: DE.AE-2
                strength: 0 # Not yet specified
                remarks: Detected events are analyzed
          - reference-id: NIST_800_53
            entries:
              - reference-id: SI-4
                strength: 0 # Not yet specified
                remarks: System monitoring

  - title: Identity and Access Management
    description: |
      Controls that restrict who can change or query load-balancer resources.
    controls:
      - id: CCC.LB.CN04
        title: Enforce Distribution Policies
        objective: |
          Ensure traffic-splitting weights and algorithms are modified
          only by trusted identities.
        assessment-requirements:
          - id: CCC.LB.CN04.AR01
            text: |
              When routing weights change, the request MUST originate
              from an explicitly defined and trusted identity and MUST
              be logged.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: |
              Define a list of trusted principals allowed to modify
              routing configurations. Enforce via conditional access
              policies, and log changes using audit logging.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH03
                strength: 0 # Not yet specified
                remarks: Traffic Distribution Manipulated
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-1
                strength: 0 # Not yet specified
                remarks: Identities and credentials are managed
          - reference-id: NIST_800_53
            entries:
              - reference-id: AC-3
                strength: 0 # Not yet specified
                remarks: Access enforcement

      - id: CCC.LB.CN05
        title: Validate Session Affinity
        objective: |
          Configure session persistence to minimise fixation and hijacking
          risks.
        assessment-requirements:
          - id: CCC.LB.CN05.AR01
            text: |
              When stickiness is enabled, session cookies MUST expire
              within 30 minutes of inactivity.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Audit CCC.LB.CP15 parameters via configuration scans.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH04
                strength: 0 # Not yet specified
                remarks: Session Persistence Exploited
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-7
                strength: 0 # Not yet specified
                remarks: Least functionality is enforced
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-23
                strength: 0 # Not yet specified
                remarks: Session authenticity

      - id: CCC.LB.CN09
        title: Restrict Management API Access
        objective: |
          Limit load-balancer API calls to authorised identities and
          trusted networks.
        assessment-requirements:
          - id: CCC.LB.CN09.AR01
            text: |
              When an API call originates outside the approved CIDR
              set, the request MUST be denied.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Combine VPC endpoints with IAM condition-key filters
              for protected APIs.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH08
                strength: 0 # Not yet specified
                remarks: API Exposed and Attacked
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.AC-5
                strength: 0 # Not yet specified
                remarks: Network integrity is protected
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-7
                strength: 0 # Not yet specified
                remarks: Boundary protection

  - title: Data
    description: |
      Controls that preserve availability and confidentiality of
      traffic processed by the load balancer.
    controls:
      - id: CCC.LB.CN02
        title: Auto-Scale Load Balancer Capacity
        objective: |
          Expand load-balancer capacity to maintain availability during traffic
          spikes.
        assessment-requirements:
          - id: CCC.LB.CN02.AR01
            text: |
              When concurrent connections reach 80 percent of capacity, the
              autoscaling group MUST add at least one instance within five
              minutes.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Enable autoscaling policies.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH09
                strength: 0 # Not yet specified
                remarks: Resource Exhaustion
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: ID.BE-5
                strength: 0 # Not yet specified
                remarks: Resilience requirements are established
          - reference-id: NIST_800_53
            entries:
              - reference-id: CP-10
                strength: 0 # Not yet specified
                remarks: System recovery and reconstitution

      - id: CCC.LB.CN07
        title: Scrub Sensitive Headers
        objective: |
          Remove headers that disclose internal details or software
          versions from HTTP responses.
        assessment-requirements:
          - id: CCC.LB.CN07.AR01
            text: |
              When responses pass through the load balancer, the
              "Server" header MUST be replaced with "lb".
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Configure header-transformation rules.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.Core.TH15
                strength: 0 # Not yet specified
                remarks: Automated Enumeration and Reconnaissance by Non-human
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-2
                strength: 0 # Not yet specified
                remarks: Data in transit is protected
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-13
                strength: 0 # Not yet specified
                remarks: Cryptographic protection

  - title: Encryption
    description: Controls that ensure trustworthy TLS certificates and ciphers.
    controls:
      - id: CCC.LB.CN08
        title: Automate Certificate Renewal
        objective: |
          Maintain valid TLS certificates by automating renewal and
          deployment before expiry.
        assessment-requirements:
          - id: CCC.LB.CN08.AR01
            text: |
              When a certificate is within 30 days of expiry, automated renewal
              MUST complete and deploy a new certificate within 24 hours.
            applicability:
              - tlp-green
              - tlp-amber
              - tlp-red
            recommendation: Use certificate-manager auto-renewal workflows.
        threat-mappings:
          - reference-id: LB
            entries:
              - reference-id: CCC.LB.TH07
                strength: 0 # Not yet specified
                remarks: Certificates Expired or Invalid
        guideline-mappings:
          - reference-id: NIST-CSF
            entries:
              - reference-id: PR.DS-6
                strength: 0 # Not yet specified
                remarks: Integrity checking mechanisms are used
          - reference-id: NIST_800_53
            entries:
              - reference-id: SC-17
                strength: 0 # Not yet specified
                remarks: PKI certificates
