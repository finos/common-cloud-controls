##
# Threats Style Guide
#
# - Use a formal, objective, and precise tone
# - Each threat must have: id, title, description, capabilities, and external-mappings
# - Titles should:
#   - Be concise
#   - Use title case
#   - Clearly state an action that should be prevented
# - Descriptions should:
#   - Begin with the circumstances that could lead to the threat occurring
#   - Describe the effect on the system if the threat manifests
#   - Include a description of the impact to the confidentiality, integrity, or availability of resources or data
#   - Use complete sentences
#   - Avoid subjective or speculative language
#   - Avoid intent-based phrases like "accidental" or "malicious"
# - Use consistent terminology:
#   - service: the resource being assessed
#   - child resource: an actor that is created and/or managed by the service
#   - system: the broader architecture that the service operates within
#   - entity: a human or machine that interacts with the service
# - Mappings should:
#   - Reference guidance entries with its title written in the remarks field
#   - The reference-id for mappings should be an ID defined in metadata.mapping-references[]

threats:
  - id: CCC.Core.TH01
    title: Access Control is Misconfigured
    description: |
      Misconfigured access controls may grant excessive privileges or fail to
      restrict unauthorized access to the service and its child resources.
      This could result in a loss of data confidentiality or tolerance of
      unauthorized actions which impact the integrity and availability of
      resources and data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F06
            strength: 0 # Not yet specified
            remarks: Identity Based Access Control
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1078
            strength: 0 # Not yet specified
            remarks: Valid Accounts
          - reference-id: T1548
            strength: 0 # Not yet specified
            remarks: Abuse Elevation Control Mechanism
          - reference-id: T1203
            strength: 0 # Not yet specified
            remarks: Exploitation for Credential Access
          - reference-id: T1098
            strength: 0 # Not yet specified
            remarks: Account Manipulation
          - reference-id: T1484
            strength: 0 # Not yet specified
            remarks: Domain or Tenant Policy Modification
          - reference-id: T1546
            strength: 0 # Not yet specified
            remarks: Event Triggered Execution
          - reference-id: T1537
            strength: 0 # Not yet specified
            remarks: Transfer Data to Cloud Account
          - reference-id: T1567
            strength: 0 # Not yet specified
            remarks: Exfiltration Over Web Services
          - reference-id: T1048
            strength: 0 # Not yet specified
            remarks: Exfiltration Over Alternative Protocol
          - reference-id: T1485
            strength: 0 # Not yet specified
            remarks: Data Destruction
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
          - reference-id: T1027
            strength: 0 # Not yet specified
            remarks: Obfuscated Files or Information
  - id: CCC.Core.TH02
    title: Data is Intercepted in Transit
    description: |
      Data transmitted by the service is susceptible to collection by any entity
      with access to any part of the transmission path. Packet observations can
      be used to support the planning of attacks by profiling origin points,
      destinations, and usage patterns. The data may also be vulnerable to
      interception or modification in transit if not properly encrypted,
      impacting the confidentiality or integrity of the transmitted data.
    capabilities:
      - reference-id: CCC
        entries: []
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1557
            strength: 0 # Not yet specified
            remarks: Adversary-in-the-Middle
          - reference-id: T1040
            strength: 0 # Not yet specified
            remarks: Network Sniffing
  - id: CCC.Core.TH03
    title: Deployment Region Network is Untrusted
    description: |
      Systems are susceptible to unauthorized access or interception by actors
      with political or physical control over the network in which they are
      deployed. If the geopolitical status of the deployment network is
      untrusted, unstable, or insecure, this could result in a loss of
      confidentiality, integrity, or availability of the service and its data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F08
            strength: 0 # Not yet specified
            remarks: Multi-zone Deployment
          - reference-id: CCC.Core.F22
            strength: 0 # Not yet specified
            remarks: Location Lock-In
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1040
            strength: 0 # Not yet specified
            remarks: Network Sniffing
          - reference-id: T1110
            strength: 0 # Not yet specified
            remarks: Brute Force
          - reference-id: T1105
            strength: 0 # Not yet specified
            remarks: Ingress Tool Transfer
          - reference-id: T1583
            strength: 0 # Not yet specified
            remarks: Acquire Infrastructure
          - reference-id: T1557
            strength: 0 # Not yet specified
            remarks: Adversary-in-the-Middle
  - id: CCC.Core.TH04
    title: Data is Replicated to Untrusted or External Locations
    description: |
      Systems are susceptible to unauthorized access or interception by actors
      with political or physical control over the network in which they are
      deployed. Confidentiality may be impacted if the data is replicated to a
      network where the geopolitical status is untrusted, unstable, or insecure.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F21
            strength: 0 # Not yet specified
            remarks: Replication
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
  - id: CCC.Core.TH05
    title: Interference with Replication Processes
    description: |
      Misconfigured or manipulated replication processes may lead to data being
      copied to unintended locations, delayed, modified, or not being copied
      at all. This could lead to compromised data confidentiality and integrity,
      potentially also affecting recovery processes and data availability.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F08
            strength: 0 # Not yet specified
            remarks: Multi-zone Deployment
          - reference-id: CCC.Core.F12
            strength: 0 # Not yet specified
            remarks: Recovery
          - reference-id: CCC.Core.F21
            strength: 0 # Not yet specified
            remarks: Replication
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1485
            strength: 0 # Not yet specified
            remarks: Data Destruction
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
          - reference-id: T1491
            strength: 0 # Not yet specified
            remarks: Defacement
          - reference-id: T1490
            strength: 0 # Not yet specified
            remarks: Inhibit System Recovery
  - id: CCC.Core.TH06
    title: Data is Lost or Corrupted
    description: |
      Services that rely on accurate data are susceptible to disruption in the
      event of data loss or corruption. Any actions that lead to the unintended
      deletion, alteration, or limited access to data can impact the
      availability of the service and the system it is part of.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F11
            strength: 0 # Not yet specified
            remarks: Backup
          - reference-id: CCC.Core.F18
            strength: 0 # Not yet specified
            remarks: Versioning
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1485
            strength: 0 # Not yet specified
            remarks: Data Destruction
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
          - reference-id: T1491
            strength: 0 # Not yet specified
            remarks: Defacement
          - reference-id: T1490
            strength: 0 # Not yet specified
            remarks: Inhibit System Recovery
  - id: CCC.Core.TH07
    title: Logs are Tampered With or Deleted
    description: |
      Tampering or deletion of service logs will reduce the system's ability to
      maintain an accurate record of events. Any actions that compromise the
      integrity of logs could disrupt system availability by disrupting
      monitoring, hindering forensic investigations, and reducing the accuracy
      of audit trails.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F03
            strength: 0 # Not yet specified
            remarks: Access/Activity Logs
          - reference-id: CCC.Core.F10
            strength: 0 # Not yet specified
            remarks: Logging
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1070
            strength: 0 # Not yet specified
            remarks: Indicator Removal on Host
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation (for altering log entries)
          - reference-id: T1027
            strength: 0 # Not yet specified
            remarks: Obfuscated Files or Information
  - id: CCC.Core.TH08
    title: Runtime Metrics are Manipulated
    description: |
      Manipulation of runtime metrics can lead to inaccurate representations of
      system performance and resource utilization. This compromised data
      integrity may also impact system availability through misinformed scaling
      decisions, budget exhaustion, financial losses, and hindered incident
      detection.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F15
            strength: 0 # Not yet specified
            remarks: Cost Management
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
          - reference-id: T1070
            remarks: Indicator Removal on Host
  - id: CCC.Core.TH09
    title: Runtime Logs are Read by Unauthorized Entities
    description: |
      Unauthorized access to logs may expose valuable information about the
      system's configuration, operations, and security mechanisms. This could
      jeopardize system availability through the exposure of vulnerabilities
      and support the planning of attacks on the service, system, or network.
      If logs are not adequately sanitized, this may also directly impact the
      confidentiality of sensitive data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F03
            strength: 0 # Not yet specified
            remarks: Access/Activity Logs
          - reference-id: CCC.Core.F09
            strength: 0 # Not yet specified
            remarks: Monitoring
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1003
            strength: 0 # Not yet specified
            remarks: Credential Dumping
          - reference-id: T1007
            strength: 0 # Not yet specified
            remarks: System Service Discovery
          - reference-id: T1018
            strength: 0 # Not yet specified
            remarks: Remote System Discovery
          - reference-id: T1033
            strength: 0 # Not yet specified
            remarks: System Owner/User Discovery
          - reference-id: T1046
            strength: 0 # Not yet specified
            remarks: Network Service Discovery
          - reference-id: T1057
            strength: 0 # Not yet specified
            remarks: Process Discovery
          - reference-id: T1069
            strength: 0 # Not yet specified
            remarks: Permission Groups Discovery
          - reference-id: T1070
            strength: 0 # Not yet specified
            remarks: Indicator Removal
          - reference-id: T1082
            strength: 0 # Not yet specified
            remarks: System Information Discovery
          - reference-id: T1120
            strength: 0 # Not yet specified
            remarks: Peripheral Device Discovery
          - reference-id: T1124
            strength: 0 # Not yet specified
            remarks: System Time Discovery
          - reference-id: T1497
            strength: 0 # Not yet specified
            remarks: Virtualization/Sandbox Evasion
          - reference-id: T1518
            strength: 0 # Not yet specified
            remarks: Software Discovery
  - id: CCC.Core.TH##
    title: Metrics are Read by Unauthorized Entities
    description: |
      Unauthorized access to runtime metrics may expose valuable information
      about the system's design, performance, and usage patterns. This can
      support the planning of attacks on the service, system, or network.
  - id: CCC.Core.TH10
    title: State-change Events are Read by Unauthorized Entities
    description: |
      Unauthorized access to state-change events can reveal information about
      the system's design and usage patterns. This opens the system up to
      attacks of opportunity and support the planning of attacks on the
      service, system, or network.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F03
            strength: 0 # Not yet specified
            remarks: Access/Activity Logs
          - reference-id: CCC.Core.F07
            strength: 0 # Not yet specified
            remarks: Event Notifications
          - reference-id: CCC.Core.F09
            strength: 0 # Not yet specified
            remarks: Monitoring
          - reference-id: CCC.Core.F17
            strength: 0 # Not yet specified
            remarks: Alerting
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1057
            strength: 0 # Not yet specified
            remarks: Process Discovery
          - reference-id: T1049
            strength: 0 # Not yet specified
            remarks: System Network Connections Discovery
          - reference-id: T1083
            strength: 0 # Not yet specified
            remarks: File and Directory Discovery
  - id: CCC.Core.TH11
    title: Publications are Incorrectly Triggered
    description: |
      Incorrectly triggered publications may lead to the dissemination of
      inaccurate or misleading information. This data integrity problem could
      result in sensitive operations being initiated, it can obfuscate other
      issues, and it may disrupt the availability of the system or its data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F07
            strength: 0 # Not yet specified
            remarks: Event Notifications
          - reference-id: CCC.Core.F17
            strength: 0 # Not yet specified
            remarks: Alerting
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1205
            strength: 0 # Not yet specified
            remarks: Traffic Signaling
          - reference-id: T1001.001
            strength: 0 # Not yet specified
            remarks: "Data Obfuscation: Junk Data"
          - reference-id: T1491.001
            strength: 0 # Not yet specified
            remarks: "Defacement: Internal Defacement"
  - id: CCC.Core.TH12
    title: Resource Constraints are Exhausted
    description: |
      Exceeding the resource constraints through excessive consumption,
      resource-intensive operations, or lowering of rate-limit thresholds
      can impact the availability of elements such as memory, CPU, or storage.
      This may disrupt availability of the service or child resources by
      denying the associated functionality to users. If the impacted system is
      not designed to expect such a failure, the effect could also cascade to
      other services and resources.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F04
            strength: 0 # Not yet specified
            remarks: Transaction Rate Limits
          - reference-id: CCC.Core.F16
            strength: 0 # Not yet specified
            remarks: Budgeting
          - reference-id: CCC.Core.F19
            strength: 0 # Not yet specified
            remarks: Auto-scaling
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1496
            strength: 0 # Not yet specified
            remarks: Resource Hijacking
          - reference-id: T1499
            strength: 0 # Not yet specified
            remarks: Endpoint Denial of Service
          - reference-id: T1498
            strength: 0 # Not yet specified
            remarks: Network Denial of Service
  - id: CCC.Core.TH13
    title: Resource Tags are Manipulated
    description: |
      When resource tags are altered, it can lead to misclassification or
      mismanagement of resources. This can reduce the efficacy of organizational
      policies, billing rules, or network access rules. Such changes could cause
      compromised confidentiality, integrity, or availability of the system and
      its data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F20
            strength: 0 # Not yet specified
            remarks: Tagging
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
  - id: CCC.Core.TH14
    title: Older Resource Versions are Used
    description: |
      Running older versions of child resources can expose the system to known
      vulnerabilities that have been addressed in more recent versions. If the
      version identifier is detected by an attacker, it may be possible to
      exploit these vulnerabilities to compromise the confidentiality,
      integrity, or availability of the system and its data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F18
            strength: 0 # Not yet specified
            remarks: Versioning
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1027
            strength: 0 # Not yet specified
            remarks: Obfuscated Files or Information
          - reference-id: T1485
            strength: 0 # Not yet specified
            remarks: Data Destruction
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
          - reference-id: T1489
            strength: 0 # Not yet specified
            remarks: Service Stop
          - reference-id: T1562.01
            strength: 0 # Not yet specified
            remarks: "Impair Defenses: Downgrade Attack"
          - reference-id: T1027
            strength: 0 # Not yet specified
            remarks: Obfuscated Files or Information
          - reference-id: T1485
            strength: 0 # Not yet specified
            remarks: Data Destruction
          - reference-id: T1565
            strength: 0 # Not yet specified
            remarks: Data Manipulation
          - reference-id: T1489
            strength: 0 # Not yet specified
            remarks: Service Stop
  - id: CCC.Core.TH15
    title: Automated Enumeration and Reconnaissance by Non-human Entities
    description: |
      Automated processes or bots may be used to perform reconnaissance by
      enumerating resources such as APIs, file systems, or directories. These
      activities can reveal potential vulnerabilities, misconfigurations, or
      unsecured resources, which might result in unauthorized access or data
      exposure.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F14
            strength: 0 # Not yet specified
            remarks: API Access
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1580
            strength: 0 # Not yet specified
            remarks: Cloud Infrastructure Discovery
  - id: CCC.Core.TH16
    title: Publications are Disabled
    description: |
      Publication of events, metrics, and runtime logs may be disabled, leading
      to a lack of critical security and operational information being recorded
      or shared. This can impact system availability by delaying the
      detection of and response to incidents, as well as affecting informed
      system design and enforcement of operational thresholds.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F10
            strength: 0 # Not yet specified
            remarks: Logging
          - reference-id: CCC.Core.F09
            strength: 0 # Not yet specified
            remarks: Monitoring
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1562
            strength: 0 # Not yet specified
            remarks: Impair Defenses
  - id: CCC.Core.TH17
    title: Unauthorized Network Access via Misconfigured Rules
    description: |
      Improperly configured or overly permissive network access rules
      such as security groups can allow unauthorized inbound connections
      to the system. This could result in unauthorized access to sensitive
      resources or data and disruption to system availability.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F23
            strength: 0 # Not yet specified
            remarks: Network Access Rules
    external-mappings:
      - reference-id: MITRE-ATT&CK
        entries:
          - reference-id: T1046
            strength: 0 # Not yet specified
            remarks: Network Service Scanning
          - reference-id: T1133
            strength: 0 # Not yet specified
            remarks: External Remote Services
  - id: CCC.Core.TH18
    title: Encryption Keys are Compromised
    description: |
      Encryption keys may be misused due to inadequate key management practices 
      or the compromise of a connected system. This could lead to disruptions or
      unauthorized access to encrypted data.
    capabilities:
      - reference-id: CCC
        entries:
          - reference-id: CCC.Core.F01
            strength: 0 # Not yet specified
            remarks: Encryption in Transit Enabled by Default
          - reference-id: CCC.Core.F02
            strength: 0 # Not yet specified
            remarks: Encryption at Rest Enabled by Default
