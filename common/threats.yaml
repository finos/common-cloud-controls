shared-threats:
  - reference-id: CCC
    identifiers:
      - CCC.TH01 # Access Control is Misconfigured
      - CCC.TH02 # Data is Intercepted in Transit
      - CCC.TH03 # Deployment Region Network is Untrusted
      - CCC.TH04 # Data is Replicated to Untrusted or External Locations
      - CCC.TH05 # Data is Corrupted During Replication
      - CCC.TH06 # Data is Lost or Corrupted
      - CCC.TH07 # Logs are Tampered With or Deleted
      - CCC.TH08 # Cost Management Data is Manipulated
      - CCC.TH09 # Logs or Monitoring Data are Read by Unauthorized Users
      - CCC.TH10 # Alerts are Intercepted
      - CCC.TH11 # Event Notifications are Incorrectly Triggered
      - CCC.TH12 # Resource Constraints are Exhausted
      - CCC.TH13 # Resource Tags are Manipulated
      - CCC.TH14 # Older Resource Versions are Exploited
      - CCC.TH15 # Automated Enumeration and Reconnaissance by Non-human Entities
      - CCC.TH16 # Logging and Monitoring are Disabled
      - CCC.TH17 # Unauthorized Network Access via Misconfigured Rules

threats:
  - id: CCC.K8s.TH01
    title: Control Plane Compromise
    description: |
      An attacker could exploit misconfigured control plane APIs, permissions, or add-ons (e.g., CoreDNS, metrics-server) to escalate privileges or gain persistence.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.K8s.F01 # Managed Control Plane
          - CCC.K8s.F12 # Add-on Lifecycle Management
          - CCC.K8s.F17 # Cluster API Access and CLI Compatibility
      - reference-id: CCC
        identifiers:
          - CCC.TH01 # Access Control is Misconfigured

  - id: CCC.K8s.TH02
    title: Workload Misplacement or Resource Exhaustion
    description: |
      Misconfigured autoscaling policies or lack of resource quotas may allow noisy neighbors or malicious containers to starve cluster resources or trigger unexpected node scaling.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.K8s.F02 # Node Pool Management
          - CCC.K8s.F03 # Workload Autoscaling
          - CCC.K8s.F19 # Resource Quota Management
      - reference-id: CCC
        identifiers:
          - CCC.TH12 # Resource Constraints are Exhausted

  - id: CCC.K8s.TH03
    title: Exposed Services via Ingress or Load Balancer
    description: |
      Misconfigured ingress controllers or service exposure (e.g., public LoadBalancer types) can leak internal services, enable recon, or permit adversary-in-the-middle attacks.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.K8s.F04 # Ingress and Load Balancer Integration
          - CCC.K8s.F10 # Private Cluster Support
      - reference-id: CCC
        identifiers:
          - CCC.TH02 # Data is Intercepted in Transit
          - CCC.TH03 # Deployment Region Network is Untrusted
          - CCC.TH17 # Unauthorized Network Access via Misconfigured Rules

  - id: CCC.K8s.TH04
    title: Compromise via Insecure Secrets or Configs
    description: |
      Improperly managed secrets (e.g., mounted in plaintext, logged, or hardcoded) may be exposed through volume inspection, log tampering, or poor RBAC configuration.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.K8s.F06 # Secrets and Config Management
      - reference-id: CCC
        identifiers:
          - CCC.TH01 # Access Control is Misconfigured
          - CCC.TH07 # Logs are Tampered With or Deleted

  - id: CCC.K8s.TH05
    title: Observability Gaps Allow Undetected Compromise
    description: |
      Inadequate observability of workloads, containers, and node metrics may hinder detection of intrusions, data exfiltration, or policy violations.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.K8s.F07 # Observability Integration
          - CCC.F09     # Monitoring
          - CCC.F10     # Logging
      - reference-id: CCC
        identifiers:
          - CCC.TH09 # Logs or Monitoring Data are Read by Unauthorized Users
          - CCC.TH16 # Logging and Monitoring are Disabled

  - id: CCC.K8s.TH06
    title: Unauthorized Workload Scheduling Across Zones
    description: |
      Improper affinity, taints, or control plane unawareness may result in workload imbalance, data residency violations, or cross-region latency/exfiltration risks.
    capabilities:
      - reference-id: CCC
        identifiers:
          - CCC.K8s.F11 # Multi-Zone Availability
          - CCC.F08     # Multi-zone Deployment
          - CCC.F22     # Location Lock-In
          - CCC.F16     # Data Residency Control
      - reference-id: CCC
        identifiers:
          - CCC.TH03 # Deployment Region Network is Untrusted

  - id: CCC.K8s.TH07
    title: Exploitation of Older or Insecure Add-ons
    description: |
      Add-ons like CoreDNS, Calico, or metrics-server if outdated, may expose vulnerable components that adversaries can exploit
